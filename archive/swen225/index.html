<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Software Design SWEN225</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="8dd66dd0-a9b5-4810-9fc8-d399768f4725" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🍨</span></div><h1 class="page-title">Software Design SWEN225</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-created_time"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedAt"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.54102 8.91211H7.99316C8.30078 8.91211 8.54004 8.67285 8.54004 8.37207V3.8877C8.54004 3.58691 8.30078 3.34766 7.99316 3.34766C7.69238 3.34766 7.45312 3.58691 7.45312 3.8877V7.83203H4.54102C4.2334 7.83203 4.00098 8.06445 4.00098 8.37207C4.00098 8.67285 4.2334 8.91211 4.54102 8.91211Z"></path></svg></span>Created time</th><td><time>@July 9, 2024 11:59 AM</time></td></tr><tr class="property-row property-row-text"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesText"><path d="M1.56738 3.25879H14.4258C14.7676 3.25879 15.0479 2.97852 15.0479 2.63672C15.0479 2.29492 14.7744 2.02148 14.4258 2.02148H1.56738C1.21875 2.02148 0.952148 2.29492 0.952148 2.63672C0.952148 2.97852 1.22559 3.25879 1.56738 3.25879ZM1.56738 6.84082H14.4258C14.7676 6.84082 15.0479 6.56055 15.0479 6.21875C15.0479 5.87695 14.7744 5.60352 14.4258 5.60352H1.56738C1.21875 5.60352 0.952148 5.87695 0.952148 6.21875C0.952148 6.56055 1.22559 6.84082 1.56738 6.84082ZM1.56738 10.4229H14.4258C14.7676 10.4229 15.0479 10.1426 15.0479 9.80078C15.0479 9.45898 14.7744 9.18555 14.4258 9.18555H1.56738C1.21875 9.18555 0.952148 9.45898 0.952148 9.80078C0.952148 10.1426 1.22559 10.4229 1.56738 10.4229ZM1.56738 14.0049H8.75879C9.10059 14.0049 9.38086 13.7246 9.38086 13.3828C9.38086 13.041 9.10742 12.7676 8.75879 12.7676H1.56738C1.21875 12.7676 0.952148 13.041 0.952148 13.3828C0.952148 13.7246 1.22559 14.0049 1.56738 14.0049Z"></path></svg></span>AI summary</th><td>This document discusses various topics related to software design, including the Flyweight pattern, the Observer pattern, and Swing GUI programming. It provides code examples and explanations for each topic, highlighting key concepts and best practices.</td></tr></tbody></table></header><div class="page-body"><ul id="59de0de6-ee55-4715-bfb9-991b80919f3f" class="toggle"><li><details><summary>Course Introduction </summary><p id="27fa68cc-8c11-49fc-8983-d7039dcd4692" class="">about</p><ul id="a38a0776-0021-4b91-82bd-cb31a6160925" class="bulleted-list"><li style="list-style-type:disc">programming patterns (eg: dynamic dispatch)</li></ul><ul id="4e654c35-5898-4cc5-9fc2-513d8a01f8df" class="bulleted-list"><li style="list-style-type:disc">automated testing</li></ul><ul id="19c2d696-51bc-4fdb-a07b-7f5e2a800ecc" class="bulleted-list"><li style="list-style-type:disc">git</li></ul><p id="5ecab17c-cc3d-4d1e-b66c-b0aded929991" class="">work</p><ul id="8fa956df-f848-4440-8de0-0021648fb6fb" class="bulleted-list"><li style="list-style-type:disc">wat: 5% every week</li></ul><ul id="1833d8c2-d117-4c98-b172-5766abe4e441" class="bulleted-list"><li style="list-style-type:disc">5% assignment</li></ul><ul id="8936c62a-0980-4b3f-b49d-d128df5110f0" class="bulleted-list"><li style="list-style-type:disc">5 5% labs</li></ul><ul id="d6332661-71aa-40f3-8c24-1aeb3696f8cf" class="bulleted-list"><li style="list-style-type:disc">term test 1: 15% week 4</li></ul><ul id="21f11c55-c632-4465-a9ed-1f7ddcc72632" class="bulleted-list"><li style="list-style-type:disc">test test 2: 15% week 8</li></ul><ul id="6c1cbabd-6f5c-400b-8dda-e3e0f3f0eeda" class="bulleted-list"><li style="list-style-type:disc">final test 25%</li></ul><ul id="2a4d897d-94e8-4088-8939-782dcdcf5210" class="bulleted-list"><li style="list-style-type:disc">group project 30% week 12</li></ul><p id="a50591b5-872e-477e-bdc2-beaf82d47c08" class="">other</p><ul id="2885841f-5ba0-4ac2-913f-f7316c09fdf5" class="bulleted-list"><li style="list-style-type:disc">go to lectures</li></ul><p id="1669c4eb-48a3-4c84-8df1-ee6c95e81619" class="">programming paradigms </p><ul id="c93eaf5d-98d8-4aca-b88e-cf78f0b561d2" class="bulleted-list"><li style="list-style-type:disc">imperative<p id="64333abc-068d-4e38-b955-a50f526a40dd" class="">using if, while, for to express behaviour </p></li></ul><ul id="1f091af6-3dbe-45cb-92b9-a9d0d766a149" class="bulleted-list"><li style="list-style-type:disc">functional<p id="85578e16-cd72-4f25-83b3-4a95ee82ee66" class="">use function composition to express behaviour</p></li></ul><ul id="056c9d64-e0c4-45bf-bf3f-8f6925c9c089" class="bulleted-list"><li style="list-style-type:disc">OOP<p id="c4c397bb-d9b2-44a8-8c5e-18fa23518892" class="">use dynamic dispatch to express behaviour </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="688117f5-c302-48ba-9445-4a7eaae5f903" class="code"><code class="language-Java">private Optional&lt;Observer&lt;S,M&gt;&gt; ob = Optional.empty();

protected  abstract S self();

public final void attach(Observer&lt;S,M&gt; o){
    ob = Optional.of(o);
}

protected final void onChange(M m){
    ob.ifPresent(o -&gt; o.update(self(), m));

}
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9d361613-9818-46b7-961a-85eeec34faa0" class="code"><code class="language-Java">private List&lt;Observer&gt; os = new ArrayList&lt;&gt;();

public final void attach(Observer o) {
    os.add(o);
}

public final void deattachAll() {
    os.clear();
}

protected final void onChange() {
    os.forEach(o -&gt; o.update());
}




</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aaa729a1-a2b3-4bb0-b03d-39edebef4106" class="code"><code class="language-Java">
if (child.owner != Exp.root) {
    
    
    
    child.owner.remove(child);
}

childs.add(child);
child.owner = this;
</code></pre></li></ul></details></li></ul><ul id="a1f9e922-ad59-4aae-a5fe-aeb0e12b00c2" class="toggle"><li><details><summary>Programming Paradigms</summary><h3 id="f2703de6-07ce-4ca1-a7a0-90cda9267956" class="">Imperative</h3><p id="993fff4b-0d7f-4432-ab8c-e82b00128cd6" class="">revolves around using statements such as if, else, while, for</p><figure id="8618882e-9c19-466d-8694-2b3b27cb89ad" class="image"><a href="Untitled.png"><img style="width:679.984375px" src="Untitled.png"/></a></figure><h3 id="1bdce964-02cf-4e19-ad7d-84d65c1c8b88" class="">Functional</h3><p id="7c8d9680-dccb-4222-b252-a1c60dfc437c" class="">revolves on top level functions and methods, lambdas and heavily on optionals</p><figure id="98bd6105-0d93-4725-93af-1f8a02afbb45" class="image"><a href="Untitled%201.png"><img style="width:679.96875px" src="Untitled%201.png"/></a></figure><h3 id="f37950f9-13bf-4d1c-96e4-728121d0ec74" class="">OOP</h3><p id="e547eb6a-25ec-4781-92d0-6f5571903df1" class="">uses subtyping with a base case empty stack and non empty stack as an anonyms inner class</p><p id="b42b0e3a-dc8d-4144-9472-b7da112ea731" class="">uses overriding and dynamic dispatch to change body of methods depending on the type </p><figure id="27330935-5b0a-4180-8ecb-e8ab4a60b0bd" class="image"><a href="Untitled%202.png"><img style="width:679.984375px" src="Untitled%202.png"/></a></figure><h3 id="939bda84-7bc8-44ad-94c5-1c90ac1ca9b7" class="">Pure OOP</h3><p id="578c63f7-6b1b-4cdd-a8a4-533996de40d9" class="">replaces if else statements with overriding, if stack is empty then match will call a.of for the OnEmpty type’s implementation of of and if stack is non empty then it will call b.of for the OnElem type’s  implementation of of </p><ul id="723574a7-7a7b-4a1b-81b3-e1f282c126a4" class="bulleted-list"><li style="list-style-type:disc">implements if statements as interfaces on empty and on elem</li></ul><ul id="7191720f-aa9d-43c0-a934-00442ea02bf1" class="bulleted-list"><li style="list-style-type:disc">the lambda’s capture the syntatic fields of top and tail and implements the body of </li></ul><figure id="87f40c3a-12b0-47e1-9eb7-27155af88f1d" class="image"><a href="Untitled%203.png"><img style="width:679.96875px" src="Untitled%203.png"/></a></figure><figure id="e82a32db-9bdd-4691-b036-eea9ebf221e3" class="image"><a href="Untitled%204.png"><img style="width:1398px" src="Untitled%204.png"/></a></figure><figure id="be81ae29-6055-4e66-a3fe-9322d87576bf" class="image"><a href="Untitled%205.png"><img style="width:1154px" src="Untitled%205.png"/></a></figure><ul id="5f2cf7e9-11fc-4797-80f6-e9c53d363721" class="bulleted-list"><li style="list-style-type:disc">functional is more about adding more visual types and using existing abstractions and rarely write a new interface/implantation</li></ul><ul id="0b137bed-3dda-4e8d-81ef-d05577c893ee" class="bulleted-list"><li style="list-style-type:disc">OOP is more about making your own interfaces and implementations </li></ul></details></li></ul><ul id="639757f0-fa2e-4629-91a6-6c2ea3497580" class="toggle"><li><details><summary>Power up our coding</summary><ul id="12075bf0-f229-4f5e-ae15-74f680f79bda" class="toggle"><li><details><summary>Stack with Match</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dcefc1cf-8fb7-44ce-b3c8-1a884f0751e1" class="code"><code class="language-Java">interface Stack{
	//empty stack is just an anon inner class that uses the default implementation
		//of match (which just calls OnEmpty.of)
 static Stack empty(){ return new Stack(){}; }
 //empty stack type
 interface OnEmpty&lt;R&gt;{ R of(); }
 //non empty stack type
 interface OnElem&lt;R&gt;{ R of(int elem, Stack tail); }
 
 //match method calls .of method for empty case if the type is empty
	 //calls .of on onelem when the type overrides match to call b.of instead
 default &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return a.of(); }
 
 //makes a new non empty stack object as an anon inner class
	 //this new object has the current object as it&#x27;s tail
	 //the elem and tail are implicit/syntatic fields captured by the lambda
 default Stack push(int top){
		 Stack self= this;
		 return new Stack(){
				 public &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return b.of(top,self); 
			}
}

String res = s0.match(
 ()-&gt;&quot;&lt;Empty&gt;&quot;, //implement and use this .of method body on empty case
 (top,tail)-&gt;&quot;&quot;+top //implement and use this .of method body on non empty case
));
</code></pre></details></li></ul><ul id="ccdb9a80-e580-4e53-afcb-7c993fd51ab0" class="toggle"><li><details><summary>Match vs Dynamic Dispatch</summary><h3 id="874c12b4-619a-43bb-9866-58ab92b115b9" class="">Match Approach </h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="64455450-5d7b-4df4-958d-cee7a88ad542" class="code"><code class="language-Java">interface Stack{
 static Stack empty(){ return new Stack(){}; }
 interface OnEmpty&lt;R&gt;{ R of(); }
 interface OnElem&lt;R&gt;{ R of(int elem, Stack tail); }
 default &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return a.of(); }
 default Stack push(int top){
		 Stack self= this;
				 return new Stack(){
				 public &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return b.of(top,self); }
		 };
 }
 
 //size using match
 default int size(){ 
		 return match(
				 //empty stack case calls a.of because this object is using the 
				 //default match method
				 ()-&gt; 0, 
				//non empty stack case calls b.of because this object is an 
				//anonymous inner class
				 (top,tail)-&gt; 1 + tail.size() //recursive call on size
				 );
		 }
}</code></pre><h3 id="0697766e-2e3b-4d42-ab67-649c0c9bc91a" class="">Dynamic Dispatch Approach</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a4754325-efc7-4c47-9c8a-11f7ce3ba02b" class="code"><code class="language-Java">interface Stack{
 static Stack empty(){ return new Stack(){}; }
 interface OnEmpty&lt;R&gt;{ R of(); }
 interface OnElem&lt;R&gt;{ R of(int elem, Stack tail); }
 default &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return a.of(); }
 default Stack push(int top){
		 Stack self= this;
		 return new Stack(){
				 public &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return b.of(top,self); }
				 //inductive case + recursive call
				 public int size(){ return 1 + self.size(); } //override size for 
				 //non empty stack as an anonymous inner class
		 };
 }
 
 //size using dynamic dispatch
 default int size(){ return 0; } //base case
}</code></pre></details></li></ul><ul id="e397f36d-2f6b-4915-bad6-ad8d156148d6" class="toggle"><li><details><summary>Stack Operations</summary><ul id="7d7e4286-4349-4156-aa21-277d4e88ac46" class="toggle"><li><details><summary>Stack ToString Operation</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1b512d73-4710-4b60-9f84-f34b034d5f78" class="code"><code class="language-Java">static String toS(Stack s){ return s.match(
 ()-&gt;&quot;[]&quot;,
 (top,tail)-&gt;&quot;[&quot; + toSInner(top,tail) + &quot;]&quot;
);}

//aux/helper method for recursion. should be private but has to be public for dd
static String toSInner(int top, Stack tail){ return tail.match(
 ()-&gt;&quot;&quot; + top,
 (i,s)-&gt;top + &quot;, &quot; + toSInner(i,s)
);}

How to turn a stack into a String? We define methods toS(Stack) and toSInner(int,Stack)
In toS(Stack):
 -If the stack is empty we return []
 -If the stack has top and tail we pass them to toSInner,
 we then add [] to the result.
In toSInner(int,Stack):
 -If the tail is empty, then top was the last element;
 we return it as a String.
 -If the tail was not empty, we need a comma to separate top
 from the rest of the string representation, obtained as a
 recursive call of toSInner.
Basic Insights:
 -A method taking a value and a stack is similar to
 a method taking a non empty stack.
 -We have to define toSInner so that we can use it recursively</code></pre></details></li></ul><ul id="4b70f25a-a6aa-463c-afc8-a99f06667918" class="toggle"><li><details><summary>Stack Max Operation</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4f8bffef-0e64-4e5a-90e1-8dee3a1cb2ca" class="code"><code class="language-Java">//entry
static int max(Stack s){ 
	return s.match(
		 ()-&gt;{ throw new Error(&quot;..&quot;); },
		 (top,tail)-&gt;max(top,tail)
		);
}

//aux/helper
static int max(int c, Stack tail){ 
	return tail.match(
		 ()-&gt;c,
		 (i,s)-&gt;max(Math.max(c,i),s)
		);
}


How to get the max element from a stack?
We define two methods max(Stack) and max(int,Stack).
As for before, the max(int,Stack) parameters basically represent a non empty stack.
In max(Stack)
-If the Stack is empty we throw an error:
 there is no max element of an empty stack
-If the Stack is not empty, we call max(top,tail)
In max(int,Stack) the first parameter represents the candidate max element.
 -If the stack is empty, return the candidate
-If the stack is not empty, compute the new candidate and recursively
 call max on the new candidate and the new tail.
Basic Insights:
 -We can use parameters to pass around state (the candidate)
 -We need to always consider the corner cases FIRST (empty Stack)
 -OO fundamental pattern: recursion is terminated by Dynamic dispatch.</code></pre></details></li></ul><ul id="2e920349-3713-411d-a73c-21a696b9ae0f" class="toggle"><li><details><summary>Stack  toList Operation</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="46ec5dd7-db3f-4c42-8a91-49d7f28942dd" class="code"><code class="language-Java">static List&lt;Integer&gt; toList(Stack s){
	 return fillList(s, new ArrayList&lt;Integer&gt;());
}

static List&lt;Integer&gt; fillList(Stack s, ArrayList&lt;Integer&gt; l){ 
		return s.match(
		 ()-&gt;Collections.unmodifiableList(l),
		 (top,tail)-&gt;{ l.add(top); return fillList(tail,l); }
		);
}

How to get a List from a Stack?
We define two methods toList(Stack) and fillList(Stack,ArrayList).
Here we use mutation to fill up the list. Thus this code is not functional.
In toList(Stack) we initialize the accumulator ArrayList and we call fillList.
In fillList(Stack,ArrayList)
 -If the stack is empty, return the list wrapped into a readonly wrapper.
-If the stack is not empty, add the first element to the list,
 and then call fillList recursively.
Basic Insights:
 -It is ok to use mutation here and there, we just have to be careful.
 In this case we used a mutable list, but this object is exposed as
 mutable only while fillList is running,
 no naked references to the mutable ArrayList survives.
 -In good programming it is very, very common to have a
 facade public method calling a recursive private method doing most of the job.</code></pre></details></li></ul><ul id="a287a21c-9bb1-467b-ae36-d14c93639589" class="toggle"><li><details><summary>toList to Stack Operation</summary><p id="6de26ed0-6020-49dc-bdb1-bf40d7e8758b" class="">we want the first item of the list to be the top of the stack, so we have to add items starting from the bottom to the start to keep this order due to push adding to the top of the stack</p><p id="e10047b0-459a-437c-9af2-f5a0c48d8352" class="">before java 22 we would have had to use numbers, now we can just do <code>var i:is.reversed()</code> reversed for each</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d8bec9e3-be1f-4665-ba6a-2810bece4dfd" class="code"><code class="language-Java">static Stack fromList(List&lt;Integer&gt; is){
 Stack res= Stack.empty();
 for(int i= is.size() - 1; i &gt;= 0; i--){
	 res = res.push(is.get(i));
 }
 return res;
} //the more obvious code below would reverse the order
 // for(var i:is){ res = res.push(i); }
 // for(var i:is.reversed()){ res = res.push(i); } //Available from Java 22!
 
How to get a Stack from a List? We define a fromList(List) method.
We initialize a res local variable with an empty stack.
Exploring the list in reverse,
 for all the elements of the list we push the element to the stack.
Finally we return res.
Basic Insights:
 -Yes, (2022) sometimes the old style still makes sense.
 Here it would have been much harder to avoid working explicitly
 with indexes. (2024: new reversed method avoids indexes )
 -We are not aiming to fully remove if/for/while/null/indexes.
 We aim to use them sparsely, and only in code that have very fixed
 and very simple behavior.</code></pre></details></li></ul></details></li></ul><ul id="ad35be31-c9d3-4275-a29e-95683a89976a" class="toggle"><li><details><summary>Match vs Internal Direct Recursion </summary><h3 id="dc09b396-3c6f-480b-9054-e2c552b6e7e5" class="">Match</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="310a7948-c2ac-44d1-9c01-95d01d81dd39" class="code"><code class="language-Java">//entry
static int max(Stack s){ 
	return s.match(
		 ()-&gt;{ throw new Error(&quot;..&quot;); },
		 (top,tail)-&gt;max(top,tail)
		);
}

//aux/helper
static int max(int c, Stack tail){ 
	return tail.match(
		 ()-&gt;c,
		 (i,s)-&gt;max(Math.max(c,i),s)
		);
}</code></pre><h3 id="1902131e-2eb1-44e0-8803-d126646a6a24" class="">Internal Direct Recursion</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fc784517-c506-4cc9-ba5b-a454c66df711" class="code"><code class="language-Java">interface Stack{
 static Stack empty(){ return new Stack(){
 
 default int max(){ throw new Error(&quot;..&quot;); }
 default int max(int t){ return t; }

 default Stack push(int top){
		 Stack tail= this;
		 return new Stack(){
				 public int max(){ return tail.max(top); }
				 public int max(int t){ return tail.max(Math.max(t,top)); }
		 }; 
 }
 }</code></pre></details></li></ul><ul id="6f19030c-a8a2-495e-a7d1-691165a14db3" class="toggle"><li><details><summary>Code Normalization</summary><h3 id="5bb130c4-df64-4d96-a7f6-3bef4b5befda" class="">Bad code</h3><figure id="70c03108-500b-4c24-8439-d0902b0bbb2c" class="image"><a href="Untitled%206.png"><img style="width:652px" src="Untitled%206.png"/></a></figure><h3 id="5bf0312b-965f-4dfc-a924-c1facf30b8b1" class="">Good code</h3><p id="c0cce43f-6832-4e42-bd1e-5ca104d5079b" class="">does the same thing as the bad code but its more simplified, making it more readable and easier to type</p><figure id="6c72b81a-074a-4cf5-9b96-6b9946d02544" class="image"><a href="Untitled%207.png"><img style="width:651.96875px" src="Untitled%207.png"/></a></figure><p id="14fe4f05-0c05-4d0e-936c-f9b1c8b6203e" class="">with deeper knowledge of java instead of programming in general, we can use java specific language features such as declaring point p in the instance of statement in the if</p><figure id="dc53ba70-99de-4961-b93e-f32d68e19538" class="image"><a href="Untitled%208.png"><img style="width:652px" src="Untitled%208.png"/></a></figure></details></li></ul><ul id="4b3b6542-414e-43c8-8aae-56bdbdea9ce1" class="toggle"><li><details><summary>Become a better programmer</summary><ul id="576e9846-2a63-4207-a8e8-5f04da766622" class="bulleted-list"><li style="list-style-type:disc">stop writting code just to make it work</li></ul><ul id="75a08c73-7dfe-45fc-acdf-8fd76542189d" class="bulleted-list"><li style="list-style-type:disc">code should be as simple, compact and safe as possible</li></ul><ul id="f09f7970-6858-4fe6-b67c-699ee4815822" class="bulleted-list"><li style="list-style-type:disc">relearn recursion with dynamic dispatch</li></ul><ul id="cfae87af-5fbf-4bd4-a39f-00dc253bcd51" class="bulleted-list"><li style="list-style-type:disc">re learn if else to guards<figure id="d5c7ef8a-b31e-49ff-9ebe-78fc720e75c1" class="image"><a href="Untitled%209.png"><img style="width:1700px" src="Untitled%209.png"/></a></figure></li></ul><ul id="233b6ae5-380d-4559-a2c3-b7134f39d045" class="bulleted-list"><li style="list-style-type:disc">learn all details of your language </li></ul></details></li></ul></details></li></ul><ul id="c7e0a249-7b7a-4ff4-a0bf-3efad68f4036" class="toggle"><li><details><summary>Factory Method &amp; Abstract Factory Patterns</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1a0bd463-e998-4573-af2a-087129f983b7"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">factory method forces the user to use static methods (eg: .of) to abstract away which type of object is actually created<br/>abstract factory pattern makes the <br/><mark class="highlight-yellow">client receive a factory</mark> object which is<mark class="highlight-yellow"> able to make a specific product</mark><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="56e87069-7647-47cb-833d-fd4cfa196fbe" class="code"><code class="language-Java">interface Animal{/*..*/} //Pre existing code
class Human implements Animal{/*..*/} //Pre existing code
class Cat implements Animal{/*..*/} //Pre existing code
class Dog implements Animal{/*..*/} //Pre existing code

Supplier&lt;Animal&gt; dogs = Dog::new;
Supplier&lt;Animal&gt; cats = Cat::new;
Supplier&lt;Human&gt; bobs = Human::new;

void clientCode(Supplier&lt;Animal&gt; animals){
	animals.get()
}

record Druid(List&lt;Supplier&lt;Animal&gt;&gt; summons){/*..*/}</code></pre><figure id="229b42a4-94f6-4d74-acd3-2490b3908b93" class="image"><a href="Untitled%2010.png"><img style="width:624px" src="Untitled%2010.png"/></a></figure></div></figure><ul id="d081f3c5-f9ba-4895-a873-57987e406c27" class="toggle"><li><details><summary>What is a Design Pattern?</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="42856568-0db2-445b-b49d-b6e5f0e528f2"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">a <mark class="highlight-yellow">modular way to use the </mark>programming <mark class="highlight-yellow">language</mark><ul id="bcb959b9-a0d8-4bd9-8f87-104d94f9e657" class="bulleted-list"><li style="list-style-type:disc">inheritance is a language feature, not pattern</li></ul><ul id="d5efea1a-1c63-477c-9398-d3b36c8ac0a9" class="bulleted-list"><li style="list-style-type:disc">purpose of patterns is to give a <mark class="highlight-yellow">solution to a problem</mark>. some solutions are better than others</li></ul><ul id="ee4cf77c-a5ab-476f-b13d-677d4c6e96e0" class="bulleted-list"><li style="list-style-type:disc">patterns are reusable, but we<mark class="highlight-yellow"> can change</mark> the <mark class="highlight-yellow">designs</mark></li></ul><ul id="0bdd76d7-a3ff-4bea-ac74-8644e65b3202" class="bulleted-list"><li style="list-style-type:disc">patterns have names so they can be shared and people know what you’re talking about</li></ul></div></figure><h3 id="7704126f-2955-4120-ba3e-bb2c5f597eee" class="">Essential pattern ingredients</h3><ul id="dc302117-9a1e-4dca-8b92-3f15f36a7172" class="bulleted-list"><li style="list-style-type:disc">pattern name</li></ul><ul id="fa47edbc-5252-4be0-bbab-4994f90e6ae8" class="bulleted-list"><li style="list-style-type:disc">problem describes when to apply the pattern</li></ul><ul id="8f9bd624-6d48-4e7a-996a-8d12abf6cb7d" class="bulleted-list"><li style="list-style-type:disc">solution describes elements which make up the pattern</li></ul><ul id="5d2c0718-acfc-48ff-a803-5258a0bd737a" class="bulleted-list"><li style="list-style-type:disc">the consequences are the results and trade off (of using the pattern)</li></ul><ul id="cab448e8-9490-4cc4-be4b-6cbadc39033e" class="bulleted-list"><li style="list-style-type:disc">patterns should also include an example and at least 3 known uses</li></ul><h3 id="3cb0b797-6be6-469e-a620-cfc9130332c4" class="">Lego Analogy</h3><ul id="6e1ffa66-e205-41d9-88ca-43db26991890" class="bulleted-list"><li style="list-style-type:disc">language features are lego pieces, the complete program is a construction made with lego pieces<figure id="ed23eb79-39f0-4415-a0f2-017cf7b5b974" class="image"><a href="Untitled%2011.png"><img style="width:288px" src="Untitled%2011.png"/></a></figure></li></ul><ul id="5fef0503-e433-44c3-b73d-0471611059c5" class="bulleted-list"><li style="list-style-type:disc">design pattern is how we align the lego bricks<figure id="505e5ac1-1714-4bff-9c4b-89da5ebc6509" class="image"><a href="Untitled%2012.png"><img style="width:562px" src="Untitled%2012.png"/></a></figure></li></ul><ul id="e23b1d84-68e8-42c8-9084-58c209afbede" class="bulleted-list"><li style="list-style-type:disc">anti patterns are when patterns are bad<figure id="eace4243-332f-41b2-a5c2-6d03cf95d8e7" class="image"><a href="Untitled%2013.png"><img style="width:576px" src="Untitled%2013.png"/></a></figure></li></ul></details></li></ul><ul id="b324b104-dc95-488e-8f95-01985a60a6fe" class="toggle"><li><details><summary>The Pattern Book</summary><ul id="6e1320ab-0e3b-4fe8-9fbb-6e886389e6c7" class="bulleted-list"><li style="list-style-type:disc">Design Patterns: Elements of Reusable Object-Oriented Software<ul id="63a40283-7aba-45b4-99ed-5218b8dc4be6" class="bulleted-list"><li style="list-style-type:circle">Gamma, Helm, Johnson, Vlissides</li></ul></li></ul><ul id="e4fde12f-cc06-4390-b026-033d4c140874" class="bulleted-list"><li style="list-style-type:disc">Creational patterns:<ul id="9059008a-8ff5-4c42-9858-6ce51849e156" class="bulleted-list"><li style="list-style-type:circle">– Factory Method, Abstract Factory, Builder, ...</li></ul></li></ul><ul id="43e89ba0-e29a-4ccd-9a1c-9589c34cb3e0" class="bulleted-list"><li style="list-style-type:disc">Structural patterns:<ul id="67f978d4-9fe2-4e1e-80b6-66973b32c87c" class="bulleted-list"><li style="list-style-type:circle">Adapter, Composite, Decorator, Facade, Bridge, Proxy, ...</li></ul></li></ul><ul id="9f7bf2f1-6b2e-4d9d-a332-63f9aed07cf8" class="bulleted-list"><li style="list-style-type:disc">Behavioural patterns:<ul id="47289918-1719-4dd5-867c-1bcaa43fb691" class="bulleted-list"><li style="list-style-type:circle">Observer, State, Strategy, Visitor, Template Method, Command, Interpreter, Chain of Responsibility, …</li></ul></li></ul></details></li></ul><ul id="da8d87e0-0d63-4676-9c68-af6570c43f19" class="toggle"><li><details><summary>Factory Pattern</summary><ul id="74197b1e-e49e-4081-b8db-ade6c61b9dbb" class="toggle"><li><details><summary>Factory Method ingredients</summary><h3 id="7c912667-8399-4980-afce-408db2343b82" class="">Problem</h3><p id="c0c052f5-7051-4cc8-aa37-ed4619a38201" class="">we want to abstract away what object is actually created</p><ul id="44fa01c8-9b11-40d9-bcdb-e25008119e31" class="bulleted-list"><li style="list-style-type:disc">to not expose a private concrete type (eg private inner class)</li></ul><ul id="647aa57c-1244-4ff6-9e5d-ebe106c0ac88" class="bulleted-list"><li style="list-style-type:disc">to avoid creating duplicated objects using new</li></ul><ul id="1db7ae99-cd31-481e-ac4b-d95bfa475afd" class="bulleted-list"><li style="list-style-type:disc">to keep the freedom of changing the concrete type during code evolution </li></ul><h3 id="3676ae74-a8e1-4b62-8132-7ad6a6a94fca" class="">Solution</h3><p id="f2a6cba2-1e29-451a-81fb-4009a06e3631" class="">make a static method return an object</p><ul id="bc334317-5e5a-4749-9530-8ae2dd68a8aa" class="bulleted-list"><li style="list-style-type:disc">this method may use the new keyword internally but the client doesn’t</li></ul><h3 id="824696ce-71a4-40cd-b471-fa8a29429a3b" class="">Consequences</h3><ul id="a9a4b6e2-48f8-4a20-97b2-95d44afba5d1" class="bulleted-list"><li style="list-style-type:disc">client code will lose control on object instantiation and cannot use new to create these objects</li></ul><ul id="5ff38c91-aaf8-4650-b588-8bd1a57b1ba4" class="bulleted-list"><li style="list-style-type:disc">library code will gain control of object instantiation and will be able to evolve better</li></ul><p id="ffff0813-4fd0-4ce2-a7b2-5bf0809a0f7b" class=""><del><em>most patterns have a trade off between client vs library code</em></del></p><h3 id="3432a37d-ce6c-4e5a-a43f-3057bdcfe2d9" class="">Examples</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="acc98049-2a5d-4a67-ab31-b6fea6bed470" class="code"><code class="language-Java">List.of(), List.of(a,b), Set.of(), Map.of(), Stream.of()….
 Path.of(URI) (gives us a Path)
 Files.lines(Path) (gives us a Stream)</code></pre></details></li></ul><ul id="e0040e96-d071-4ce3-a609-eb6e4b2194c5" class="toggle"><li><details><summary>Abstract Factory ingredients</summary><h3 id="4fe39648-737b-4cac-8273-cf52ddb88871" class="">Problem</h3><p id="13be3f4b-d463-4c06-aba7-9689146490a5" class="">client code needs to create different kinds of similar objects</p><ul id="581c0755-8560-4e1f-bb9a-a2da4d781516" class="bulleted-list"><li style="list-style-type:disc">code needs to be parametric on what concrete kind of object to create</li></ul><ul id="bc4ebe4b-3afe-4ea1-9401-b939822e42d9" class="bulleted-list"><li style="list-style-type:disc">eg: product interface and many product concrete classes implementing product</li></ul><h3 id="50d5c03c-052e-4115-b61d-08068cdbc7cb" class="">Solution</h3><p id="82023b1e-06be-40be-84da-e9ce112d9617" class="">client will receive an object (the factory) able to make a specific product (using a Factory method pattern)</p><h3 id="41674fef-4355-4f2d-9899-95dfa2a52d3d" class="">Consequences</h3><ul id="43063764-822d-4d5e-93df-267e8406e9ca" class="bulleted-list"><li style="list-style-type:disc">client code can not invoked with different factory objects</li></ul><ul id="929e186f-380c-452e-bf9b-207442bc0859" class="bulleted-list"><li style="list-style-type:disc">client behavior is more flexiable and more testable</li></ul><h3 id="efe48da1-d89e-45de-8484-118291e0f510" class="">Example</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3ed20806-6766-4ee7-ab7f-ebc4f5fe96b9" class="code"><code class="language-Java">Supplier&lt;T&gt;
 Mock objects
 Dependency Injection</code></pre></details></li></ul><ul id="fdfbf1e4-0c65-415f-bca2-b95483212b26" class="toggle"><li><details><summary>Abstract Factory Pattern UML Class Diagram</summary><blockquote id="8700a943-4d08-4a98-99ef-6788b759a158" class="">The client wants to use a Product (Animal), It will have to use a specific kind of product (Dog). We want to make the client parametric on the specific kind of product</blockquote><p id="260e5b9d-21c9-4d06-acb9-b32f6dc741e3" class="">Without factory pattern (just make dog object)</p><figure id="3cd52cbc-a57b-4f39-bcaf-2bdced43d1d1" class="image"><a href="Untitled%2014.png"><img style="width:618px" src="Untitled%2014.png"/></a></figure><p id="2fd7af32-0cbd-4a43-aeb3-f96ec139fd33" class="">with factory pattern</p><figure id="4243c12b-47be-4507-ac92-af4e845500dc" class="image"><a href="Untitled%2015.png"><img style="width:624px" src="Untitled%2015.png"/></a></figure><p id="ba122c0d-eb3d-4619-9173-14c98562e3ed" class="">this complex UML diagram in java corresponds to <code>Dog::new</code></p><figure id="f8ca8df6-3974-4ce7-8a52-d63337221bea" class="image"><a href="Untitled%2016.png"><img style="width:624px" src="Untitled%2016.png"/></a></figure><figure id="04ecab84-242a-4ee4-a935-0cd2d92543b6" class="image"><a href="Untitled%2010.png"><img style="width:624px" src="Untitled%2010.png"/></a></figure></details></li></ul><ul id="dfbc9842-8e18-4bb2-b2a3-fdec6fb4f51c" class="toggle"><li><details><summary>Abstract Factory Pattern Code in modern Java</summary><blockquote id="571fafee-88d1-4b1e-9c96-8697b6da4627" class="">We can use the pre existing Supplier&lt;T&gt; as the Abstract Factory<br/>class. We can create instances of the abstract factory by using a<br/>lambda<br/>(or the ‘::’ shortcut for lambdas).<br/></blockquote><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4459c8ae-7001-418e-a5b3-828e9c2c5169" class="code"><code class="language-Java">interface Animal{/*..*/} //Pre existing code
class Human implements Animal{/*..*/} //Pre existing code
class Cat implements Animal{/*..*/} //Pre existing code
class Dog implements Animal{/*..*/} //Pre existing code
...
Supplier&lt;Animal&gt; dogs = Dog::new;
Supplier&lt;Animal&gt; cats = Cat::new;
Supplier&lt;Human&gt; bobs = Human::new;

void clientCode(Supplier&lt;Animal&gt; animals){ 
		animals.get();
}

record Druid(List&lt;Supplier&lt;Animal&gt;&gt; summons){/*..*/}</code></pre><p id="7373f6d3-bb02-4cc1-a9e5-c6990fb0dda0" class="">The abstract factory pattern makes client code parametric on a pre<br/>existing class hierarchy.<br/></p></details></li></ul></details></li></ul><ul id="10d711d5-8493-4c41-aaa8-89772a6080bd" class="toggle"><li><details><summary>UML and Design patterns</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="2bf3b62b-4fa1-4223-999d-34f32c8e8669"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">design patterns often get explained using UML class diagrams<ul id="663081f4-21c9-47b0-ab3e-c77984d7444b" class="bulleted-list"><li style="list-style-type:disc">as a way to show parts and the roles</li></ul><ul id="4e06c3da-ab6c-44d2-9251-368312691471" class="bulleted-list"><li style="list-style-type:disc">this is bad if you expect all the boxes to translate into top level named classes/interfaces</li></ul><ul id="3b32d7c7-eec0-4df2-a84f-75592aa74bad" class="bulleted-list"><li style="list-style-type:disc">good if you understand how to see classes/interfaces as hidden inside modern java code</li></ul></div></figure><p id="151252ae-7814-4191-a9cc-6e30a07877d8" class="">lets see how java hides these classes/interfaces seen in UML inside modern code</p><h3 id="914bc98e-6058-45cc-9bb7-bbc6ef82bff8" class="">How many classes/interfaces here?</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="628c97a2-c8d7-430d-a130-2ad1b8fe4e72" class="code"><code class="language-Java">interface Stack{ //1
 static Stack empty(){ return new Stack(){}; } //2
 interface OnEmpty&lt;R&gt;{ R of(); } //3
 interface OnElem&lt;R&gt;{ R of(int elem, Stack tail); } //4
 default &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return a.of(); }
 default Stack push(int top){
		 Stack self= this;
		 return new Stack(){ //5
				 public &lt;R&gt; R match(OnEmpty&lt;R&gt; a, OnElem&lt;R&gt; b){ return b.of(top,self); }
		 };
 }
}
class Usage{ //6
 public static void main(String[] a){
 Stack s0= Stack.empty();//the empty stack
 Stack s1= s0.push(1);//[1]
 Stack many= Stack.empty().push(1).push(2).push(3);//[3,2,1]
 System.out.println(
		 s0.match(
				 ()-&gt;&quot;&lt;Empty&gt;&quot;, //7
				 (top,tail)-&gt;&quot;&quot;+top //8
		 )
 );
 }
}</code></pre><figure id="d88defdd-0780-4099-9418-13ca02ce9158" class="image"><a href="Untitled%2017.png"><img style="width:882px" src="Untitled%2017.png"/></a></figure><p id="86538370-6105-4fbe-b15c-52b87b0ba9a0" class="">
</p></details></li></ul></details></li></ul><ul id="aa2956f4-b34b-4076-8844-77d6c667c81f" class="toggle"><li><details><summary>External Iterator Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="cb60b363-9ed6-4298-a6a1-087939ad0c0d"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">instead of a class keeping track of its own iteration, use a sperate object to do so<br/>this allows for multiple different iteration states to be happening at once or in parallel without conflict<br/></div></figure><ul id="fff15230-e988-4646-b987-8039d33beb88" class="toggle"><li><details><summary>External Iterator Pattern Ingredients </summary><h3 id="489e34b7-4550-4e9f-99f4-db5ec59cc1da" class="">Problem</h3><p id="a4f2e8c2-1dc0-4c89-b26c-d5b9910308d7" class="">an object has a collection of data that we need to extract</p><ul id="f62c7ed1-5c5c-4c15-bdeb-c342da1a1b84" class="bulleted-list"><li style="list-style-type:disc">client must be able to extract this data consistently across a range of different collections</li></ul><h3 id="cc57e5f7-e744-4fd4-8cb7-e6b09a92f8fa" class="">Solution</h3><p id="d67ac38e-a023-42c2-8097-db02cf598a6f" class="">a method interface Something&lt;T&gt; producing elements of T</p><ul id="c3b84680-60b1-4672-afe5-7bf1736b4cd9" class="bulleted-list"><li style="list-style-type:disc">starting point Option: Supplier&lt;T&gt; and T get() method</li></ul><ul id="8efed59c-96a7-489d-8e0e-6ff9e4179410" class="bulleted-list"><li style="list-style-type:disc">how to signal termination?<ul id="3b40c9e8-60f7-47ff-9016-b111d440efb5" class="bulleted-list"><li style="list-style-type:circle">exception when get is called with no more elements<figure id="e2b5fd28-ead5-424b-98bd-51d6b345563e" class="image"><a href="Untitled%2018.png"><img style="width:1902px" src="Untitled%2018.png"/></a></figure></li></ul><ul id="c7fa4587-4739-4dad-a38d-d0b039c7fdda" class="bulleted-list"><li style="list-style-type:circle">Supplier&lt;Optional&lt;t&gt;&gt; where get returns empty to signal termination (functional way because its using concepts you already know together)<figure id="bec690d3-85cc-457a-81b7-611cb801e997" class="image"><a href="Untitled%2019.png"><img style="width:596px" src="Untitled%2019.png"/></a></figure></li></ul><ul id="14fd00c6-402b-409e-8bd0-af6b86b44efe" class="bulleted-list"><li style="list-style-type:circle">next/hasNext methods (recommended for OOP)<figure id="d058593e-fcf0-4c89-baaa-e59fc3f47219" class="image"><a href="Untitled%2020.png"><img style="width:596px" src="Untitled%2020.png"/></a></figure></li></ul><p id="5f719398-a350-4a93-9256-d04537bc021c" class="">
</p></li></ul></details></li></ul><ul id="d87ac284-986e-4517-ab2e-18545b2d6363" class="toggle"><li><details><summary>How to signal termination?</summary><ul id="01964c77-27ff-4861-a387-9187e263adae" class="bulleted-list"><li style="list-style-type:disc">exception when get is called with no more elements<figure id="2f167ff6-d7c7-46d4-9aec-451cdf97ddc0" class="image"><a href="Untitled%2018.png"><img style="width:1902px" src="Untitled%2018.png"/></a></figure></li></ul><ul id="527f320e-7d92-4b06-afc8-adf1e6f00665" class="bulleted-list"><li style="list-style-type:disc">Supplier&lt;Optional&lt;t&gt;&gt; where get returns empty to signal termination (functional way because its using concepts you already know together)<figure id="6b3d1ad3-cf36-4337-8919-603b1ab1bb56" class="image"><a href="Untitled%2019.png"><img style="width:596px" src="Untitled%2019.png"/></a></figure></li></ul><ul id="5b0cd5f9-4ce4-4982-a2e3-a6eb099eb8d5" class="bulleted-list"><li style="list-style-type:disc">next/hasNext methods (recommended for OOP)<figure id="64cda9a9-09da-432a-b5a4-3fcba72b173b" class="image"><a href="Untitled%2020.png"><img style="width:596px" src="Untitled%2020.png"/></a></figure></li></ul></details></li></ul><ul id="8d206808-bba0-4dc6-bb27-cbc1b4591999" class="toggle"><li><details><summary>Iterator + Iterable</summary><h3 id="d27d32da-e3c8-474f-a131-f8d07d45427d" class="">How to get Iterator out of an object?</h3><p id="f19701a2-3267-48c3-beaa-2695d5f9e59e" class="">make our object implement iterable which gives you an method to give you an iterator out of the object</p><figure id="b2730d4a-129a-4279-b507-31f31c14e952" class="image"><a href="Untitled%2021.png"><img style="width:652px" src="Untitled%2021.png"/></a></figure><ul id="460e8f52-44e7-4de5-b597-fcd70b7fa503" class="bulleted-list"><li style="list-style-type:disc">4 level of indirection</li></ul><h3 id="84cd212e-5d1e-4752-9906-0b7be98c8aa8" class="">Why we need iterator and iterable?</h3><p id="17cca166-2538-49cb-9520-8b3aabb2c560" class="">problem of just using iterator is that the iterator points to a specific/current element</p><p id="4c6df10e-e2ba-4c49-a682-3021e22b12e0" class="">the list doesn’t have this pointer to the current point</p><p id="0e501991-7a63-4adf-aa8c-8c7d5906d579" class="">multiple iterations can happen at the same time (eg nested for)</p><p id="1b5f8949-e868-44f0-8cdf-ec42bf3c21bb" class="">we need independent iterator objects which keeps track of each iteration that is happening </p><figure id="82473fa2-a27e-45dd-a16d-823105da03e1" class="image"><a href="Untitled%2022.png"><img style="width:1871px" src="Untitled%2022.png"/></a></figure><h3 id="e0c35e5f-a4df-44cf-9707-6d08c289c8d2" class="">True nature of For Each</h3><figure id="5541afa1-607c-4e83-b3ca-268e0385e1c2" class="image"><a href="Untitled%2023.png"><img style="width:2235px" src="Untitled%2023.png"/></a></figure></details></li></ul></details></li></ul><ul id="77b6918c-3652-4746-823f-3bc2ff7f216c" class="toggle"><li><details><summary>Composite Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="ae0c5d7d-c6b0-4f1e-bdbb-89ca46b7c3ef"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">objects inside of objects to represent data of complex shapes<ul id="a22cbf50-e9af-4451-96f6-b04ae5012a6d" class="bulleted-list"><li style="list-style-type:disc">most fundamental and pervasive OOP pattern</li></ul><ul id="c1d39484-a33e-427b-bc49-67269bba5788" class="bulleted-list"><li style="list-style-type:disc">data with recursive shape can be defined using subtyping<ul id="23a06ec3-0dcd-4d6c-965f-8f5035b3f160" class="bulleted-list"><li style="list-style-type:circle">when a part of the data structure can look like the whole data structure, you have recursion in your data structure</li></ul><ul id="40d517dc-eccb-4029-88bc-aa0f9e4c1e74" class="bulleted-list"><li style="list-style-type:circle">if that&#x27;s the case then its easy to use recursion algorithms inside your data structure</li></ul></li></ul><ul id="21056f73-ded9-4e2d-b111-d05dd93ea972" class="bulleted-list"><li style="list-style-type:disc">operations can be defined with recursions + dynamic dispatch</li></ul><ul id="229e2be6-fe3e-46b5-bdbc-2b9d61bbdbe0" class="bulleted-list"><li style="list-style-type:disc">trees, stacks, linked lists, swing components, html, md are examples of composite patterns and recursive data structures</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a10f7b21-d7b7-4421-a839-711106be6003" class="code"><code class="language-Java">interface Expr{ //component
		void operation();
}

class Literal implements Expr{ //leaf implements the component

}

//composite implements the component and stores 
//other components to call operationson
class Add implements Expr{ 
		List&lt;Component&gt; children = new ArrayList&lt;&gt;();
		
		add(Component component){
				children.add(component);
		}
    remove(Component component){
		    children.remove(component);
    }
    
    public void operation() {
        System.out.println(&quot;Composite operation&quot;);
        for (Component child : children) {
            child.operation();
        }
    }
}

Expr a = new Literal();
Expr b = new Literal();

Expr adder = new Add();

adder.add(a);
adder.add(b);

adder.operation();</code></pre></div></figure><ul id="c4ed6a08-8055-4755-a671-26bc96fdd13a" class="block-color-default toggle"><li><details><summary>Expr, Lit, Add example</summary><blockquote id="fbf6ba98-4917-462a-a727-c96e007f6fcd" class="">We will now see an example where we have an Expression<br/>interface and a Literal and Addition data variants<br/>The Expression is the Component<br/>The Literal is a Leaf<br/>The Addition is a Composite<br/></blockquote><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bfa683f1-bf4d-496a-9bca-bd3a878f8c5d" class="code"><code class="language-Java">interface Exp{ //one unifying interface that tells you how the whole data structuer will work around it
		//operations here on that interface
		String toS(); 
} 

//subtypes of that interface and implements all the operations
record Lit(int val) implements Exp{
	 public String toS(){return &quot;&quot;+val;}
}
record Add(Exp left, Exp right) implements Exp{
	 public String toS(){return &quot;(&quot;+left.toS()+&quot;+&quot;+right.toS()+&quot;)&quot;;}
}

List&lt;Exp&gt; data=List.of(
 new Lit(4), //Solution
 new Add(new Lit(1),new Lit(2)), //Solution
 new Add(new Lit(1),new Add(new Lit(2),new Lit(3))),//Solution
 new Add(new Add(new Lit(1),new Lit(2)),new Lit(3)) //Solution
);
assert data.get(0).toS().equals(&quot;4&quot;):data.get(0).toS();
assert data.get(1).toS().equals(&quot;(1+2)&quot;):data.get(1).toS();
assert data.get(2).toS().equals(&quot;(1+(2+3))&quot;):data.get(2).toS();
assert data.get(3).toS().equals(&quot;((1+2)+3)&quot;):data.get(3).toS()</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="81e6abe8-c92d-4cd9-8475-beb78c41ade2" class="code"><code class="language-Java">An expression Exp is a literal Lit or an addition Add.
Lit has an int value, Add has a left and a right subexpression
Those cases all define the &#x27;toS&#x27; method.
We can create Exp of various forms by objects with subobjects
 new Lit(4), //Leaf
 new Add( new Lit(1), new Lit(2) ), //Composite
 new Add( new Lit(1), new Add( new Lit(2), new Lit(3) ) ),
 new Add( new Add( new Lit(1), new Lit(2) ), new Lit(3) )
This is basically how do you make a tree with pure OO.
Note: the various nodes/leaf of the tree can be of different types</code></pre><h3 id="67820121-d869-4ac6-abf9-ef7aaaf66947" class="">WAT second solutions</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="70e933b3-26e1-4184-b7b0-af380fe6e910" class="code"><code class="language-Java">interface Exp{ String toS(); } 
 public String toS(){return &quot;&quot;+val;}
}
record Add(Exp left, Exp right) implements Exp{
 public String toS(){return &quot;(&quot;+left.toS()+&quot;+&quot;+right.toS()+&quot;)&quot;;}
}
record Mul(Exp left, Exp right) implements Exp{ //Solution
 public String toS(){return &quot;(&quot;+left.toS()+&quot;*&quot;+right.toS()+&quot;)&quot;;}
}
class Data{/*omitted*/}
public class Exercise {
 public static void main(String[]a) {
 List&lt;Exp&gt; d = Data.of();
 assert d.get(0).toS().equals(&quot;4&quot;):d.get(0).toS();
 assert d.get(1).toS().equals(&quot;(1*2)&quot;):d.get(1).toS();
 assert d.get(2).toS().equals(&quot;(1*(2+3))&quot;):d.get(2).toS();
 assert d.get(3).toS().equals(&quot;((1*2)+3)&quot;):d.get(3).toS();
 
We can add new kinds of nodes/leaves to our OO trees.
Note: we do not need to modify existing Exp/Lit/Add code!!</code></pre><h3 id="34e902a1-dd8a-4d81-b109-1b54fa012e91" class="">WAT third solutions</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c6be2a81-5300-4818-b484-489086d7332f" class="code"><code class="language-Java">class OwnedError extends Error{ OwnedError(){super(&quot;..&quot;);} }
abstract class Exp{
 private boolean isOwned= false;
 public void setOwned(){
 if(isOwned){ throw new OwnedError(); }
 isOwned = true;
 }
 abstract String toS();
}
class Lit extends Exp{
 final int val; Lit(int val){ this.val= val; }
 public String toS(){return &quot;&quot;+val;}
}
class Add extends Exp{ //Solution
 final Exp left; final Exp right; //Solution
 Add(Exp left, Exp right){ //Solution
 this.left= left; //Solution
 this.right= right; //Solution
 left.setOwned(); //Solution
 right.setOwned(); //Solution
 }
 public String toS(){return &quot;(&quot;+left.toS()+&quot;+&quot;+right.toS()+&quot;)&quot;;}</code></pre><ul id="353915b6-3d9f-44ce-9f5d-0ac9b3c69d21" class="bulleted-list"><li style="list-style-type:disc">field that says if the child object is owned</li></ul><ul id="e3fd3669-7b79-4abe-85ba-69e8b80cd64d" class="bulleted-list"><li style="list-style-type:disc">if the child is owned then if you try to make another object try to own the object (which will cause a cycle) then the code will fail by throwing an exception<p id="3fa17481-39a2-4eed-ada9-70c4c65cb711" class="">fail faster</p></li></ul><ul id="6ddb2d7e-6339-4a6c-9292-0c7790dc5a18" class="bulleted-list"><li style="list-style-type:disc">its add’s duty to call setowned on a child object</li></ul><ul id="4ae3360e-23c7-45c0-b77c-42a8dee982ec" class="bulleted-list"><li style="list-style-type:disc">this design makes the child object before the parent, then add the child to the new parent</li></ul><h3 id="9849a105-75b3-4cae-8e6f-2c117b0e66cf" class="">Owner Field</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="51472cc3-e08b-4493-9a97-6eb3b82257b5" class="code"><code class="language-Java">abstract class Exp{
 abstract String toS();

 private static final Owner root= new Owner(){};
 private Owner owner= root;
 private interface Owner{
 default void remove(Exp exp){
 assert exp.owner == this;
 exp.owner = Exp.root;
 };
 }
 static abstract class HasChild extends Exp implements Owner{
 private final List&lt;Exp&gt; childs= new ArrayList&lt;&gt;();
 .. }}
Code design:
Exp.root is the private top
level owner. It is not an
Exp, just an Owner.
A composite Exp has
children, so a concrete
composite should extend
Exp.HasChild.
Any Exp has an Owner. It may
be the root owner or an
Exp.HasChild.
root,owner and Owner are
private of Exp. But since
HasChild is nested in Exp,
it can see them.
Owner Exp
HasChild
1 *
Owner is nested in Exp.
This is only about
visibility, not inheritance!</code></pre><h3 id="8b232fb9-162b-470f-9574-cd69c78c8728" class="">addChild method</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cffb4e11-4a3c-494b-8297-989cc04bba5d" class="code"><code class="language-Java">class UnremovableChildError extends Error{}
abstract class Exp{
 ...
 static abstract class HasChild extends Exp implements Owner{
 private final List&lt;Exp&gt; childs= new ArrayList&lt;&gt;();
 public List&lt;Exp&gt; childs(){ return Collections.unmodifiableList(childs); }

 public void remove(Exp exp){
 Owner.super.remove(exp);
 var changed= childs.remove(exp);
 assert changed;
 }
 public void addChild(Exp child){//Solution HERE!
 //if (child.owner == this){ return; }
 for (Owner o= this; o instanceof Exp e; o = e.owner){ //linked list of owners
 if (o == child){ throw new UnremovableChildError(); }
 }
 child.owner.remove(child);
 assert child.owner == Exp.root;//redundant? more readable?
 child.owner = this;
 this.childs.add(child);
 }
 abstract String toS();
 }
}</code></pre><figure id="fc7086f5-1e51-4f6a-90fb-c2b235cd7ac4" class="image"><a href="Untitled%2024.png"><img style="width:440px" src="Untitled%2024.png"/></a></figure></details></li></ul><ul id="4993db8c-a773-4f4c-9c9c-4a5f9c7bfe04" class="toggle"><li><details><summary>Enforcing a tree structure</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="b1aab46b-f294-4069-9e73-1b5e1451712d"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">object can only be assigned to a field of a composite one time only<ul id="b47e667c-a1fd-4033-99a0-78381396b608" class="bulleted-list"><li style="list-style-type:disc">this prevents cycles (graphs/DAGS)</li></ul><ul id="b7b96d57-9149-4265-807c-050935ab80b6" class="bulleted-list"><li style="list-style-type:disc">any extra attempt will cause an error</li></ul><ul id="2058821b-6d01-4d04-bcc1-ba7061c05ec4" class="bulleted-list"><li style="list-style-type:disc">forces a tree structure by throwing an error</li></ul><ul id="34f9f5fa-dfdd-42fc-bc92-f9417c0efab2" class="bulleted-list"><li style="list-style-type:disc">this is what java swing does internally </li></ul></div></figure><ul id="a2c9567c-a2e8-4208-9690-139a0df3eb2e" class="toggle"><li><details><summary>Why tree?</summary><ul id="5b310be8-3394-44cc-87f8-104a4b132c55" class="bulleted-list"><li style="list-style-type:disc">composite pattern should resemble a tree instead of a graph</li></ul><figure id="916804a1-9374-4172-a148-bf570af1df6f" class="image"><a href="Untitled%2025.png"><img style="width:240px" src="Untitled%2025.png"/></a></figure><ul id="a2e3afdf-6dec-4d74-8e6d-594f89820f93" class="bulleted-list"><li style="list-style-type:disc">first is an object graph with cycles, NOT A TREE</li></ul><ul id="e0400f19-2591-49ce-9b5c-b4b7205f1ec5" class="bulleted-list"><li style="list-style-type:disc">second is a DAG (directed acyclic graph), it allows aliicing (A and C points to B)<ul id="0e9d5bc6-b260-4e7c-945f-63e2ddd68d76" class="bulleted-list"><li style="list-style-type:circle">dag doesn’t have cycles (no way to store at any object and get to any other object)</li></ul></li></ul><ul id="00630264-1acc-440b-9b62-d30cf4ea5901" class="bulleted-list"><li style="list-style-type:disc">then we just have a tree</li></ul><h3 id="1389652e-0fce-4aa7-b439-68e8d764ec28" class="">Why enforcing a tree structure?</h3><p id="725319d0-25af-45fc-be27-b767178e6e61" class="">cycles cause infinite loops and cause the program to go into stack overflow</p><p id="c8977e4c-7e29-4d8c-92b0-f13a009844e3" class="">for example our tostring method will fail if the data structure isn’t a tree</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2c69a35d-81e2-4b29-b855-f3d463ca2cba" class="code"><code class="language-Java">interface Exp{ //one unifying interface that tells you how the whole data structuer will work around it
		//operations here on that interface
		String toS(); 
} 

//subtypes of that interface and implements all the operations
record Lit(int val) implements Exp{
	 public String toS(){return &quot;&quot;+val;}
}
record Add(Exp left, Exp right) implements Exp{
	 public String toS(){return &quot;(&quot;+left.toS()+&quot;+&quot;+right.toS()+&quot;)&quot;;}
}</code></pre><h3 id="f4ac5586-5d46-4735-86c0-5a08ea1b5183" class="">What is a problem with a DAG?</h3><p id="66f83690-16fc-4b63-8005-2707dc9dc36d" class="">may take exponential computation over a reasonablly small DAG</p><ul id="74ec4293-3aff-435c-bf9e-7b3e7995d6d4" class="bulleted-list"><li style="list-style-type:disc">small DAG = a lot of unnecessary repeating computation<p id="9d9e7801-886b-4cb0-8233-a456b108c5a3" class="">because you keep going back to the same visited branch over and over again</p></li></ul></details></li></ul><ul id="25ecb967-18a2-45ca-af4b-9fa1329783d6" class="toggle"><li><details><summary>Tree vs DAG (code to graph)</summary><figure id="52962967-86d0-4dc7-bde9-5a0167d569d2" class="image"><a href="Untitled%2026.png"><img style="width:624px" src="Untitled%2026.png"/></a></figure></details></li></ul><ul id="c6c13598-d57c-4233-b639-a64e038c727c" class="toggle"><li><details><summary>How to enforce a tree?</summary><p id="4d236368-1f94-4658-b8cc-b270e9192b45" class="">force a tree structure by throwing an error when you try to assign a child that already has a parent to a new parent</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="30d6f9bf-3630-49a7-9de6-0ec7bd25cf7f" class="code"><code class="language-Java">class OwnedError extends Error{ OwnedError(){super(&quot;..&quot;);} }
abstract class Exp{
 private boolean isOwned= false;
 public void setOwned(){
 if(isOwned){ throw new OwnedError(); }
 isOwned = true;
 }
 abstract String toS();
}
class Lit extends Exp{
 final int val; Lit(int val){ this.val= val; }
 public String toS(){return &quot;&quot;+val;}
}
class Add extends Exp{ //Solution
 final Exp left; final Exp right; //Solution
 Add(Exp left, Exp right){ //Solution
 this.left= left; //Solution
 this.right= right; //Solution
 left.setOwned(); //Solution
 right.setOwned(); //Solution
 }
 public String toS(){return &quot;(&quot;+left.toS()+&quot;+&quot;+right.toS()+&quot;)&quot;;}</code></pre></details></li></ul><ul id="004e112a-04cd-4a49-9b90-f604c88628b5" class="toggle"><li><details><summary>attempt to &#x27;fix the tree’</summary></details></li></ul></details></li></ul><ul id="517597b5-d6af-4324-9f76-0bc2aed2588d" class="toggle"><li><details><summary>General idea</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="79fb49f0-2d8e-48bf-a7fc-bc2ed11683a2" class="code"><code class="language-Plain Text">--General idea--
In this set up, Composites have a list of children.
In this variant we are trying to ensure that the composite graph is a tree,
and we try to fix the graph otherwise.
This is obtained by remembering the container object of any Exp.
Expressions that have not been explicitly inserted into another
sub-expression are assumed to be contained into a &#x27;root&#x27;.
That is, from any Exp, navigating the owners of the owners
we should eventually reach &#x27;root&#x27;.
As you can see, the idea of removing a child to prevent arbitrary graphs
is not trivial and still need to be able to throw errors in some corner cases.
It is working only in the cases where mostly the composite just has a list of children.
If the children need to be in a specific number and serving a specific role,
this solution would need to throw &#x27;UnremovableChildError&#x27; much more often to address that.

Some other languages (not Java) use a more sophisticated type system to
ensure that some datastructures are tree shaped.</code></pre></details></li></ul><ul id="1da00853-7a65-409a-9a60-271d93a50b3a" class="toggle"><li><details><summary>More examples of Composites</summary><ul id="ee55d332-30d0-442d-ae82-aed27c7317ad" class="toggle"><li><details><summary>html</summary><h3 id="689f4d79-4eed-45ad-b780-70aa509b53fb" class="">HTML</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5b4e305c-3e78-4154-a904-eba806e85273" class="code"><code class="language-Java">interface Node{ String toHTML(); }
record P(String text) implements Node{
 public String toHTML(){ return &quot;&lt;P&gt;&quot; + text + &quot;&lt;/P&gt;&quot;; }
}
record Div(List&lt;Node&gt; ns) implements Node{
 public String toHTML(){
 return ns.stream()
 .map(Node::toHTML)
 .collect(Collectors.joining(&quot;\n&quot;,&quot;&lt;DIV&gt;\n&quot;,&quot;\n&lt;/DIV&gt;&quot;));
 }
}
record A(String href, String text) implements Node{
 public String toHTML(){ return &quot;&lt;A href=\&quot;&quot; + href + &quot;\&quot;&gt;&quot; + text + &quot;&lt;/A&gt;&quot;; }
}
record Ul(List&lt;Li&gt; lis) implements Node{
 public String toHTML(){
 return lis.stream()
 .map(Li::toHTML)
 .collect(Collectors.joining(&quot;\n&quot;, &quot;&lt;UL&gt;\n&quot;, &quot;\n&lt;/UL&gt;&quot;));
 }
}
record Li(Node node) implements Node{
 public String toHTML(){ return &quot;&lt;LI&gt;&quot; + node.toHTML() + &quot;&lt;/LI&gt;&quot;; }
}</code></pre><p id="af6343fa-ce0c-4e0c-a635-ae4bf55bea5f" class="">more operations</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f12a39b-b0bd-491c-956b-f7e4286dae31" class="code"><code class="language-Java">interface Node{ op1(); op2(); op3(); }
record P(String text) implements Node{
 op1(){..} op2(){..} op3(){..}
}
record Div(List&lt;Node&gt; ns) implements Node{
 op1(){..} op2(){..} op3(){..}
}
record A(String href, String text) implements Node{
 op1(){..} op2(){..} op3(){..}
}
record Ul(List&lt;Li&gt; lis) implements Node{
 op1(){..} op2(){..} op3(){..}
}
record Li(Node node) implements Node{
 op1(){..} op2(){..} op3(){..}
}
...
record MyTag(..) implements Node{
 op1(){..} op2(){..} op3(){..}
}

/**
With the composite we can have many
operations (op1, op2, op3) and many
data variants (P, Div, A, ...)
To add data variants we do not need
to modify existing code. Sometimes
we will call operations where there
is no need to modify existing code
&#x27;easy operations&#x27;. But what we mean
is: it is a &#x27;modular operation&#x27;!
It can be done without having
control of the existing code, thus
the existing code could even be in
a library!
Instead, to add operations, we
would need to implement that
operation inside of all the
existing data variant.
Thus we would need control of all
that code.

*/</code></pre><p id="c900eb79-b22e-4e8f-b539-386d149aca94" class="">Easy/Modular<br/>We can add data variants<br/>(P, Div,A, ..)<br/>We can import a library defining<br/>some data variants and we can add<br/>our own.<br/></p><p id="4995ae27-be51-48ca-aae3-2d153faf8440" class="">
</p><p id="86102d56-9c07-42a2-ad27-a3d188b7bca7" class="">Hard/Pervasive</p><p id="55fa5dcb-f2fe-4e43-be1a-f805c8fd3b5a" class="">To add operations, we would need to<br/>implement that operation inside of<br/>all the existing data variant, thus<br/>we would need control of all that<br/>code. This means that we can not<br/>simply import the existing data<br/>variants from a library.<br/></p><p id="4888a9ec-525b-4232-8a05-1c1c016ea7b5" class="">
</p><p id="7149e5fb-0e10-4dbc-bd8c-fec3225305da" class="">Open recursion</p><p id="6e3f68a7-0a33-4981-b2c9-54c3eb7ee0a6" class="">Operations rely on &#x27;open recursion&#x27;<br/>To define an operation (toHTML) we often call the same operation on<br/>the children. For example look at<br/> public String toHTML(){ return &quot;<br/></p><ul id="25a67fad-94eb-468e-8073-c21f099c692b" class="bulleted-list"><li style="list-style-type:disc">&quot; + node.toHTML() + &quot;</li></ul><p id="7ac7acb8-2fa7-44b9-a718-f1f9d6cc3d0c" class="">&quot;; }<br/>As you can see, we call &#x27;.toHTML()&#x27; on our children node, but we do<br/>not know what kind of data variant node is.<br/>Open recursion == by adding more data variants, we increase the range<br/>of possible behavior of node.toHTML()<br/></p></details></li></ul><figure id="80329a5d-a51a-451e-a6a1-16ec9ef6f418" class="image"><a href="Untitled%2027.png"><img style="width:2560px" src="Untitled%2027.png"/></a></figure><figure id="129edd6d-aab2-440d-ab51-18d13f6e7e10" class="image"><a href="Untitled%2028.png"><img style="width:2555px" src="Untitled%2028.png"/></a></figure></details></li></ul><ul id="913f8b7e-140e-4d2d-9765-8bb640a6919f" class="toggle"><li><details><summary>General Variations for Composite</summary><ol type="1" id="2614a44a-555f-4df1-beea-1f6e2a91ae3c" class="numbered-list" start="1"><li>tree/DAG not enforced</li></ol><ol type="1" id="9dc743b9-58e2-4401-a81b-dc6a5dde333d" class="numbered-list" start="2"><li>tree enforced by error </li></ol><ol type="1" id="ec2a350a-602b-464f-97b7-0413e2bd693c" class="numbered-list" start="3"><li>tree enforced by mutation</li></ol><ol type="1" id="f95c84a5-488a-49d6-b615-6b5d455f6fd2" class="numbered-list" start="4"><li>DAG enforced by error</li></ol><p id="e222fe66-9f2c-4cc1-814c-81b05a176365" class="">
</p><ol type="1" id="caa1496d-162d-491c-9d7b-6c3d1001c330" class="numbered-list" start="1"><li>regular shape </li></ol><ol type="1" id="2cc9795a-fe68-407f-ad0d-c183a433803f" class="numbered-list" start="2"><li>custom shape</li></ol><p id="488f0dcf-54ef-4bcb-958e-ed5a0ff01d32" class="">most composites = tree not enforced + custom shape</p></details></li></ul></details></li></ul><ul id="e88b32d8-61ed-4622-9b3a-2d7a50032525" class="toggle"><li><details><summary>Singleton, Enum &amp; Flyweight</summary><ul id="e6fd2584-06d5-4fe4-88b9-e9bbb6e408dc" class="toggle"><li><details><summary>Singleton Pattern</summary><ul id="546ec47d-9c8b-4fe2-830d-447b7776906f" class="bulleted-list"><li style="list-style-type:disc">memory consumption can be a big problem</li></ul><ul id="d73faa4a-c440-4a59-8366-164f93706e52" class="bulleted-list"><li style="list-style-type:disc">many programs with large memory are caused by a lot of structurally identical objects</li></ul><ul id="b98b4024-8e92-4577-a463-a91423aa04fc" class="bulleted-list"><li style="list-style-type:disc">singleton and flyweight fight this pattern</li></ul><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="71355a1b-8900-4a15-ac53-e46db5b706eb"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">If we can statically identify a kind of object that is likely to be repeated over and over again, we can simply reuse the same object instead.<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="18ce07bf-0f58-43ed-805a-e7476a53109b" class="code"><code class="language-Java">//Conventional Singleton code
class Singleton {
 private static Singleton instance= new Singleton();
 private Singleton() {}// Private constructor to prevent instantiation
 public static Singleton instance() { return instance; }
 public void someMethod() { /*..*/ }
}</code></pre></div></figure><h3 id="3805a0fa-2cea-404a-9812-3036aa76b9bf" class="">Empty List Singleton </h3><p id="6d692447-c168-4fb4-af60-6e6d7e727e5b" class="">List.of() returns a singleton of an empty list object, meaning each time List.of() doesn’t create a new empty list but instead an immutable reference to an empty list</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="594b77a8-46ea-4057-92b4-ce0e4e5a1341" class="code"><code class="language-Java">var a = List.of();
var b = List.of();
assert a == b; //both share the same address
</code></pre><ul id="68327cac-cdff-49b0-b61a-9a9f48051e3e" class="bulleted-list"><li style="list-style-type:disc">Same for Set.of(), Map.of() etc.</li></ul><p id="94baba4b-6dc5-4710-9c17-91acc48e33fb" class="">This can save massive amount of memory: we do not need to<br/>allocate any memory when we call List.of()<br/></p><h3 id="bf66700f-1f18-45b8-bdb3-18e16e1b11fd" class="">Singleton for shared state</h3><p id="e33aadfd-66e4-4190-b40b-1fe1aa404b52" class="">Sometimes we want a singleton objects to work as a global way to share state. For example, a logger. Here we have a general logger interface and a BaseLogger.Instance singleton.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8f72998c-ef22-4220-9883-b1e7be97f745" class="code"><code class="language-Java">interface Logger{
 void add(String event);
 String get();
}
enum BaseLogger implements Logger{
 Instance;
 private ArrayList&lt;String&gt; events= new ArrayList&lt;&gt;();
 public void add(String event){ events.add(event); }
 public String get() { return events.toString(); }
}</code></pre><p id="4770bc76-6649-4d83-8c31-3dab323b674c" class="">What?? enum? an enum with a single constant?</p></details></li></ul><ul id="19b5d440-968b-4382-bde6-b1dab6e68003" class="toggle"><li><details><summary>Java Enums</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="2e7b606a-e51b-48b6-ab4e-d25a35267201"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"></div></figure><blockquote id="e68afdf4-088a-46e4-824d-940e358f2378" class="">concepts are not shared between languages, C enums, rust enums and java enums are all different <ul id="8f78e61d-0882-4674-9958-16e15a47517d" class="bulleted-list"><li style="list-style-type:disc">in java, an Enum type with only a single enumarted constant makes perfect sense </li></ul><ul id="f30a877f-80de-4820-b2a1-e283bead304e" class="bulleted-list"><li style="list-style-type:disc">java enums are generalized singleton patterns<ul id="e0109c6a-bfaa-4b5a-a8cb-8bf9c3d4619c" class="bulleted-list"><li style="list-style-type:circle">constants of enums are just objects<ul id="19ad0a0f-4bc0-49e9-acc6-dcce4807fec4" class="bulleted-list"><li style="list-style-type:square">they can implement interfaces</li></ul><ul id="9006451e-f7dc-4d68-a0c8-510dbdc743c7" class="bulleted-list"><li style="list-style-type:square">but they CANNOT implement other classes, just like records because they are already implementing the Enum class</li></ul><ul id="a9855281-948c-4e7e-8792-d65bac82528a" class="bulleted-list"><li style="list-style-type:square">cannot call new outside of the enum body</li></ul><ul id="59cf3518-5ec8-457f-bb21-cb2acbe6e54e" class="bulleted-list"><li style="list-style-type:square">they can have fields and constructors</li></ul><ul id="f7cae20a-9566-4284-9c21-2304fa6fc198" class="bulleted-list"><li style="list-style-type:square">they can have methods</li></ul><ul id="3b31eba1-e16c-43ef-88eb-9490af49b46d" class="bulleted-list"><li style="list-style-type:square">different constants in the enum can override methods to express different beaviour</li></ul><ul id="6e17566e-c9d0-416b-9d04-254b8fe66614" class="bulleted-list"><li style="list-style-type:square">An enum with a single constant is a singleton pattern. an enum with more than once constant is a generalized singleton pattern</li></ul></li></ul></li></ul></blockquote><h3 id="31436d38-52e1-4d78-a14d-5eb93275161b" class="">Java official example</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="54dd8787-efb8-41c4-91db-e13a541aa4b0" class="code"><code class="language-Java">enum Planet {
		//symbloic constants (identifiers don&#x27;t have to be all upper cases)
		Mercury (3.303e+23, 2.4397e6),
		Venus (4.869e+24, 6.0518e6),
		Earth (5.976e+24, 6.37814e6),
		Mars (6.421e+23, 3.3972e6),
		Jupiter (1.9e+27, 7.1492e7),
		Saturn (5.688e+26, 6.0268e7),
		Uranus (8.686e+25, 2.5559e7),
		Neptune (1.024e+26, 2.4746e7);
		
		//fields
		private final double mass; // in kilograms
		private final double radius; // in meters
		
		//constructor
		Planet(double mass, double radius) {
				this.mass = mass; this.radius = radius; }
		
		//methods
		double mass() { return mass; }
		double radius() { return radius; }
		
		public static final double G = 6.67300E-11;
		
		double surfaceGravity() { return G * mass / (radius * radius); }
		
		double surfaceWeight(double otherMass) {
		return otherMass * surfaceGravity();
		}
}</code></pre><h3 id="a53af729-a55f-4078-91f0-3d611dd05c7e" class="">My attempt (enum for direction using composites)</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0f0184e8-5f11-42bf-968c-b262fd1a0c31" class="code"><code class="language-Java">//naive
enum Direction{
		North(West,East), //Compile time error here.
		East(North,South), //Can not use West before is defined
		South(East,West),
		West(South,North);
		
		final Direction left;
		final Direction right;
		
		Direction(Direction left, Direction right){
				this.left= left; this.right= right;
		}
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ebf3a7ef-a262-46e9-b365-99e05c6305e5" class="code"><code class="language-Java">//fixed
enum Direction{
		North,
		East,
		South,
		West;
		
		private Direction left;
		private Direction right;
		
		public Direction left() { return left; }
		public Direction right() { return right; }
		
		static {//does happen after all constants are initialized
				North.set(West,East);
				East.set(North,South);
				South.set(East,West);
				West.set(South,North);
		}
		
		private void set(Direction left, Direction right){
				this.left= left; 
				this.right= right;
		}
}</code></pre><h3 id="33e0717d-726c-4f79-aad2-8cdde8c6eee5" class="">Enum + Dynamic Dispatch</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1fdcac54-1810-4cc9-9b30-3dfca18968b4" class="code"><code class="language-Java">enum Operation implements BiFunction&lt;Double,Double,Double&gt; {
		Plus {
				public Double apply(Double x, Double y) { return x + y; }
				public String toString() { return &quot;+&quot;; }
		},
		Minus {
				public Double apply(Double x, Double y) { return x - y; }
				public String toString() { return &quot;-&quot;; }
		},
		Times {
				public Double apply(Double x, Double y) { return x * y; }
				public String toString() { return &quot;*&quot;; }
		},
		Divide {
				public Double apply(Double x, Double y) {
				if (y == 0) { throw new ArithmeticException(); }
				return x / y;
		}
		
		public String toString() { return &quot;/&quot;; }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="26626275-c62d-4286-a339-6ff27dbfc356" class="code"><code class="language-Java">enum Name {
		//First part (before the &#x27;;&#x27;) is special to enums
		A,//No-args constructor, no override
		B { public void op1() { .. } },//No-args constructor, but override
		C(10),//explicit constructor call, no override
		D(10){ public void op1() { .. } };//explicit constructor call + override
		//This the end of the &#x27;special enum part&#x27;: we used &#x27;;&#x27; instead of &#x27;,&#x27;
		//Second part (after the &#x27;;&#x27;) is just like any abstract class
		FieldType anyFieldDeclaration;
		Name(int parName){..}//Any constructors as usual
		Name(){..}
		public void op1() { .. }//Any method as usual
		//Can also be abstract
}

//enums after the first ; are just abstract classes
//your symbolic constants are just objects that implements that abstract class</code></pre><p id="340a32ac-3aa7-44d2-909c-9ac92f6cfcd7" class="">
</p></details></li></ul><ul id="45454329-d971-47c5-865a-77d638f9e02c" class="toggle"><li><details><summary>Flyweight Pattern</summary><ul id="c1af8d5e-76e8-4061-a968-b8670ec9786d" class="bulleted-list"><li style="list-style-type:disc">Flyweight: difficult pattern but better</li></ul><ul id="670af98b-dfd0-4ab4-9116-bdbb963719fc" class="bulleted-list"><li style="list-style-type:disc">Singleton: easy pattern. But only applicable in a few cases.</li></ul><ul id="c5d288f9-2e88-4835-889a-d830f0153823" class="bulleted-list"><li style="list-style-type:disc">there are many variants of the flyweight pattern, here I show you the simplest and most useful one</li></ul><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="7420a0a5-de60-4af8-adc5-474f3ce741a8"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">if two flyweight objects are structurally equivalent, then they must be the same object<ul id="52a72429-d5ac-4b5b-977d-a7f6eec89fab" class="bulleted-list"><li style="list-style-type:disc">object constructor is slower</li></ul><ul id="db7e4fcf-9bda-43ad-829b-6230880fae75" class="bulleted-list"><li style="list-style-type:disc">memory saving</li></ul><ul id="e39ce1d3-08e5-4868-9a05-aa9897a55400" class="bulleted-list"><li style="list-style-type:disc">fastest equal/hash code methods (because they use pointer equality)</li></ul><ul id="bf3533a9-5014-4109-8675-a84e0423dbf2" class="bulleted-list"><li style="list-style-type:disc">great to use them for other caching/memorization </li></ul></div></figure><h3 id="ae5f0a20-570d-4f12-a4e9-8386a7fb6146" class="">Flyweight Person</h3><p id="fa9e698f-56b5-46a8-8455-b5b076a5df6a" class="">if a person has the same name and same age, they are the same object</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a69e4e62-d3c2-4eeb-887a-d9990f0e957e" class="code"><code class="language-Java">class Person{
		//private key type that stores the name and age state
		private record PersonKey(String name, int age){}
		//unchangable inner that is an instance of the key
		private final PersonKey inner;
		
		//private constructor the class handles to instanciate a person object
		private Person(PersonKey p){
				inner= p;
		}
		
		//getter methods that give you the values from the inner class&#x27;s state
		public String name(){return inner.name;}
		public int age(){return inner.age;}
		public String toString(){ return &quot;Person[&quot;+name()+&quot;,&quot;+age()+&quot;]&quot;; }
		
		//Person.of method for the user to create a person object
		//factory method pattern!!!
		static Person of(String name, int age){
				assert name != null &amp;&amp; !name.isEmpty() &amp;&amp; age &gt;= 0; //invariant
				var key= new PersonKey(name,age); //make key
				//check key in cache and return the cached object or create the new one.
				return cache.computeIfAbsent(key,Person::new); 
		}
		
		//cache to keep track of all currently existing Person objects
		private static final Map&lt;PersonKey,Person&gt; cache= new HashMap&lt;&gt;();
}

//usage
Person p1= Person.of(&quot;Alice&quot;, 30);
Person p2= Person.of(&quot;Alice&quot;, 30);
Person p3= Person.of(&quot;Bob&quot;, 25);
assert p1 == p2; //pointer equality here!
assert p1 != p3;
System.out.println(p1); //Output: Person[Alice, 30]
System.out.println(p2); //Output: Person[Alice, 30]
System.out.println(p3); //Output: Person[Bob, 25] </code></pre><h3 id="b6400eb0-16e0-4cf0-8759-72ac297b32ca" class="">Memoization on large data</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b6560d32-1cc7-4381-832f-73e545fd3bf1" class="code"><code class="language-Java">class Operation{
 public static Result of(MassiveObject o){
		 return cache.computeIfAbsent(o, Operation::_of);
 }
 private static Result _of(MassiveObject o){
		 /*slow time consuming computation here*/
 }
 private static final Map&lt;MassiveObject, Result&gt; cache= new HashMap&lt;&gt;();
}</code></pre><p id="ae9e0329-85dc-4de8-8429-f793d8875db4" class="">Suppose MassiveObject takes 30MBs, and that we have already cached the result for our operation. </p><p id="d438a796-2971-4b5b-be87-59119dd82c04" class="">- If MassiveObject has structural equals/hashCode, it takes a long time just to check if the operation is already cached! </p><p id="89554f68-8c01-472c-98b6-e97af8b7d036" class="">- If MassiveObject is a Flyweight, equals/hashcode are blazing fast, thus it takes a short time to check if the operation is already cached!</p></details></li></ul></details></li></ul><ul id="aec3e8db-a00c-4005-82ce-bd790371582d" class="toggle"><li><details><summary>Observer pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="50d1d17a-82a0-471d-a6af-26dbb87b82fc"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">send messages to objects when an event happens<ul id="fd5a702f-2016-4c4f-843c-6a9bda5e7bfa" class="bulleted-list"><li style="list-style-type:disc">subject object causes the event</li></ul><ul id="45c0bdf6-e0d7-437c-8413-57aca36e46df" class="bulleted-list"><li style="list-style-type:disc">observer object listens and responds to the event</li></ul><ul id="fbc696e9-3dec-4c9f-b36f-52c3c6280136" class="bulleted-list"><li style="list-style-type:disc">we want to loose coupling between subjects and observers because the person writting code for the subject isn’t the same person using the button/subject. so observers can be used for different subjects</li></ul><ul id="f9b7e236-8bc1-4680-8499-08305acd48e1" class="bulleted-list"><li style="list-style-type:disc">to decouple the subject from the observer, we can use a subject and observer interface. <ul id="e7ec769c-5c61-4d09-b59e-70edb7cd2df0" class="bulleted-list"><li style="list-style-type:circle">super types (subject &amp; observer interface) know each other but the subtypes don’t (button implements subject &amp; action listener implements observer )</li></ul></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e9f95a03-37c6-43d2-a817-99b5645d8a18" class="code"><code class="language-Java">interface Observer{ 
	void update();
}

abstract class Subject{
		public Optional&lt;Observer&gt; ob= Optional.empty();
		public void onChange(){ ob.ifPresent( o-&gt; o.update() ); }
		public void attach(Observer o){ ob = Optional.of(o); }
}

class Bob extends Subject{
		int weight= 75;
		void eat(int weight){
				this.weight += weight;
				//we just call abstract method on change and the observer 
				//handles the implementation
				onChange();
		}
 }
</code></pre><figure id="0999ac1e-d742-4a7f-b5d5-58f093ec7d90" class="image"><a href="Untitled%2029.png"><img style="width:862px" src="Untitled%2029.png"/></a></figure></div></figure><h3 id="1d8694c9-1399-4940-a6ac-8fa14d6ea6a0" class="">Even more compact Modern code</h3><p id="186a13a6-fd8d-4f67-83c8-a0d5e4051dc1" class="">instead of making our own observer interface we can use the runnable object with an abstract run method from the standard library </p><p id="8fe96465-53a1-41f4-91d0-928e5548467e" class="">up to you if its better for your case</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c4f926c6-1166-45db-bf20-de3cf66c5d65" class="code"><code class="language-Java">abstract class Subject{
 public Optional&lt;Runnable&gt; ob= Optional.empty();
 public void onChange(){ ob.ifPresent( o-&gt;o.run() ); }
 public void attach(Runnable o){ ob= Optional.of(o); }
}
class Bob extends Subject{
 int weight= 75;
 void eat(int weight){
		 this.weight += weight;
		 onChange();
 }
 
 
//Instead of a dedicated ‘Observer’ interface we could recycle a
//standard functional interface already declared in the standard
//library, like ‘Runnable’ (if we have no event objects)
//or ‘Consumable&lt;Event&gt;’.</code></pre><h3 id="c42e2c6a-d9c3-45e8-9db6-56f8234b2d95" class="">Q2: Adding the right modifiers</h3><p id="807a88b3-50f1-4b8c-8fd4-ea03cc2b894e" class="">we can use final to make sure the state of the subject interface is invisible to its concrete subtype (bob)</p><ul id="fd4fafde-544a-4a29-bce2-b1f4bf28ecbb" class="bulleted-list"><li style="list-style-type:disc">the observer(s) are private to bob, bob can only interact with it through the onChange method</li></ul><ul id="5d7108d0-7f78-441d-bab8-d42cc29216d3" class="bulleted-list"><li style="list-style-type:disc">protected means all the subtypes of the interface/abstract class can see the field/method but anything outside of it cannot<p id="9cdef84d-14f3-44e9-8d64-905f7788052a" class="">although java21 protected is broken, the reader and understand protected as passive documentation that the intent is that only bob can call onChange</p><p id="bb873c04-7ed6-4f98-80cc-3d6aa3433bf5" class="">
</p></li></ul><ul id="0f6ac9ac-1c1d-4298-8845-11eaedce93f0" class="bulleted-list"><li style="list-style-type:disc">attach and detach is final so the subtypes of the subject (bob) cannot override the body of the code</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5bff7459-3380-40cd-a0fb-7ae815cfdf6d" class="code"><code class="language-Java">interface Observer{ void update(); }
abstract class Subject{//Solution
 private Optional&lt;Observer&gt; ob = Optional.empty();
 final protected void onChange(){ ob.ifPresent( o-&gt;o.update() ); }
 final public void attach(Observer o){ ob = Optional.of(o); }
 final public void deattach(){ ob = Optional.empty(); }
}
class Bob extends Subject{ .. }
class Negative0 extends Subject{ public void attach(Observer o){} }
class Negative1 extends Subject{ public void deattach(){} }
class Negative2 extends Subject{ protected void onChange(){} }</code></pre><h3 id="46c254ca-62dd-4490-b07e-cf1938c8b883" class="">Avoid the Optional</h3><p id="363044f9-800b-4bf3-9aaf-1e865caeaabd" class="">instead of using an optional, we can just make the field that stores the observer just be an empty observable (where the run/update method just doesn’t do anything)</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b10fd81c-a9e3-4006-97b3-5ebb4b25a4a9" class="code"><code class="language-Java">abstract class Subject{
	 private Runnable ob = ()-&gt;{};
	 final protected void onChange(){ ob.run(); }
	 final public void attach(Observer o){ ob = o; }
	 final public void deattach(){ ob = ()-&gt;{}; }
}
class Bob extends Subject{ .. }</code></pre><h3 id="560036ae-17e9-4bd8-9fb4-a148c9b5ce58" class="">Q3: List of observers, the fragile solution</h3><p id="af236005-c65e-45ae-9add-c9dcb7811474" class="">a naive way to make a subject have multiple observers is to make the ob field store a list of observers instead of a single optional of observers</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a12d17a8-0abe-419c-991e-b128a2bb6f7d" class="code"><code class="language-Java">interface Observer{ void update(); }
abstract class Subject{
 private List&lt;Observer&gt; ob= new ArrayList&lt;&gt;();//Fragile solution
 final protected void onChange(){ ob.forEach( o-&gt;o.update() ); }
 final public void attach(Observer o){ ob.add(o); }
 final public void deattachAll(){ ob.clear(); }
}
class Bob extends Subject{..}
..
Bob bob= new Bob();
int[] tot1= {0};
int[] tot2= {0};
bob.eat(1);
bob.attach( ()-&gt; tot1[0] += 1 );
assert tot1[0] == 0 : &quot;Is this possible?&quot;;
bob.eat(1);
assert tot1[0] == 1 : &quot;first action&quot;;
bob.attach( ()-&gt; tot2[0] += 1 );//what if this operation was more involved?
...</code></pre><h3 id="f9bca06d-6f03-43f1-8e1d-c2e4e24ac811" class="">Q4: List of observers, the better solution</h3><p id="d1a355b3-dc76-4174-b9a3-315ad4322972" class="">the issue with using an array list is that if there is a change to the arraylist while iterating through it, it throws a ConcurrentModifcationException</p><p id="680d28f9-574d-44ab-8d28-07e9ed0709c9" class="">a case where this can happen is when you call attach inside of attach and then actually attach an observer</p><p id="05f88774-ddc4-4383-b9f4-8b0eb65864c0" class="">to prevent ConcurrentModifcationException, we can use List.of so that the list is immutable and to increase the number of observers you have to create a new list concatenated with the new observer(s)</p><p id="f0713b3b-b0fc-41d7-b51f-4de515e16b70" class="">this means when you call attach inside of attach, it only notifies the observers that were already present inside the subject before we added a new observer in the same body, so the new observer will not be notified </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="01f9b596-3a1e-457b-a8c4-9a38cc28d8c3" class="code"><code class="language-Java">interface Observer{ void update(); }
abstract class Subject{
 private List&lt;Observer&gt; ob= List.of(); //unmodifiable lists
 final protected void onChange(){ ob.forEach( o-&gt;o.update() ); }
 final public void attach(Observer o){ //replace on update
 ob = Stream.concat(ob.stream(),Stream.of(o)).toList();
 }
 final public void deattachAll(){ ob = List.of(); }
}
class Bob extends Subject{..}
..
Bob bob= new Bob();
int[] tot1= {0};
int[] tot2= {0};
bob.eat(1);
bob.attach( ()-&gt;tot1[0] += 1 );
bob.eat(1);
assert tot1[0] == 1 : &quot;first action&quot;;
bob.attach( ()-&gt;{ bob.attach(()-&gt;{}); tot2[0] += 1; } );//change here!
bob.eat(2); bob.eat(5);
//What happens now? On action, we add a new action to the list!
//If we do it by mutating an ArrayList under iteration, we get
//&#x27;ConcurrentModificationException&#x27;</code></pre><h3 id="0af9225b-6fcb-483d-87c6-b14f1998f784" class="">Or... just avoid lists!</h3><p id="6e82b09d-8355-4cd5-8a91-ca52c5f1bfc1" class="">instead of a list we can store ob as a single anonymous inner class that <em>‘recursively’</em> calls the run methods of all observers</p><p id="5486984c-3867-4f33-bb85-112b95ef5627" class="">when we want to add a new observer then we create a new object that calls the new observer ‘s run method and the old observer’s run method in its own run method</p><p id="6bcb31cc-e3f8-4287-af23-e013afa63312" class="">the old observer and newly added observer are not stored as fields but still exist in memory, the only reason they are not garbage collected is because there is a reference to them in the anonymous inner class stored as ob. this especially creates a linked list where the head is stored at ob, and the following observers are in memory with the only reference to them being inside the run method of the previous observer in the linked list</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a2c30672-b528-4132-b3cf-bcf588af833a" class="code"><code class="language-Java">abstract class Subject{
 private Runnable ob= ()-&gt;{};
 final protected void onChange(){ ob.run(); }
 final public void attach(Runnable o){
	 var oldObs= ob;
	 ob = ()-&gt;{ o.run(); oldObs.run(); };
 }
 final public void deattachAll(){ ob = ()-&gt;{}; }
}

//New Runnable calls both the new user provided Runnable and the
//old one.
//● Chain of behavior
//- Is this recursion?
// - Slow on very, very long chains of observers
// - Faster on short chains of observers! </code></pre><h3 id="52e9f717-d599-4e65-96fa-26c6ffe663db" class="">Q5: Everything is better with generics</h3><p id="49790a54-f74f-4efb-a059-2e963e75db29" class="">observer can be of type S and M, where S is the subject and M is the message/event</p><p id="ff94dc94-5b6f-4fe2-aada-6d5380d57eaf" class="">Subject is also of type S and M, S being a type that refers to itself</p><p id="ff4c4f0c-8082-4d52-b6be-f7939a3e0a5c" class="">this means that subjects need to have a method self that just returns itself/this to convenes the type system</p><p id="a8e20ea3-e0b7-4fc9-aa16-6305f1e9c0e3" class="">onChange will call update(self(),m) instead of update(this),m) because this is of type Subject, but we want an S instead. even if Subject is an S, the type system doesn’t know it so the self method makes sure that this  is of type S</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="14fa3ef4-66d3-4c11-9a83-175100c9ccd5" class="code"><code class="language-Java">//S=Subject, M=Message
interface Observer&lt;S,M&gt;{ void update(S s, M m); }

abstract class Subject&lt;S,M&gt;{ //SOLUTION!
 private Observer&lt;S,M&gt; ob= (s,m)-&gt;{};
 protected abstract S self();
 final protected void onChange(M m){ ob.update(self(),m); }
 final public void attach(Observer&lt;S,M&gt; o){ ob = o; }
}

class Bob extends Subject&lt;Bob,Integer&gt;{
 int weight= 75;
 protected Bob self(){ return this; }
 void eat(int weight){
		 int oldW= this.weight;
		 this.weight += weight;
		 onChange(oldW);
 }
}
...//Now the code of the lambda can use Integer w0 and Bob p
bob.attach( (p,w0)-&gt;dietLog.add( &quot;From &quot; + w0 + &quot; to &quot; + p.weight ) );</code></pre><h3 id="3c242123-8c8c-4e56-b069-2c9b6e689350" class="">Take aways</h3><figure id="df35b6cd-f3b1-4bab-96d7-c274033b507f" class="image"><a href="Untitled%2030.png"><img style="width:905px" src="Untitled%2030.png"/></a></figure><figure id="0d517868-852a-4053-887a-2454276278fd" class="image"><a href="Untitled%2031.png"><img style="width:767px" src="Untitled%2031.png"/></a></figure><figure id="9c2fa7fd-d5cf-4c46-b260-881456a04dc9" class="image"><a href="Untitled%2032.png"><img style="width:680px" src="Untitled%2032.png"/></a></figure></details></li></ul><ul id="4c981fb9-1c96-4c02-85cb-7c8713da1a69" class="toggle"><li><details><summary>Swing</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f151ac6e-7dfc-46cb-bdb1-0e0b1efa6bd0"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">GUI library apart of the standard library<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3b738dd3-2eda-4c11-b63d-02141fbcc576" class="code"><code class="language-Java">public class Main{

		public static void main(String[] args) {
				SwingUtilities.invokeLater(Main::new); //do computation in rendering thread
		}
		
		//the most important components as fields, others can be local variables
		JFrame frame= new JFrame(&quot;Observer Pattern Example&quot;);
		JButton button= new JButton(&quot;Click Me&quot;);//Subject
		
		private Main(){
				frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); //make x button work
				//enables the X button :-/
				frame.setSize(300, 100); //set size of the window
				button.addActionListener(e-&gt;System.out.println(&quot;Hi!&quot;)); //add observer
				frame.add(button);
				//adds the button to the JPanel inside the JFrame
				frame.setVisible(true); //start rendering
				//not a field setter. This is the call that starts the whole GUI!!
				//This method &#x27;setVisible&#x27; has a TERRIBLE NAME.
		}
		
}

//Observer Pattern:
	 //Subject/Observable: JButton
 	 //It generates action events (button clicks)
 	 //and notifies its observers.
 	 //Observer: The lambda expression e -&gt;.. is the observer:
 	 //reacts to the (observed) events (lambdas are objects).
//Composite Pattern:
 	 //Component: JComponent
 	 //Composite: JPanel (contained inside JFrame)
 	 //Leaf: JButton
//Note how in both cases the usage of the patterns is quite &#x27;implicit&#x27;</code></pre><ul id="05824f74-c368-4575-89f4-6b20bd921b4d" class="bulleted-list"><li style="list-style-type:disc">large library like reflections</li></ul><ul id="66a3f685-49c6-4a38-981b-033426d390af" class="bulleted-list"><li style="list-style-type:disc">uses a lot of composites + observers</li></ul><ul id="3be6e987-2e75-4262-8bfc-84c3c32c833a" class="bulleted-list"><li style="list-style-type:disc">we will learn swing because javaFX was a mistake, oracle tried to push it but ended up removing it from the JDK. its problems involve being much harder to use and worse multithreading </li></ul><ul id="593ee54d-dde5-4bf3-8320-a8cf7fa18bbf" class="bulleted-list"><li style="list-style-type:disc">JFrame: top level wrapper</li></ul><ul id="5bad530d-2e66-4d44-8ef1-e4c090163c5a" class="bulleted-list"><li style="list-style-type:disc">JPanel: the protagonist </li></ul><ul id="22059772-df59-4f7b-82fa-7c6a3c9b1061" class="bulleted-list"><li style="list-style-type:disc">Jcomponent: the component interface of the composite pattern (rarely used directly)</li></ul><ul id="554892e6-576b-4681-89a0-f0b3960683a5" class="bulleted-list"><li style="list-style-type:disc">JButton, JTextArea ect: leaves of the composite pattern</li></ul></div></figure><ul id="3ad7f250-0de3-42a6-b407-51e95e29239f" class="toggle"><li><details><summary>A larger Swing example</summary><p id="6113d339-8973-4fa7-8469-04f5bc6c2fd7" class="">This is a more interesting Swing example, showing some common usage pattern for swing.</p><figure id="261bd478-cceb-4b00-8068-70438672e5cf" class="image"><a href="Untitled%2033.png"><img style="width:680px" src="Untitled%2033.png"/></a></figure><h3 id="c4d2aabd-f601-43f8-ae8f-f094913b0edc" class="">imports</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="33510ea6-b8f6-405c-809a-b72e903e2ed3" class="code"><code class="language-Java">//A few imports...
package guiExample;
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.GridLayout;
import java.awt.Image;
import java.awt.event.ComponentAdapter;
import java.awt.event.ComponentEvent;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.io.UncheckedIOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.List;
import java.util.function.Consumer;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import java.util.stream.Stream;
import java.util.stream.StreamSupport;
import javax.imageio.ImageIO;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;</code></pre><h3 id="2a369647-da27-4b2c-87a4-c348f7faf5c8" class="">main method</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="00a8a6d0-edf2-4272-becd-c53802ad019a" class="code"><code class="language-Java">//Our main type.
public class Gui{
		public static void main(String[] args) {
				SwingUtilities.invokeLater(Gui::new);//as before
		}
		
		JFrame frame = new JFrame(&quot;A larger Gui&quot;);
		
		&lt;T extends JComponent&gt; T put(T t, Object how){
				frame.add(t,how);//useful to add our own &#x27;put&#x27; methods since the
				return t; //we often need to do some custom stuff while adding
		}
		//We define fields for each &#x27;important&#x27; subcomponent
		//We use our &#x27;put&#x27; to initialize our fields.
		//We use BorderLayout.XXX to specify where to put the widget
		//Important: Banner, MainArea, NumPad and Footer are our own classes!!!
		//Using Swing == defining your own widgets
		

		//custom types, gives user understandable names 
		//to all the visable components in the GUI
		Banner banner = put(new Banner(), BorderLayout.NORTH);
		MainArea mainArea = put(new MainArea(), BorderLayout.CENTER);
		NumPad numPad = put(new NumPad(), BorderLayout.EAST);
		Footer footer = put(new Footer(), BorderLayout.SOUTH);
		Action action = new Action();
		
		private Gui() {
				frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); //make x button work
				frame.setSize(500, 300); //define the size of the window
				frame.setVisible(true); //start rendering 
				assert numPad.buttons.size() == action.actions.size();
				IntStream.range(0, numPad.buttons.size())
				.forEach(i-&gt;numPad.buttons.get(i)
				.addActionListener(e-&gt;action.actions.get(i).accept(mainArea)));
		}
}</code></pre><h3 id="5f0a89a6-663a-4c3e-87d0-609fc65b31a3" class="">put method</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4f736807-cd31-4a75-8da5-89e182f3a722" class="code"><code class="language-Java">&lt;T extends JComponent&gt; T put(T t, Object how){
frame.add(t,how);//useful to add our own &#x27;put&#x27; methods since the
return t; //we often need to do some custom stuff while adding
}
//We define fields for each &#x27;important&#x27; subcomponent
//We use our &#x27;put&#x27; to initialize our fields.
//We use BorderLayout.XXX to specify where to put the widget
//Important: Banner, MainArea, NumPad and Footer are our own classes!!!
//Using Swing == defining your own widgets

//custom types, gives user understandable names 
//to all the visable components in the GUI
Banner banner = put(new Banner(), BorderLayout.NORTH);
MainArea mainArea = put(new MainArea(), BorderLayout.CENTER);
NumPad numPad = put(new NumPad(), BorderLayout.EAST);
Footer footer = put(new Footer(), BorderLayout.SOUTH);</code></pre><h3 id="a7bb642b-34bc-4a8d-afc8-acc315696519" class="">How to make our custom widgets</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="98f7ea16-6ae4-47bc-9bd9-1f316fac4f15" class="code"><code class="language-Java">Extend the appropriate JXXX widget.
- You are defining a Composite: extend JPanel / JScollPane
- You are defining a Leaf: extend the appropriate Leaf

@SuppressWarnings(&quot;serial&quot;)
class Footer extends JPanel{
 Footer(){ super(new FlowLayout(FlowLayout.CENTER, 10, 5)); }
 JButton start= put(new JButton(&quot;Start&quot;));
 JButton pause= put(new JButton(&quot;Pause&quot;));
 JButton stop= put(new JButton(&quot;Stop&quot;));
 &lt;T extends JComponent&gt; T put(T t){ add(t); return t; }
}
@SuppressWarnings(&quot;serial&quot;)
class MainArea extends JScrollPane{
	 final JTextArea textArea= new JTextArea();
	 MainArea(){ setViewportView(textArea); }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="47e96354-adc8-424d-87d2-f1ba72f83727" class="code"><code class="language-Java">@SuppressWarnings(&quot;serial&quot;)
class NumPad extends JPanel{
 List&lt;JButton&gt; buttons= new ArrayList&lt;&gt;();
 NumPad(){
		 super(new GridLayout(4, 3, 5, 5));
		 IntStream.range(1, 13).forEach(this::put);
 }
 void put(int i) {
		 var b= new JButton(&quot;[&quot;+i+&quot;]&quot;);
		 this.buttons.add(b);
		 this.add(b);
 }
}</code></pre><p id="0d11b0fc-9b47-420c-8d24-f3ed55fbcd37" class="">GridLayout: a way to put elements in a grid<br/>FlowLayout: a way to put elements one after another<br/>-Note how our custom &#x27;put&#x27; methods are helping us every time!<br/>By defining our own Widgets it is natural to divide our GUI in many files with good names<br/>This approach is maintainable.<br/>We could just use a normal JPanel directly in the main class, but it would result in<br/>convoluted and hard to maintain code.<br/></p><p id="5c62ece6-81fb-42ec-98d5-178b81478760" class="">Should &#x27;buttons&#x27; be a private final field<br/>with a getter returning Collections.unmodifiableList(..)?<br/>Difficult question.<br/>As you can see NumPad (and our other custom widgets) are not public classes.<br/>Thus, they are package private. This means that they use is limited to the current package<br/>anyway. Depending on your specific constraints, this may be enough encapsulation.<br/>We will see more of this when we discuss the Model View Controller.<br/></p><h3 id="e4ddf016-e055-4896-9462-b1f490e50fc3" class="">Doing the image banner at the top was actually the harder part of all !!</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="33c42b7b-4aae-4ba8-9c84-6dfc4c0cf638" class="code"><code class="language-Java">@SuppressWarnings(&quot;serial&quot;)
class Banner extends JLabel{
 final BufferedImage img= Img.Dance.image; //We will see `Img.Dance` later
 final double aspectRatio= (double) img.getWidth() / img.getHeight();
 private class MyComponentAdapter extends ComponentAdapter{
 @Override public void componentResized(ComponentEvent e){
 int w= getParent().getWidth();
 int h= (int) (w / aspectRatio);
 setPreferredSize(new Dimension(w,h));
 }
 }
 Banner(){ addComponentListener(new MyComponentAdapter()); }
 @Override protected void paintComponent(Graphics g){
 super.paintComponent(g);
 Image scaledImage= img
 .getScaledInstance(getWidth(),getHeight(), Image.SCALE_SMOOTH);
 g.drawImage(scaledImage, 0, 0, this);
 }
}</code></pre><figure id="2f2b5328-948e-4196-be8c-e980a4ebb478" class="image"><a href="Untitled%2034.png"><img style="width:652.04541015625px" src="Untitled%2034.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="16307366-9371-49a6-b2af-e30ee5d10b09" class="code"><code class="language-Java">final double aspectRatio= (double) img.getWidth() / img.getHeight();
 private class MyComponentAdapter extends ComponentAdapter{
 @Override public void componentResized(ComponentEvent e){
 int w= getParent().getWidth();
 int h= (int) (w / aspectRatio);
 setPreferredSize(new Dimension(w,h));
 }
 }
 Banner(){ addComponentListener(new MyComponentAdapter()); }

Injecting custom code in componentResized:

Need to respond to &#x27;addComponentListener&#x27;
&#x27;ComponentAdapter&#x27; is an old class so we can not use lambdas to
satisfy it :-/ We lose 4 or 5 full lines because of this.
Solution: define a mini inner class &#x27;MyComponentAdapter&#x27; and implement the needed method.

 * Our width should always be the width of our parent
 (the top level JPanel in the JFrame).

 * Out height should respect the aspect ration of the image</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="79cfe3ba-1508-4781-927e-8829185cc8a4" class="code"><code class="language-Java">@Override protected void paintComponent(Graphics g){
 super.paintComponent(g);
 Image scaledImage = img
 .getScaledInstance(getWidth(),getHeight(), Image.SCALE_SMOOTH);
 g.drawImage(scaledImage, 0, 0, this);
 }

Injecting custom code in repaint:

This is much easier, overriding `paintComponent` and calling `super`
is all the &#x27;protocol we need.
Then, we just scale the image to fit it our exact size.
Was there an easier way to do this? if you know, write Marco!</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="44d85fcd-9acf-4be5-ad25-c997403e28b3" class="code"><code class="language-Java">@SuppressWarnings(&quot;serial&quot;)
class Banner extends JLabel{
 final BufferedImage img= Img.Dance.image; //We will see `Img.Dance` later
 final double aspectRatio= (double) img.getWidth() / img.getHeight();
 private class MyComponentAdapter extends ComponentAdapter{
 @Override public void componentResized(ComponentEvent e){
 int w= getParent().getWidth();
 int h= (int) (w / aspectRatio);
 setPreferredSize(new Dimension(w,h));
 }
 }
 Banner(){ addComponentListener(new MyComponentAdapter()); }
 @Override protected void paintComponent(Graphics g){
 super.paintComponent(g);
 Image scaledImage= img
 .getScaledInstance(getWidth(),getHeight(), Image.SCALE_SMOOTH);
 g.drawImage(scaledImage, 0, 0, this);
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f5022148-4ed5-4c7f-be50-4741c619d2ee" class="code"><code class="language-Java">
Use an enumeration for your images!
I tried many, many different ways.
This is the easiest and the most resilient.
 - Focus all the &#x27;file reading logic&#x27; in a single place
- Concentrate all possible errors at (class) loading time.
- Make some code helping to locate error in class file positions

enum Img{
 Dance;
 public final BufferedImage image;
 static Path startPath(){//adjust it with what you need
 return Paths.get(System.getProperty(&quot;user.dir&quot;),&quot;name&quot;,&quot;subName&quot;);
 }
 Img(){ image= loadImage(this.name()); }
 static private BufferedImage loadImage(String name){
 Path p= startPath().resolve(Path.of(name+&quot;.png&quot;));
 assert Files.exists(p):&quot;Name &quot;+name+&quot; not found. Visible files are \n&quot;
 +DirectoryStructure.of(startPath());
 try{ return ImageIO.read(p.toFile()); }
 catch(IOException e){ throw new UncheckedIOException(e); }
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d8641334-064b-47e1-a3d5-3f7530dcf684" class="code"><code class="language-Java">class DirectoryStructure{
 public static String of(Path startPath){
 try (Stream&lt;Path&gt; paths= Files.walk(startPath)){
 return paths
 .filter(pi-&gt;!pi.equals(startPath))
 .map(pi-&gt;startPath.relativize(pi))
 .mapMulti(DirectoryStructure::single)
 .collect(Collectors.joining());
 }
 catch(IOException ioe){ throw new UncheckedIOException(ioe); }
 }
 private static void single(Path rel, Consumer&lt;String&gt; c){
 int depth= rel.getNameCount() - 1;
 assert depth &gt;= 0;
 c.accept(&quot;--|&quot;.repeat(depth));
 c.accept(rel.getFileName().toString());
 c.accept(&quot; //Path.of(\&quot;&quot;);
 c.accept(formatPath(rel));
 c.accept(&quot;\&quot;)\n&quot;);
 }
 private static String formatPath(Path rel){
 return StreamSupport.stream(rel.spliterator(), false)
 .map(Path::toString)
 .collect(Collectors.joining(&quot;\&quot;, \&quot;&quot;, &quot;&quot;, &quot;&quot;));
 
 Just import this code and use it
whenever you need!
The alternative is to spend many
hours confused. And then again
when you export your app to a Jar</code></pre><p id="584c7f2f-c224-4444-85bf-36fe0b372622" class="">
</p></details></li></ul><p id="0c24ce1f-a3b0-4974-99e0-a87ba058ec1c" class="">
</p></details></li></ul><ul id="73f8c630-2ea2-481c-85d3-82ea527a0fa4" class="toggle"><li><details><summary>Strategy Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="56362ba9-8e17-4a97-afa3-26bbdce0632a"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">top level context object stores a strategy object which defines behavior for a single method <ul id="79d752d8-3148-43af-9219-4fa500c13172" class="bulleted-list"><li style="list-style-type:disc">one of the most direct implementation of dynamic dispatch</li></ul><figure id="81b315c0-0ef1-47e1-b7e5-970d700064fe" class="image"><a href="Untitled%2035.png"><img style="width:590px" src="Untitled%2035.png"/></a></figure></div></figure><ul id="2d525d16-855d-4bcd-bbaf-360894e2d0db" class="bulleted-list"><li style="list-style-type:disc">used when many related classes differ only by their behavior OR need custom behavior for individual instances OR have complex behavior implemented through many conditional statements</li></ul><ul id="b7a17b4f-c1cc-4210-b198-268635dc06e1" class="bulleted-list"><li style="list-style-type:disc">strategy pattern solves this by defining an interface abstracting algorithm (behavior) where each algorithm variant is encapsulated into a separate class/record/lambda implementing the algorithm interface. context class (original one) calls strategy object to perform algorithm</li></ul><ul id="470ccb63-92ec-4929-af1a-34275a6632ed" class="toggle"><li><details><summary>Robotic Arm Example</summary><ul id="89ba6a64-07a9-4b88-87bd-32d782490c6a" class="bulleted-list"><li style="list-style-type:disc">we can avoid explicit conditionals (if) with dynamic dispatch</li></ul><ul id="6b3e1eb1-20d5-42ee-ac11-4d4430ef3f29" class="bulleted-list"><li style="list-style-type:disc">one of the pattern that uses dynamic dispatch at its core is the Strategy Pattern</li></ul><ul id="4e756104-4198-496b-b568-febb9ab8b2c1" class="bulleted-list"><li style="list-style-type:disc">we want library to be extendable, where behaviour in certain circumstances is extended by the user </li></ul><h3 id="369ccc34-5d21-4976-8013-3da29fc288e1" class="">Robotic arm</h3><p id="66dbae4c-d02b-4535-9463-512adf91cbba" class="">for example, we have a robotic arm that can holds an object and move it around</p><ul id="dc314c57-3f30-4155-ba4d-03589d5c42d1" class="bulleted-list"><li style="list-style-type:disc">the low level api/drivers to control to the arm is complex and take alot of code</li></ul><ul id="831d2708-7b1c-439d-83d1-4bce4f9dc1f4" class="bulleted-list"><li style="list-style-type:disc">the library is made to handle these apis</li></ul><ul id="1c1eaf65-9a8a-4200-a08f-291aebcd4914" class="bulleted-list"><li style="list-style-type:disc">the library executes suggestions from the user for the specific implementation based on certain cases</li></ul><figure id="3ef4b7cf-e6be-4d70-bfe2-0080472c7f73" class="image"><a href="Untitled%2036.png"><img style="width:1007px" src="Untitled%2036.png"/></a></figure><figure id="a36fe11d-dc43-4766-86cc-f7db259478d0" class="image"><a href="Untitled%2037.png"><img style="width:990px" src="Untitled%2037.png"/></a></figure><figure id="c0c42e20-f7c7-4277-8653-2e459e7695d3" class="image"><a href="Untitled%2038.png"><img style="width:797px" src="Untitled%2038.png"/></a></figure><h3 id="dab24685-ee23-428d-b27e-d40c39f52b79" class="">BAD Implementation #1</h3><ul id="ae594b48-634e-4e19-8624-831d52934541" class="bulleted-list"><li style="list-style-type:disc">hard coding logic using ifs</li></ul><ul id="3b9f60cc-ae88-4da4-997d-dfcbc1439014" class="bulleted-list"><li style="list-style-type:disc">implement the logic yourself</li></ul><ul id="49a832f4-e7e5-4a33-87db-47814a247d9e" class="bulleted-list"><li style="list-style-type:disc">using the object itself</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a836d511-6ede-4f76-bbc5-1ab5a4601a6a" class="code"><code class="language-Java">class RoboArm {...
 int action(Kind k, Position p, Vector v, int impactTime){
 if (k.isHard()){
 if (impactTime &gt; 1000){ arm.relaxToward(p,v); }
 else if (impactTime &gt; 2){ palm.face(p,v); }
 else { fingers.close(Strength.MAX); }
 }
 if(k.isBullet()){ arm.evade(p,v); }
 if(k.isFragile()){...}
 }
}

Logic implementation in single method
	– Inflexible, since logic is hard-coded into the library
	– Often ends up as spaghetti code.</code></pre><h3 id="afbb9cf2-6a01-4e1d-bedb-6a4c20c1608b" class="">BAD Implementation #2</h3><figure id="d5a46ba0-e006-45a1-a026-ccf1a6cf4ac8" class="image"><a href="Untitled%2039.png"><img style="width:624px" src="Untitled%2039.png"/></a></figure><h3 id="f2a6ab17-9fe2-4cb1-9a70-69e91a71e850" class="">Solution: use the strategy pattern!</h3><p id="c2184f62-7dd8-4735-98ab-cb39ed0bdf3f" class="">
</p></details></li></ul><ul id="1aaceb03-af6f-4a0f-966a-fc3e1ef9361b" class="toggle"><li><details><summary>Robot Implementation #3</summary><figure id="4034b7ad-5966-4e84-93cb-8b87f0b7f209" class="image"><a href="Untitled%2040.png"><img style="width:624px" src="Untitled%2040.png"/></a></figure><p id="7eee20ab-2815-433e-9c2b-cc85b0aee6be" class="">overview:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa9d676c-88e2-468e-a9f8-1efaa544be87" class="code"><code class="language-Java">class RoboArm{...//Library code
 GraspingPolicy policy;
	//note how the RoboArm object passes itself (as this) into the method
		//doing so allows the policy interface to interact with and know about
		//the caller 
 void action(...){ policy.action(this,...); }
}

interface GraspingPolicy{//Library code
	//Social interaction between objects, no behavior!
	
	//there are 2 phases to coding with this style:
		//make the social interaction between objects by defining a method with 
			//related objects as the parameters
		//then we can implement the body of the codel later
	
 void action(RoboArm robot, Kind k, Position p, Vector v, int impactTime);
} //first parameter: outer ‘this’</code></pre><p id="9e296e31-f3d6-4bd3-b17c-156d2d55605f" class="">client code:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5803465b-3c3e-4e8c-8bac-dcba84a0f7e6" class="code"><code class="language-Java">class GraspStrongly implements GraspingPolicy{...//Client code
	 public void action(RoboArm robot, Kind k, Position p, Vector v, int time){
			 if (time &gt; 1000){ robot.arm.relaxToward(p,v); return; }
			 if (time &gt; 2){ robot.palm.face(p,v); return; }
	 robot.fingers.close(Strength.Max);
	 }
}
class Dodge implements GraspingPolicy{...//Client code
	 public void action(RoboArm robot, Kind k, Position p, Vector v, int time){
			 ...
	 }
}
//more cases</code></pre><p id="d076b4c1-ad65-4318-9cc9-76826bd4c5b3" class="">we can just use a lambda instead of defining a class that implements graspingpolcity and store it as a local variable:</p><ul id="10d8f764-fa77-4461-9711-bcce7c9a3ca5" class="bulleted-list"><li style="list-style-type:disc">difference is that using a lambda makes access to the concrete object be local, while the class can be accessed globally </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6b702979-c5b0-42bd-accf-b7b5d882af5f" class="code"><code class="language-Java">//----Client code
GraspingPolicy graspStrongly= (robot, k, p, v, time)-&gt;{
		if (time &gt; 1000){ robot.arm.relaxToward(p,v); return; }
		if (time &gt; 2){ robot.palm.face(p,v); return; }
		robot.fingers.close(Strength.Max);
};

GraspingPolicy dodge= (robot, k, p, v, time)-&gt;{
		...
};</code></pre></details></li></ul><ul id="822c4b41-9bbb-44e3-bf70-32b11be76bc1" class="toggle"><li><details><summary>Layout Managers in swing is a Strategy Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="12a6498b-54c6-4f09-856d-aa9c763650e9"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">layout manager in swing doesn’t just randomly add components where ever, instead they add components to the container following a certain strategy. the strategy used is determined by the Strategy Pattern<ul id="c90fbf05-8cc7-4399-a5bf-4987432ad2b8" class="bulleted-list"><li style="list-style-type:disc">this allows us to write our own layout by implementing layout</li></ul><ul id="920ddf30-46ae-4a52-b920-1080bbd5c136" class="bulleted-list"><li style="list-style-type:disc">we can even extend any existing layout to modify it further</li></ul></div></figure><h3 id="2327f24b-6be9-414c-bd9b-9eae80dd9059" class="">Layout manager determines how to place widgets</h3><p id="ced68a23-7101-4af2-bf7c-ae7b48e06f61" class=""> Several standard layout managers:</p><figure id="a9bd372e-3ca6-4770-bf6c-db5d5aadaf0e" class="image"><a href="Untitled%2041.png"><img style="width:624px" src="Untitled%2041.png"/></a></figure><h3 id="512a7678-fd87-49b1-8e74-939326ed9e96" class="">Example – Border Layout</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bf2818c0-777e-4a89-a517-2f6a3706abb9" class="code"><code class="language-Java">JFrame f= new JFrame();
BorderLayout l= new BorderLayout();
f.setLayout(l);
f.add(new JButton(&quot;Button 1&quot;),BorderLayout.NORTH);
f.add(new JButton(&quot;Button 2&quot;),BorderLayout.SOUTH);
f.add(new JButton(&quot;Button 3&quot;),BorderLayout.EAST);
f.pack();
f.setVisible(true);</code></pre><figure id="84255b3b-6733-4047-a943-395b7a810fde" class="image"><a href="Untitled%2042.png"><img style="width:328px" src="Untitled%2042.png"/></a></figure><h3 id="0b68bd01-62fa-487f-94b9-e1efec058990" class="">Example – Flow Layout</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6b9bd16d-a1e7-4dce-9e05-b559398536ea" class="code"><code class="language-Java">JFrame f= new JFrame();
FlowLayout l= new FlowLayout();
f.setLayout(l);
f.add(new JButton(&quot;Button 1&quot;));
f.add(new JButton(&quot;Button 2&quot;));
f.add(new JButton(&quot;Button 3&quot;));
f.pack();
f.setVisible(true);</code></pre><figure id="199d7a3d-c958-4156-b30b-95cfecd1960b" class="image"><a href="Untitled%2043.png"><img style="width:339px" src="Untitled%2043.png"/></a></figure></details></li></ul><ul id="d3be2b78-2356-4bd8-9795-3d9de9aa4c02" class="toggle"><li><details><summary>Consequences</summary><ul id="99a3386c-cd98-4dd9-b0c2-8e8d1016dc0e" class="bulleted-list"><li style="list-style-type:disc">Eliminates large conditionals</li></ul><ul id="ba68bbfd-8570-40f9-9012-ac2896271347" class="bulleted-list"><li style="list-style-type:disc">Provides (dynamic) choice of implementation</li></ul><ul id="5999b4cd-59ca-40a5-8e51-105c280c2621" class="bulleted-list"><li style="list-style-type:disc">Allows easy addition of more implementations</li></ul><ul id="e4981210-6c24-4f95-8aa1-74c300eeded4" class="bulleted-list"><li style="list-style-type:disc">Increases number of classes and objects</li></ul><ul id="e1707227-2290-4b5a-bad8-0ab0232e1a61" class="bulleted-list"><li style="list-style-type:disc">Binds implementations to specific interface</li></ul><ul id="220087b7-fa30-47d9-9173-88e8a9c34bf9" class="bulleted-list"><li style="list-style-type:disc">Should Context must be aware of the different strategies?</li></ul><ul id="0eaa1b26-f11f-4d0f-8b4e-f631d560d858" class="bulleted-list"><li style="list-style-type:disc">Many different kinds of strategies can be used by the same context class</li></ul></details></li></ul><ul id="4a63ccca-5834-4a47-a91d-e9d84e7c5951" class="toggle"><li><details><summary>Method based strategy</summary><h3 id="769a6f31-12e1-4fc0-82dd-a8a7080cca72" class="">instance based</h3><p id="c03e5b65-0109-4fb0-a4bc-cdadca903e0f" class="">the strategy object is a field (what we’ve seen so far before)</p><h3 id="1d9fa68f-5884-43fe-869c-8443cdd4142a" class="">method based</h3><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="98b4d2ba-fa00-4c87-aea8-9de31b446966"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">the strategy object is a parameter</div></figure><ul id="f81033ae-b197-47f0-9ae2-c363171c2a4d" class="bulleted-list"><li style="list-style-type:disc">now very popular </li></ul><ul id="2995a00f-5fbe-44b9-b881-55f8e4de3ba6" class="bulleted-list"><li style="list-style-type:disc">often used to avoid relying on equals method</li></ul><ul id="e2018aa7-b6e8-4172-bf91-92f3f5cab3eb" class="bulleted-list"><li style="list-style-type:disc">java equals is a provides a global way to apply equality between any two objects</li></ul><ul id="9b7ddeec-e1aa-4796-9759-f4326ece2d45" class="bulleted-list"><li style="list-style-type:disc">equals often depending on the operation or objective at hand, different kinds of equality are needed.<ul id="ff0b9085-ae14-49b0-aa90-aaac8fddd2ea" class="bulleted-list"><li style="list-style-type:circle">structural equality</li></ul><ul id="27e9086d-9cc6-4389-a0aa-92fa4e03aa85" class="bulleted-list"><li style="list-style-type:circle">identity equality</li></ul><ul id="f8515670-d4f9-4e55-9a5a-c49d950f6ff7" class="bulleted-list"><li style="list-style-type:circle">equality of just some fields (the id field for example)</li></ul><ul id="c9339b1d-d1f0-4bd4-aa19-26b6f01cbbbc" class="bulleted-list"><li style="list-style-type:circle">normalized equality (for example equals ignoring case for strings)</li></ul></li></ul><ul id="bd5ec1b5-916b-4159-8a17-38d71f35070a" class="bulleted-list"><li style="list-style-type:disc">we can use the method based strategy pattern to give a specific implementation of equality as a predicate strategy object for a specific problem</li></ul><h3 id="46e1934c-b588-4e8c-a965-d906862a112d" class="">removeIf example</h3><p id="b74592c0-22d6-4530-85dc-f74ca423124d" class=""><code>myList.removeIf(x -&gt; x &gt; 5) </code></p><p id="51533747-514d-4e6a-84ea-3b3eaf6c5ab2" class="">Here the lambda &#x27;x -&gt; x &gt; 5&#x27; is the strategy object, and tells the method when to remove an element while iterating over the list.</p><p id="0c00868d-7abe-41dd-b7bf-e44bcbcec1de" class="">the predicate tells you when to remove the object, that predicate is a strategy </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="87fdb43f-8338-4ccf-9cb8-16a9d53478ae" class="code"><code class="language-Java">interface List&lt;T&gt;{
 ...
 default boolean removeIf(Predicate&lt;? super E&gt; p){
 ...
 ... if (p.test(element)){ .../*remove it*/...}
 ...
 ...
 }
}</code></pre></details></li></ul></details></li></ul><ul id="2cc59beb-6a9a-45bd-932c-f8c0deec0fcc" class="toggle"><li><details><summary>State Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="3dcfe92d-7416-46df-9fba-995f81195091"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">the top level object is a wrapper for an state object that implements behavior and on state change, the state change can change into a different state object with different behavior<ul id="9ec91674-fbf1-41d8-8c96-47eaafefd3a0" class="bulleted-list"><li style="list-style-type:disc">allows an object to alter its behavior when its internal state changes.<ul id="585c3212-474c-4ab2-8539-2031f41503e4" class="bulleted-list"><li style="list-style-type:circle">somehow the object will appear to change its class.</li></ul></li></ul><ul id="7f960cbf-360a-4db4-a522-8d3fede68f23" class="bulleted-list"><li style="list-style-type:disc">allows us to encode finite state machines</li></ul><ul id="28e1e4ba-dbf3-41c2-a6da-bdd04b482430" class="bulleted-list"><li style="list-style-type:disc">in OOP, FSM’s are encoded using dynamic dispatch instead of if/switch statements </li></ul><figure id="d0340cac-0455-481b-ae2c-b6534cf7e244" class="image"><a href="Untitled%2044.png"><img style="width:782px" src="Untitled%2044.png"/></a></figure></div></figure><ul id="0f8ca0c2-86eb-4388-96ee-02f3637d6be1" class="toggle"><li><details><summary>Finite State Machine: Doors</summary><figure id="12a8e0d1-abab-48db-b54b-52bc680f92cd" class="image"><a href="Untitled%2045.png"><img style="width:639px" src="Untitled%2045.png"/></a></figure><figure id="162071ac-dcac-498b-8fe0-a9a6ba1ba440" class="image"><a href="Untitled%2046.png"><img style="width:705px" src="Untitled%2046.png"/></a></figure></details></li></ul><ul id="512cc053-499f-40ce-aa48-3f1e9f8b330d" class="toggle"><li><details><summary>Game example</summary><ul id="c921de78-6025-4e8d-971c-c2ae6580c22a" class="bulleted-list"><li style="list-style-type:disc">Warriors can fight each others;</li></ul><ul id="3f09eef2-2b57-4b46-b113-382ff26c10a4" class="bulleted-list"><li style="list-style-type:disc">they can behave differently in different moments:<ul id="b91bd1d5-1c08-4d77-ab16-5a53f4cb75e7" class="bulleted-list"><li style="list-style-type:circle">ready to fight -&gt; looks around carefully</li></ul><ul id="a1d90dc4-1730-47ed-8d84-c252ea9ed0b7" class="bulleted-list"><li style="list-style-type:circle">recovering -&gt; health grows up</li></ul><ul id="a0a2c14f-fa24-4a98-b697-f2335df3ef13" class="bulleted-list"><li style="list-style-type:circle">death</li></ul></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d93eb991-3f0a-4dda-8dfa-c060064d9964" class="code"><code class="language-Java">public class Warrior{
		int x; 
		int y;
		WarriorState state= new Recovering( MaxHealth / 2 );
		void ping(){ state.ping(this); }
		void damage(int i){ state.damage(this, i); }
		int attack(){ return state.attack(this); }
		void draw(Graphics g){ state.draw(this,g); }
 }
 
interface WarriorState {
		void ping(Warrior w);
		void damage(Warrior w, int i);
		int attack(Warrior w);
		void draw(Warrior w, Graphics g);
		}
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8c344436-89bf-49d9-ae19-8a3b73bb8ad5" class="code"><code class="language-Java">class Recovering implements WarriorState {

		int health; Recovering(int h){ health= h; }
		
		public void ping(Warrior w){
				health += 1;
				//Like changing class!
				if (health &gt;= MaxHealth){ w.state = new Ready(health, 0); }
		}
		
		public void damage(Warrior w, int i){
				health -= i;
				//chose next class! chose next class!
				if (health &lt;= 0){ w.state = new Dead(); }
				else { w.state = new Ready(health, 0); }
		}
		
		public int attack(Warrior w){
				w.state = new Ready(health, 0); //change class, and then use it!
				return w.attack();
		}
		
		public void draw(Warrior w, Graphics g){ /*...*/ }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e734c1db-6995-4636-b551-7a1b999c1663" class="code"><code class="language-Java">class Ready implements WarriorState {
 int health;
 int attack;
 Ready(int h, int a){ health= h; attack= a; }
 public void ping(Warrior w){
 if (attack &lt; MaxHealth){ attack += 1; }
 }
 public void damage(Warrior w, int i){
 health -= i;
 if (health &lt;= 0){ w.state = new Dead(); }
 }

 public int attack(Warrior w){ return attack; }
 public void draw(Warrior w, Graphics g) { /*...*/ }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ef2fbbbb-aabd-4d4f-9197-6a330394f08b" class="code"><code class="language-Java">class Dead implements WarriorState {
 public void ping(Warrior w){}

 public void damage(Warrior w, int i){}

 public int attack(Warrior w){ throw new Error(&quot;...&quot;); }

 public void draw(Warrior w, Graphics g){ /*...*/ }
}

//By the way, Dead is an example of the Null Object Pattern! will see this later</code></pre></details></li></ul></details></li></ul><ul id="e7165038-2267-4f5a-b86f-4be769379ee5" class="toggle"><li><details><summary>Strategy vs State</summary><ul id="657f8a5a-49d5-430e-860e-ea3d115a7fdc" class="bulleted-list"><li style="list-style-type:disc">Very similar patterns</li></ul><ul id="1761aea9-c9a3-4f99-af72-65aaf21ef7f4" class="bulleted-list"><li style="list-style-type:disc">use Strategy when there is <mark class="highlight-red">a single method</mark> need to <mark class="highlight-red">change behavior</mark> depending of the situation.<ul id="ff97a18a-83ff-43fa-ae28-b3a8f67a2040" class="bulleted-list"><li style="list-style-type:circle">Usually an external agent sets the strategy, and the object just follows it.</li></ul><ul id="b73c5c16-05e6-4823-8b51-9328db4b293d" class="bulleted-list"><li style="list-style-type:circle">Usually loose coupling between the object and the strategies</li></ul></li></ul><ul id="7a58d133-c084-44ab-b585-7834de561be1" class="bulleted-list"><li style="list-style-type:disc">use state when <mark class="highlight-red">all/most of the methods</mark> of the class need to <mark class="highlight-red">change behavior</mark> depending of the situation<ul id="43eb731b-5bc3-4cfc-b9a6-ea5bf398c771" class="bulleted-list"><li style="list-style-type:circle">It is common for the object itself to set a new state for itself.</li></ul><ul id="09b6932a-ee74-46f1-92d0-334d2c53a583" class="bulleted-list"><li style="list-style-type:circle">Usually high coupling between the object and the states<br/>(that is, they nee to see each other ‘privates’)<br/></li></ul></li></ul><p id="2cc3a498-1d23-4177-a668-566bb950061d" class="">
</p></details></li></ul><ul id="33119652-29e6-4857-ac7e-84a2b1087353" class="toggle"><li><details><summary>Adapters, Mocks and Dependency Injection</summary><ul id="a327da3f-e180-46e1-90cd-3ebad01e7ae2" class="toggle"><li><details><summary>Adapter</summary><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="8242e274-6e75-432c-8c59-87b97e06b4aa"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">small object that converts one interface into another<ul id="9237441a-1584-4cd1-ae94-58803374cb08" class="bulleted-list"><li style="list-style-type:disc">possibly unrelated interfaces</li></ul><ul id="2c606763-b2e1-481d-9869-f34dc107928b" class="bulleted-list"><li style="list-style-type:disc">you want a foo but you have a bar. Built an Adapter from Bar into Foo!</li></ul></div></figure><ul id="5914b844-b121-43a6-ab42-280d822b7df2" class="toggle"><li><details><summary>Adapter 1</summary><p id="16d84e65-3695-4ad7-9d24-6ac8649e7c0d" class="">this should work but allMatch accepts a predicate, not a function</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a27db68d-5afa-4de4-83c8-9a000f131413" class="code"><code class="language-Java">static boolean of(List&lt;String&gt; ss, Function&lt;String,Boolean&gt; test){
 return ss.stream().allMatch(test);//Type error!
//Ideally, we would like to just write
//&quot;&quot;return ss.stream().allMatch(test);&quot;&quot;
//But, we can not do it! allMatch wants a Predicate&lt;String&gt;,
//but we have a Function&lt;String,Boolean&gt;.
}

● allMatch takes a Predicate&lt;String&gt;
● We have a Function&lt;String,Boolean&gt;
● We need to build an object that
– extends Predicate&lt;String&gt;,
– has a single field of type Function&lt;String,Boolean&gt;
– use Function.apply method to implement Predicate.test.</code></pre><p id="76ea8a43-4126-46ba-9837-a5b6cb12324b" class="">
</p><p id="7fe8db04-be46-4bbb-9d98-3746735d4fe9" class="">to fix this we can use a lambda as an adaptor</p><p id="dbc71b5a-b783-438a-a965-0a2ed80d984a" class="">the lambda is a class that extends predicate and overrides the apply method</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8564ca93-7ed6-4181-8571-905d779711d6" class="code"><code class="language-Java">static boolean of(List&lt;String&gt; ss, Function&lt;String,Boolean&gt; test){
 return ss.stream().allMatch( s-&gt;test.apply(s) );
}</code></pre><p id="451985b8-b6b7-4323-b931-1443c9c00b89" class="">● That is the lambda s-&gt;test.apply(s)<br/>● Lambdas are objects.<br/>● Lambda objects are instantiated without the ‘new’ keyword<br/>● Lambda objects extend their interface type.<br/>● Lambda objects implement a method of their interface type<br/>● Lambda objects captures the state needed by that method in<br/>‘synthetic fields’.<br/></p></details></li></ul><ul id="daad7ce7-c711-4c3d-a011-66d05ea6f0b4" class="toggle"><li><details><summary>Adapter old style</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="607a8f09-59a7-4917-8075-c7711472f4de" class="code"><code class="language-Java">interface FileResource{
 void open();
 void close();
 String readAll();
}
class Read{//We have a functionality that wants a FileResource
 static String of(FileResource fr){
		 fr.open();
		 try{ return fr.readAll(); }
		 finally{ fr.close(); }
 }
}
//We do not have a file resource.
//We would like not to engage the file system at all.
//We have the string already!
record StringFR(String readAll) implements FileResource{
 public void open(){ }
 public void close(){ }
}
//This is conceptually an adapter String→FileResource</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="99ea04c5-0148-4059-ad57-676f0f2a9cf5" class="code"><code class="language-Java">interface FileResource{
 void open();
 void close();
 String readAll();
}
class Read{//We have a functionality that wants a FileResource
 static String of(FileResource fr){
 fr.open();
 try{ return fr.readAll(); }
 finally{ fr.close(); }
 }
}
//We do not have a file resource.
//We would like not to engage the file system at all.
//We have the string already!
record StringFR(String readAll, List&lt;String&gt; log) implements FileResource{
 public void open(){ log.add(&quot;open&quot;); } //solution
 public void close(){ log.add(&quot;close&quot;); } //solution
}
//Additionally, we want to record when the other operations are called
//This is conceptually an adapter String→FileResource
//Or is it an adapter from List&lt;String&gt;→FileResource? Both?</code></pre><p id="269e1321-20c6-463b-b5b4-6123bee70e81" class="">this </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8c8bd6e0-8c62-4264-b3b3-851ed6d7e850" class="code"><code class="language-Java">//This is great for testing!!!
record MockFR(String readAll, List&lt;String&gt; log) implements FileResource{
 public void open(){ log.add(&quot;open&quot;); }
 public void close(){ log.add(&quot;close&quot;); }
}
....
List&lt;String&gt; log = new ArrayList&lt;&gt;();
FileResource data1= new MockFR(&quot;a&quot;,log); //create mock objects
FileResource data2= new MockFR(&quot;bb&quot;,log); //they are our tests input!
FileResource data3= new MockFR(&quot;ccc&quot;,log);
assertEquals(&quot;a&quot;, Read.of(data1)); //check the behavior on the boundary (usual)
assertEquals(&quot;[open, close]&quot;, log.toString());//check internal behavior! (NEW!)
log.clear();//clear the log

//Rinse and repeat
assertEquals(&quot;bb&quot;, Read.of(data2));
assertEquals(&quot;[open, close]&quot;, log.toString());
log.clear();

assertEquals(&quot;ccc&quot;, Read.of(data3));
assertEquals(&quot;[open, close]&quot;, log.toString());
log.clear();</code></pre></details></li></ul></details></li></ul><ul id="20ad6d09-c6b3-4d03-8833-99fcdce71075" class="toggle"><li><details><summary>Mocks</summary><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="a76f6bbf-6539-4b88-9650-dcc72631ae07"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">an object that provides the bare minimum functionality implementation of an interface for the code to work in a specific case<ul id="b8b66fe8-fe69-40e1-84c7-4a6146ecc458" class="bulleted-list"><li style="list-style-type:disc">a design pattern in of itself, but its also just a special case of an adapter</li></ul></div></figure><h3 id="55547773-6b39-4f39-94a2-40f8a101e9db" class="">one of the best uses for dynamic dispatch!</h3><p id="c42d6e7c-6806-4d72-aac6-a2f90a8f7020" class="">a normal test</p><ol type="1" id="8127d43c-9a53-4e64-ac25-614ce0f78409" class="numbered-list" start="1"><li>init the data</li></ol><ol type="1" id="e5922527-5f43-4442-8c5d-2672444d0c4c" class="numbered-list" start="2"><li>run the operation</li></ol><ol type="1" id="8d3470a9-a41b-41ab-8e76-29af6304d6ec" class="numbered-list" start="3"><li>check that the result satisfy our exceptions</li></ol><p id="4b61ee21-6533-476c-b327-0a0e896b98cd" class="">with mock objects:</p><ol type="1" id="678685e4-8b7b-4ec5-8cd0-b65bfe2b38a6" class="numbered-list" start="4"><li>check that the log satisfy our expectations</li></ol><p id="e1436b0b-e8ba-4a94-866b-a818fc5176e8" class="">in this way in addition of just testing the<br/>“input→ output” boundaries of our code,<br/>we can test the internal behavior too!<br/>●<br/>In the example<br/>Read.of(data2).equals(&quot;bb&quot;); checks the input→output<br/>log.toString().equals(&quot;[open, close]&quot;);<br/>checks the internal behavior of “Read.of”<br/></p></details></li></ul><ul id="e8b31a05-1707-419f-aa9e-c749a5887118" class="toggle"><li><details><summary>Independently testable components</summary><p id="805e8166-a754-480a-95d1-5d0b11d14ca9" class="">mock + abstract factory = kinda Dependency injection</p><ul id="68e41108-1623-40e0-aabd-5b2ef85750e7" class="toggle"><li><details><summary>Video game example!</summary><figure id="4ccc859b-beca-47b7-9f0d-759679de08d7" class="image"><a href="Untitled%2047.png"><img style="width:1392px" src="Untitled%2047.png"/></a></figure><p id="7d36ca0d-eced-4694-98fe-da23301f9fba" class="">the jobs bob, alice and charly work together for a video game</p><figure id="32694aec-1c96-4e9c-a904-3bc07bd65331" class="image"><a href="Untitled%2048.png"><img style="width:1386px" src="Untitled%2048.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b62b863d-8a04-4157-80f5-ac5b264f7d22" class="code"><code class="language-Java">//Common code
interface WMap{//WMap == world map
 Entity get(int x, int y);
 void set(int x, int y, Entity e);
 static final int maxX= 5;
 static final int maxY= 5;
}
interface Entity{
 String name();
 int weight();//and many more
}
//Bob Code
class BobMap implements WMap{//Unfinished
 public Entity get(int x, int y){ throw new Error(&quot;Todo&quot;); }
 public void set(int x, int y,Entity e){ throw new Error(&quot;Todo&quot;); }
}
class BobTree implements Entity{
 public String name(){ return &quot;Tree&quot;; }
 public int weight(){ return 100; }//and many more
}
class BobRock implements Entity{
 public String name(){ return &quot;Rock&quot;; }
 public int weight(){ return 500; }//and many more
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22bc000f-86d7-4a10-a261-63511318d5a4" class="code"><code class="language-Java">//Alice code
interface Alice{
 default void save(WMap map, String fileName){
 String res= &quot;&quot;;
 for (int xi= 0; xi &lt; WMap.maxX; xi++){
 for (int yi= 0; yi &lt; WMap.maxY; yi++){
 res += map.get(xi, yi).name() + &quot;,&quot;;
 }
 res += &quot;\n&quot;;
 }
 writeOnFile(fileName, res);
 }
 default void writeOnFile(String fileName, String content){
 try { Files.writeString(Path.of(fileName), content); }
 catch(IOException e){ throw new Error(e); }
 }
}
//Can we test this code without using Bob code?</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f7d47952-abbd-41d9-b9dd-8b0360ab9366" class="code"><code class="language-Java">import static org.junit.jupiter.api.Assertions.*; ...
record MockEntity(String name) implements Entity{
 public int weight(){ throw new Error(); }
} //same for all methods not related to save/load
record MockMap(List&lt;String&gt; log, Map&lt;String,String&gt; data) implements WMap {
 public void set(int x, int y, Entity e){ throw new Error(); }
 public Entity get(int x, int y){
 log.add(&quot;Get &quot; + x + &quot;,&quot; + y);
 String res= data.getOrDefault(x + &quot;,&quot; + y,&quot;Out&quot;);
 return new MockEntity(res);
 }
}
record AliceTestSave(List&lt;String&gt; log) implements Alice{
 public void writeOnFile(String fileName, String content){
 log.add(fileName); log.add(content);
 }
 public static void check(Map&lt;String,String&gt; data, String logRes){
 var log= new ArrayList&lt;String&gt;();
 new AliceTestSave(log).save(new MockMap(log,data), &quot;dummy.txt&quot;);
 assertEquals(logRes, log.stream().collect(Collectors.joining(&quot;\n&quot;)));
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="61fa4212-46e4-4fe9-a630-390c95773ca4" class="code"><code class="language-Java">import static org.junit.jupiter.api.Assertions.*; ...
record MockEntity(String name) implements Entity{
 public int weight(){ throw new Error(); }
} //same for all methods not related to save/load
record MockMap(List&lt;String&gt; log, Map&lt;String,String&gt; data) implements WMap {
 public void set(int x, int y, Entity e){ throw new Error(); }
 public Entity get(int x, int y){
 log.add(&quot;Get &quot; + x + &quot;,&quot; + y);
 String res= data.getOrDefault(x + &quot;,&quot; + y,&quot;Out&quot;);
 return new MockEntity(res);
 }
}
record AliceTestSave(List&lt;String&gt; log) implements Alice{
 public void writeOnFile(String fileName, String content){
 log.add(fileName); log.add(content);
 }
 public static void check(Map&lt;String,String&gt; data, String logRes){
 var log= new ArrayList&lt;String&gt;();
 new AliceTestSave(log).save(new MockMap(log,data), &quot;dummy.txt&quot;);
 assertEquals(logRes, log.stream().collect(Collectors.joining(&quot;\n&quot;)));
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a96136ea-cffe-464f-81ac-1a76b54cb18f" class="code"><code class="language-Java">@Test void test() {
 AliceTestSave.check(
 Map.of(&quot;1,2&quot;,&quot;Tree&quot;, &quot;3,4&quot;,&quot;Rock&quot;),&quot;&quot;&quot;
 Get 0,0
 Get 0,1
 Get 0,2
 ...
 Get 4,3
 Get 4,4
 dummy.txt
 Out,Out,Out,Out,Out,
 Out,Out,Tree,Out,Out,
 Out,Out,Out,Out,Out,
 Out,Out,Out,Out,Rock,
 Out,Out,Out,Out,Out,
 &quot;&quot;&quot;);}</code></pre><p id="75ebbe18-38f6-4be9-87e8-fac9aa85c99c" class="">Define Mock Alice with a<br/>mock ‘writeOnFile’ method<br/>that just logs<br/>Define MockEntity and<br/>MockMap; Mock map needs<br/>minimal functionalities<br/>Write the test. The method<br/>Alice.save can now be<br/>tested, by writing a few<br/>dozen methods like the one<br/>shown above.<br/>Possible since we had<br/></p><ul id="2153ab35-8d06-43f8-8101-9edf076e1985" class="bulleted-list"><li style="list-style-type:disc">Map as an interface</li></ul><ul id="cf0e02c9-45a6-43eb-b277-c460ef13ef4e" class="bulleted-list"><li style="list-style-type:disc">writeOnFile as a method</li></ul><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="394f06df-94c8-4d47-b861-6e6e8f8b1d76"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="02af4524-e2e9-42b1-a33e-6d33c066789f" class="">to make code more testable, write code that is more abstract, ie this only works becauseMap is an interface and writeOnFile is a method</p></div></figure><p id="3fd03189-5670-4c70-9e61-33ed3a142b3e" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="724fba6e-8bd5-4ca9-abab-217040c68d2a" class="code"><code class="language-Java">//First attempt at Charly code
interface Charly0{
 default WMap read(String fileName){
 WMap res= new BobMap();
 String content= readFile(fileName);
 List&lt;String&gt; data= Stream.of(content.split(&quot;\n&quot;))
 .flatMap(s-&gt;Stream.of(s.split(&quot;,&quot;)))
 .toList();
 int xi= 0;
 int yi= 0;
 for (var e:data){
 res.set(xi, yi, this.stringToEntity(e));
 yi += 1;
 if (yi == WMap.maxY){ yi = 0; xi += 1; }
 }
 return res;
 }
 default Entity stringToEntity(String e){...}
 default String readFile(String fileName){...}
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c496029b-5cd5-4f4d-999e-c9682d238565" class="code"><code class="language-Java">//First attempt at Charly code
interface Charly0{
 default WMap read(String fileName){
 WMap res= new BobMap();
 ...
 return res;
 }
 default Entity stringToEntity(String e){
 switch (e){
 case &quot;Tree&quot;: return new BobTree();
 case &quot;Rock&quot;: return new BobRock();
 default: throw new Error(&quot;invalid &quot;+e);
 }
 }
 default String readFile(String fileName){
 try { return Files.readString(Path.of(fileName)); }
 catch (IOException e){ throw new Error(e); }
 }
}
//Can we test this code without using Bob code? No, since we hardcoded
//new BobMap, new BobTree and new BobRock</code></pre><p id="4c293c9f-aa99-4481-858b-fa0f0a8b34c8" class="">currently our code doesn’t compile without bob code</p><p id="954f44a3-b3a1-4260-a42f-4cb04c19ecb8" class="">so this means we cannot test in isolation without bob code</p><ul id="e2df1828-f511-4fd7-8c0e-64f67343fd9a" class="bulleted-list"><li style="list-style-type:disc">we can solve this with abstract factory pattern</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="406a53e9-d576-4f05-9dd2-60b3b60e9193" class="code"><code class="language-Java">//DEPENDENCY INJECTION
interface Charly{
 Supplier&lt;WMap&gt; map();//Could be BobMap map() but also a mock
Map&lt;String,Supplier&lt;Entity&gt;&gt; es();
 default WMap read(String fileName){
 WMap res= map().get();//abstract factory pattern!
 ... //code without &#x27;new&#x27; stays the same
 for (var e:data){
 res.set(xi, yi, es().get(e).get());//abstract factory pattern!
 yi += 1;
 if (yi == WMap.maxY){ yi = 0; xi += 1; }
 }
 return res;
 }
 default String readFile(String fileName){
 try { return Files.readString(Path.of(fileName)); }
 catch(IOException e){ throw new Error(e); }
 }
}
//Now we can test this code without using Bob code!
//The &#x27;new&#x27; keyword is an enemy of testable code!</code></pre><p id="6e4ef588-0014-4953-9cf4-ed18adb8f0e8" class="">
</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9a7987b9-8781-486e-9e30-d4925d0e6456" class="code"><code class="language-Java">import static org.junit.jupiter.api.Assertions.*; ..
record MockEntity(String name) implements Entity{
 public int weight(){ throw new Error(); }
} //same for all methods not related to save/load
record MockMap(List&lt;String&gt; log) implements WMap{
 public Entity get(int x, int y){ throw new Error(); }
 public void set(int x,int y, Entity e){ log.add(&quot;Set &quot;+x+&quot;,&quot;+y+&quot; &quot;+e.name());}
}
record CharlyTestLoad(
 List&lt;String&gt; log,
 Supplier&lt;WMap&gt; map,
 Map&lt;String,Supplier&lt;Entity&gt;&gt; es,
 String content
 ) implements Charly{
 public String readFile(String fileName){ log.add(fileName); return content; }
 public static void check(String content, String expected){
 ...
 }
}
..</code></pre></details></li></ul></details></li></ul><ul id="55414473-3669-49a8-b9fb-075c3e204a93" class="toggle"><li><details><summary>Dependency injection frameworks</summary><p id="93349b23-d60c-4a5e-afc3-c9980a7a85f6" class="">They got a little bit of traction a few years ago.<br/>Even at the time, the big Dependency Injection Gurus were not impressed<br/>by those frameworks and suggested to first learn to do DI on your own,<br/>so that you can chose to use the framework or not later.<br/>Now that Java is a much more usable language, the need for those<br/>frameworks is even less.<br/>Also, DI is a programming pattern in the sense that we have<br/>a GREAT AMOUNT of possible choices<br/></p><ul id="9d5d765a-23ac-48fd-a4b5-9badef06e021" class="bulleted-list"><li style="list-style-type:disc">Factories as fields?</li></ul><ul id="1ef22814-8eac-4737-9453-430b2c602271" class="bulleted-list"><li style="list-style-type:disc">Factories as method parameters?</li></ul><ul id="92103c8b-a58e-49e8-9968-f3038c33880e" class="bulleted-list"><li style="list-style-type:disc">Factories as default implementation for methods?</li></ul><ul id="2f97b204-f492-460e-8866-4cbef697126f" class="bulleted-list"><li style="list-style-type:disc">Special objects that just store factories? Static?</li></ul></details></li></ul><ul id="83bb46fe-0e91-42c6-bf77-ae75d049e15c" class="toggle"><li><details><summary>Views / extracting a member</summary><figure id="7a67c2bc-d561-4312-be44-40348a584947" class="image"><a href="Untitled%2049.png"><img style="width:2535px" src="Untitled%2049.png"/></a></figure><ul id="68151f0e-5a2f-4c92-b99d-78b8f5ca3b57" class="bulleted-list"><li style="list-style-type:disc">we often use adaptors that only implements one feature rather than the whole object</li></ul><ul id="6b5be28d-67bd-46b2-b973-490aacd25a24" class="bulleted-list"><li style="list-style-type:disc">the :: syntax works very well this well</li></ul></details></li></ul></details></li></ul><ul id="ab84654c-49e6-454d-ab32-7fab3671abe5" class="toggle"><li><details><summary>MVC, proxy, and Null Object</summary><ul id="0a54f3d6-354f-4fc4-9db5-20f42d9e5ec7" class="toggle"><li><details><summary>MVC Original</summary><h3 id="5ecd5952-5a97-4df9-ba9f-b389c291335c" class="">Diagram</h3><figure id="d74b8933-6e21-4070-8af2-7428ebbcb667" class="image"><a href="Untitled%2050.png"><img style="width:652.04541015625px" src="Untitled%2050.png"/></a></figure><ul id="c67efb17-cf8b-4cda-87d4-c89905ee9468" class="bulleted-list"><li style="list-style-type:disc">controller literally has a field storing the model</li></ul><ul id="e1c1c7f9-01f4-4000-9d7c-830a49ca92d7" class="bulleted-list"><li style="list-style-type:disc">view may have the model</li></ul><ul id="30c87e55-d949-4337-8653-5deffc0bcdc0" class="bulleted-list"><li style="list-style-type:disc">dotted represent observers<p id="79438bd8-b90f-4c4c-b693-3457ffd29cd6" class="">so the model observers the view (model contains the view in its reachable object graph)</p></li></ul><ul id="ef231f33-d806-4ad3-a754-0609e6605832" class="bulleted-list"><li style="list-style-type:disc">view displays output of the model, controller sends data to the model</li></ul><h3 id="e66f7f39-5a3a-461b-81e2-62f8ffe3b2c7" class="">Controller</h3><ul id="de2698a2-9b42-4d40-93b3-6dcf4c426490" class="bulleted-list"><li style="list-style-type:disc">Converts GUI events into user actions</li></ul><ul id="c1eb1cf7-ce3f-4a58-a199-481422e26ad9" class="bulleted-list"><li style="list-style-type:disc">Notifies model of user action<figure id="22b3bdc4-90c3-478b-a66f-37ffd16cad82" class="image"><a href="Untitled%2051.png"><img style="width:624.0340576171875px" src="Untitled%2051.png"/></a></figure></li></ul><h3 id="104000bb-f06c-4222-8228-340db53da209" class="">View</h3><p id="54a54780-bf64-4262-a306-dd09d52d8927" class="">View queries model to draw interface</p><figure id="f491f89a-a34f-4978-b8e0-8745abfb8847" class="image"><a href="Untitled%2052.png"><img style="width:651.984375px" src="Untitled%2052.png"/></a></figure><h3 id="63983f61-3443-4c74-8053-76feb3b778ae" class="">Model</h3><p id="71d9d62e-f344-4b93-a349-dc1df1dea6a0" class="">Model notify the View of relevant changes</p><figure id="045e5dcc-ae4c-4822-a9d3-311093ed297d" class="image"><a href="Untitled%2053.png"><img style="width:651.96875px" src="Untitled%2053.png"/></a></figure><h3 id="321af18a-523e-4458-9c1e-9b21a125a55e" class="">Empty Model, Empty View, Empty controller Example</h3><figure id="014a62df-9409-4177-9c7c-65524c4b5f09" class="image"><a href="Untitled%2054.png"><img style="width:652.0170288085938px" src="Untitled%2054.png"/></a></figure><h3 id="7248311f-a3d6-44ab-a0f6-c59b0465cc88" class="">Complex Model, Complex View, Complex controller</h3><figure id="3a271fe0-9e09-4bcf-b240-1f9a80612f90" class="image"><a href="Untitled%2055.png"><img style="width:651.9885864257812px" src="Untitled%2055.png"/></a></figure></details></li></ul><ul id="accf5720-9bc0-4989-99da-8791e27b3fbb" class="toggle"><li><details><summary>Proxy pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="60fc53eb-4bed-434c-8c63-b576cd69b58f"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><mark class="highlight-yellow">proxy </mark>object that either:<ul id="870996bd-982f-47e7-94af-e2e721336ae5" class="bulleted-list"><li style="list-style-type:disc">forwards calls to the <mark class="highlight-yellow">target</mark></li></ul><ul id="d025b86f-e0ed-47d0-ba53-f24566e43c2c" class="bulleted-list"><li style="list-style-type:disc">offers a get() method returning the <mark class="highlight-yellow">target</mark></li></ul><p id="ebd8d799-dd41-4bb2-af61-72922ed93c5e" class="">focus is on the unusual connection between proxy and the target</p><figure id="0c6da9a0-3c2b-4108-838b-d790f8496501" class="image"><a href="Untitled%2056.png"><img style="width:218.57223510742188px" src="Untitled%2056.png"/></a></figure><ul id="b44ea856-f87c-49ee-b018-480fc4ab8979" class="bulleted-list"><li style="list-style-type:disc">Optional&lt;T&gt;: the Target may or may not be present.</li></ul><ul id="7ca3c9ad-cee1-4c9f-b8eb-8fcfb41def7b" class="bulleted-list"><li style="list-style-type:disc">Future&lt;T&gt;: the Target may not be present yet.</li></ul><ul id="b132be7f-56bc-4e4a-a54a-f0c974713252" class="bulleted-list"><li style="list-style-type:disc">Remote (java.rmi): The target may be on another machine, and is accessed by remote method invocation.</li></ul></div></figure></details></li></ul><ul id="d2fedc58-af95-4ced-b870-8d613f5369f9" class="toggle"><li><details><summary>Proxy, MVC and Web Design</summary><p id="2ad189d2-0d5d-44d6-bc25-df3fcbc1bd97" class="">The MVC pattern in web design is actually MVC + proxy</p><ul id="20b8d408-7b34-426d-8a71-5e069b1b2f63" class="bulleted-list"><li style="list-style-type:disc">view and controller is distributed to many users</li></ul><ul id="8272b1da-87ba-4b41-b6f0-dedbc2517d0b" class="bulleted-list"><li style="list-style-type:disc">but the model given to the user is a proxy or mock</li></ul><ul id="4706ea2e-5db3-47eb-9490-a365d7f89dcf" class="bulleted-list"><li style="list-style-type:disc">this proxy model forwards calls to the actual target model running on a server</li></ul><figure id="1319f3f9-48b5-4549-93b6-2bc2792e8393" class="image"><a href="Untitled%2057.png"><img style="width:651.96875px" src="Untitled%2057.png"/></a></figure></details></li></ul><ul id="bb516a0f-dbb9-4067-ab76-ec204eab7086" class="toggle"><li><details><summary>MVC: not just GUIs</summary><ul id="2e770764-df92-4688-80ec-59e42260e0fe" class="bulleted-list"><li style="list-style-type:disc">MVC can be used aside from GUI’s when components have to interact asynchronously, MVC could help. Especially if they have to iterate over and over again.</li></ul><ul id="bd138603-e7fc-4cab-835e-cf61dee9e5db" class="bulleted-list"><li style="list-style-type:disc">when behavior is like ping pong</li></ul><ul id="2d3bce11-5416-48c8-b0ec-37f2a849ae4f" class="bulleted-list"><li style="list-style-type:disc">asynchronously is when: you send message “compile:” and the method returns void amidiently, then when the compilcation is actually done, it using some way (such as an observer pattern) set up an execution when the compuation is done</li></ul><figure id="8f33ccc2-abc7-4c01-8c13-ba126615de7e" class="image"><a href="Untitled%2058.png"><img style="width:651.96875px" src="Untitled%2058.png"/></a></figure><p id="03c7cb7a-2f84-48a5-95ee-bf70602bb117" class="">
</p></details></li></ul><ul id="648c4979-cd41-4921-9230-a68983c7b6f6" class="toggle"><li><details><summary>Overkill example: We make an AGI to teach MVC</summary><h3 id="b83e9483-16f4-433e-88d9-1bea507418ca" class="">MVC types</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d5d5d131-577f-4268-b08f-5a4bb78a9a28" class="code"><code class="language-Java">class LLM{..}
//The view contains the LLM
record View(LLM llm, Consumer&lt;View&gt; evenListener, List&lt;String&gt; llmResults){..
 void updateFromModel(ReadModel m){..} //The view only sees ReadModel
}
//Two kinds of model: The ReadModel only offers method to read data. 
interface ReadModel{..}

//The Model also offers method mutating the model state
interface Model extends ReadModel{..
 void setEventListener(Runnable e);
 void endPhase();
}
//The controller contains the Model
record Controller(Model m){.. //The controller sees Model
 void parseAllActions(String input){..}
}</code></pre><h3 id="4a38300a-f7a0-42a3-9936-bfef574e0c9e" class="">Client code</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="20fea19f-d683-4514-a457-88b4e1df271d" class="code"><code class="language-Java">Model model= makeModel(); //factory pattern
Controller c= new Controller(model); //controller directly contains model
View view= new View(new LLM(),
//view contains controller via an observer
 v-&gt;c.parseAllActions(v.llmResults().getLast()), 
 new ArrayList&lt;&gt;());
//model contains view via a controller
model.setEventListener(()-&gt;view.updateFromModel(model));
model.endPhase();</code></pre><h3 id="fd3d0021-62ca-44db-bfb9-10409c21ac69" class="">model methods</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b5e78750-7dce-41e3-a86c-89cfa6bbc232" class="code"><code class="language-Java">interface ReadModel{ //model methods reading state
 String summaryLastActions();
 List&lt;Objective&gt; objectives();
 Objective currentObjective();
 List&lt;Map&lt;CodeFile,String&gt;&gt; buildResultsHistory();
 List&lt;Map&lt;TestFile,String&gt;&gt; testResultsHistory();
}
interface Model extends ReadModel{ //model methods updating state
 void setCurrentObjective(Objective o);
 void removeObjective(Objective o);
 void addObjective(Objective o);
 void updateObjective(Objective o);
 void removeCodeFile(CodeFile file);
 void addCodeFile(CodeFile file);
 void updateCodeFile(CodeFile file);
 void removeTestFile(TestFile file);
 void addTestFile(TestFile file);
 void updateTestFile(TestFile file);
 void buildCode();
 void runTests();
 void endPhase();
 void setEventListener(Runnable e); //subject of Observer pattern
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2f336a0f-0b54-4597-90f6-77a6996ea4db" class="code"><code class="language-Java">record Objective(
 String name,
 String description,
 List&lt;String&gt; progress,
 List&lt;Objective&gt; usefulFor){}
record CodeFile(
 String fileName,
 String content,
 List&lt;String&gt; todos){}
record TestFile(
 String fileName,
 String content,
 Map&lt;Timestamp,List&lt;String&gt;&gt; results){}</code></pre><h3 id="fdeda4b6-fe5f-4718-8427-4a65ea228f04" class="">Implementation</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="33a33df2-7720-4b08-9add-9e40dbff9473" class="code"><code class="language-Java">class LLM{//Mock implementation
 private final static ScheduledExecutorService scheduler
 = Executors.newScheduledThreadPool(1);
 void submit(String prePrompt, String prompt){
 //This method should do the API calls to the remote LLM
 String dummy= ...;
 scheduler.schedule(()-&gt;listener.accept(dummy),1, TimeUnit.SECONDS);
 }
 //This below is code as it should be (following the observer pattern)
 void setEventListener(Consumer&lt;String&gt; c){listener= c;}
 Consumer&lt;String&gt; listener= s-&gt;{}; //Null object pattern
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="216bc033-46dc-4ebe-beab-dc5ac7215012" class="code"><code class="language-Java">//Observer pattern by field instead of Mock implementation
record View(LLM llm, Consumer&lt;View&gt; evenListener, List&lt;String&gt; llmResults){
 View{
 llm.setEventListener(res-&gt;{
 llmResults.add(res);
 evenListener.accept(this);//LLM can notify the View when webAPI done
 });
 }
 String prePrompt(){ /*..*/ };
 String prompt(ReadModel m){
 return m.summaryLastActions()//Example code, should do more stuff
 + m.currentObjective()
 + m.objectives().stream()
 .map(o-&gt;o.name()).collect(Collectors.joining(&quot;\n&quot;));
 };
 void updateFromModel(ReadModel m){
 llm.submit(prePrompt(),prompt(m));
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cfee9cd4-31bd-4f4c-9e64-6db921de6bf7" class="code"><code class="language-Java">record Controller(Model m){
 static final String start= &quot;[ActionStart]&quot;;
 static final String end= &quot;[ActionEnd]&quot;;
 void parseAllActions(String input){
 int startIndex= 0;//Parse input into actions. In a real application this
 while (true){ //would be much more code, with fall backs and heuristics
 startIndex = input.indexOf(start, startIndex);
 if (startIndex == -1){ break; }
 int endIndex= input.indexOf(end, startIndex);
 if (endIndex == -1){ break; }
 String action = input.substring(startIndex + start.length(), endIndex);
 startIndex = endIndex + end.length();
 parseSingleAction(action.trim());
 }
 m.endPhase();
 }
 void parseSingleAction(String input){
 /*..*///Example code
 m.addObjective(new Objective(&quot;Refactor classes into records&quot;,&quot;..&quot;,..,..));
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="99998ca9-0936-4b8b-acdc-3f3317ac5ab5" class="code"><code class="language-Java">//Look again at the wiring of the components
record View(LLM llm, Consumer&lt;View&gt; evenListener, List&lt;String&gt; llmResults){..
 void updateFromModel(ReadModel m){..}
}
interface ReadModel{..}
interface Model extends ReadModel{..
 void setEventListener(Runnable e);
 void endPhase();
}
record Controller(Model m){..
 void parseAllActions(String input){..}
}
...
public static void main(String[] args) {
 Model model= makeModel();
 Controller c= new Controller(model);
 View view= new View(new LLM(),
 v-&gt;c.parseAllActions(v.llmResults().getLast()),
 new ArrayList&lt;&gt;());
 model.setEventListener(()-&gt;view.updateFromModel(model));
 model.endPhase();
}</code></pre></details></li></ul><ul id="3640a031-4ffc-426d-be14-fc4cf4476a16" class="toggle"><li><details><summary>Null Object Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="9ef6ddf9-1435-4c83-a7e3-e6d8a9c82c19"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">instead of setting a field to a null, we can set it to an object that doesn’t do anything<ul id="fbe3183d-7a74-4540-b0c2-166250160c09" class="bulleted-list"><li style="list-style-type:disc">Sometimes a class that requires a collaborator does not need the collaborator to do anything</li></ul><ul id="6701f31f-cfe3-457f-993d-6e6c35b1aa93" class="bulleted-list"><li style="list-style-type:disc">Make a Null Object that does nothing</li></ul><figure id="e36a3adf-fc99-41fb-855c-8962ebe398b9" class="image"><a href="Untitled%2059.png"><img style="width:643px" src="Untitled%2059.png"/></a></figure></div></figure><ul id="f5028105-4403-4f72-bd5d-b48fde6e944d" class="toggle"><li><details><summary>videogame example</summary><figure id="ab89dd5c-cdc9-44ba-be46-d4bf014b0648" class="image"><a href="Untitled%2060.png"><img style="width:623.96875px" src="Untitled%2060.png"/></a></figure><ul id="9cdec561-c5e5-4db5-a70b-9bea72a8411c" class="bulleted-list"><li style="list-style-type:disc">we have a street fighter like game</li></ul><ul id="2b63ffe3-9ee9-4226-9286-f28d03f188b9" class="bulleted-list"><li style="list-style-type:disc">we have a player and opponent object</li></ul><ul id="eda08fbc-94bf-4cea-ad0b-87cc6a3f8e41" class="bulleted-list"><li style="list-style-type:disc">if we want a mode where you can play the game without the opponent to test things out:<p id="468b7601-7d9a-423c-828e-4dc8082782b7" class="">setting opponent to null will throw a null pointer exception everywhere the opponent field is used</p></li></ul><ul id="7148f10a-cdca-4bb0-b074-f5d5a541c791" class="bulleted-list"><li style="list-style-type:disc">instead of having a bunch of ifs that check of the opponent is null (which is ugly), we can use the null object pattern</li></ul><ul id="0c4ac5fb-ea7f-438c-9a46-557f12a57cf6" class="bulleted-list"><li style="list-style-type:disc">null object pattern is when we create an object that represents when an object is null or empty rather than actually setting it to null</li></ul><ul id="075d3ab6-d8ef-49cb-8ba2-03cd422cb218" class="bulleted-list"><li style="list-style-type:disc">when you call methods on the null object, it just does nothing</li></ul><ul id="0b77e956-8f53-4d85-b963-abc148147b22" class="bulleted-list"><li style="list-style-type:disc">this allows the code to be the same, dynamic dispatch is handling all those ifs implicitly </li></ul></details></li></ul><ul id="41756dc1-010c-4d0c-9bcb-545b4cdf2e80" class="bulleted-list"><li style="list-style-type:disc">Decide when to silently do nothing and when to throw an<br/>error.<br/></li></ul><ul id="bb36491a-ba5e-487a-be5f-e342152924af" class="bulleted-list"><li style="list-style-type:disc">Decide a simplified return value for do-nothing non void<br/>operations (like 0, empty list or null)<br/></li></ul><ul id="eae70261-6fbd-453f-bb93-f683ad57cfa8" class="bulleted-list"><li style="list-style-type:disc">we’ve seen this in the state pattern, where the dead warrior is a state where the object does nothing</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f39d9e27-3380-447f-9eb8-43e7463ba88f" class="code"><code class="language-Java">class Dead implements WarriorState {
 public void ping(Warrior w){}
 public void damage(Warrior w, int i) {}
 public int attack(Warrior w){ throw new Error(&quot;...&quot;); }
 public void draw(Warrior w, Graphics g){ /*...*/ }
}</code></pre></details></li></ul></details></li></ul><ul id="aa4e15a8-69a3-49d1-bc00-662d82cae49e" class="toggle"><li><details><summary>Collaborative Software Development with GIT</summary><ul id="209184c1-9d03-4441-b80e-b18c748eb4d2" class="toggle"><li><details><summary>Resources</summary><p id="bee1409c-be16-4f05-8ed7-db9b50e260d7" class="">Resources<br/>● <br/><a href="https://git-scm.com/">https://git-scm.com/</a><br/>● <br/><a href="https://docs.gitlab.com/ee/tutorials/">https://docs.gitlab.com/ee/tutorials/</a><br/>● <br/><a href="https://www.atlassian.com/git/tutorials/learn-git-with-bitbucket-cloud">https://www.atlassian.com/git/tutorials/learn-git-with-bitbucket-cloud</a><br/>● <br/><a href="https://www.w3schools.com/git/">https://www.w3schools.com/git/</a><br/>● <br/><a href="https://happygitwithr.com/">https://happygitwithr.com/</a><br/>● Git Cheatsheets:<br/>○ <br/><a href="https://www.atlassian.com/git/tutorials/atlassian-git-cheatsheet">https://www.atlassian.com/git/tutorials/atlassian-git-cheatsheet</a><br/>○ <br/><a href="https://training.github.com/downloads/github-git-cheat-sheet.pdf">https://training.github.com/downloads/github-git-cheat-sheet.pdf</a></p></details></li></ul><ul id="7ab84b1e-6766-49fa-8f4a-1fa4f63107e0" class="toggle"><li><details><summary>Commands</summary><h3 id="85c412a1-dfcb-402d-b288-fcfb598a0019" class="">init</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fe1f74d9-7c2c-4bc1-949a-f62dfe7d8841" class="code"><code class="language-Java">git init</code></pre><h3 id="f76c5a27-8640-472e-995f-5e7b2609ae9b" class="">status</h3><p id="ecf6fef0-1d50-4eea-92a8-0dd12e989c0b" class="">Check the status of changes in your working directory.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="867cd7bf-75ef-488d-adb9-632a24baf10b" class="code"><code class="language-Java">git status</code></pre><h3 id="0f577e5d-d655-4bb1-bbec-18c461634066" class="">add file</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4eefddd9-fc5b-481c-8682-2cf5d8003098" class="code"><code class="language-Java">git add file</code></pre><h3 id="fac86622-3a9b-4ca7-a02f-c895331c383e" class="">add files</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b2617384-3dc2-4281-8a44-0e7bafc418f6" class="code"><code class="language-Java">git add .</code></pre><h3 id="6136820a-4446-4036-9fd2-40b8f54f91d5" class="">commit </h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="93f18fb2-6bb6-449a-90fb-92ce0b8e05af" class="code"><code class="language-Java">git commit -m &quot;message&quot;</code></pre><h3 id="717681a0-adb1-4a2b-8816-f038921e1793" class="">push</h3><p id="82683a5e-4d73-46cc-b969-62c1533dcd89" class="">push local changes</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1efce488-4f25-46e2-80c4-458d9b5fd4ed" class="code"><code class="language-Java">git push</code></pre><h3 id="8b58a97b-9fb7-46a2-934a-4449ad650eca" class="">pull</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="778f00a4-35f0-4182-966d-0217a9ee99d7" class="code"><code class="language-Java">git pull</code></pre><h3 id="09e4caaa-68a1-4d28-abba-1c392475f64f" class="">merge</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="73626734-2f85-4b0b-b307-724d411e67d9" class="code"><code class="language-Java">git merge branch </code></pre></details></li></ul><hr id="1f73ee29-db1c-40b4-81b8-17c8233d6310"/><ul id="7358b862-d6dd-4cf7-b8b1-1fd62fb4a6ac" class="toggle"><li><details><summary>Gource</summary><blockquote id="5db269ee-23a9-454a-89da-9bb4bf24122d" class="">Software visualization tool<br/>of commits from version<br/>control histories like Git<br/><br/><p id="203adc5d-80b6-44da-a853-7d405bca2980" class="">Software projects are displayed<br/>by Gource as an animated tree<br/>with the root directory of the<br/>project at its centre. Directories<br/>appear as branches with files as<br/>leaves. Developers can be seen<br/>working on the tree at the times<br/>they contributed to the project.<br/></p></blockquote><figure id="d7512804-3cfc-414c-a0ac-f9cd74f095e0"><a href="https://gource.io/" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Gource - a software version control visualization tool</div><div class="bookmark-description">gource-0.53.win64-setup.exe
gource-0.53.win64.zip
gource-0.55.tar.gz</div></div><div class="bookmark-href"><img src="https://gource.io/favicon.ico" class="icon bookmark-icon"/>https://gource.io/</div></div></a></figure></details></li></ul><ul id="2e48098c-3f36-493f-8adf-39baa2c13937" class="toggle"><li><details><summary>Overview</summary><p id="02e31c3d-6096-4dd4-bfd4-e5a6a08b1de9" class="">● Motivation<br/>● History<br/>● Introducing Git<br/>● Basic workflows<br/>● Branching and merging<br/>● Tagging<br/>● Forking<br/>● Issue Tracking<br/>● Misc: rewriting history, forking and pull requests<br/></p></details></li></ul><ul id="7a25a3bb-07a2-433f-9da9-e39d7cde703b" class="toggle"><li><details><summary>Trends</summary><figure id="b5e36cc2-ac17-43c3-be5b-4ee13dcd4933" class="image"><a href="Untitled%2061.png"><img style="width:651.96875px" src="Untitled%2061.png"/></a></figure><figure id="36bae403-14c1-44de-8799-9eaa26f0b0ec" class="image"><a href="Untitled%2062.png"><img style="width:651.953125px" src="Untitled%2062.png"/></a></figure><p id="f68d40a6-9f2e-414f-96c4-ba45f6f1aa85" class="">
</p></details></li></ul><ul id="f4573a09-f7fc-4673-b4c6-59f80864538d" class="toggle"><li><details><summary>Use Cases: what we need and want</summary><figure id="5e192775-fecd-4ce3-a572-b934a975c784" class="image"><a href="Untitled%2063.png"><img style="width:651.96875px" src="Untitled%2063.png"/></a></figure></details></li></ul><ul id="abb83660-d8c8-4610-a655-28cddfcad9ab" class="toggle"><li><details><summary>Version Control Systems</summary><figure id="0b9af3cd-a3da-480b-84e9-fa1cd1e5733f" class="image"><a href="Untitled%2064.png"><img style="width:651.953125px" src="Untitled%2064.png"/></a></figure></details></li></ul><ul id="55f3bbe1-45f7-45b1-ba41-c3e71a99b41d" class="toggle"><li><details><summary>GIT</summary><figure id="4bd8b03a-dfbd-406c-9a4d-50e3c6eaee9b" class="image"><a href="Untitled%2065.png"><img style="width:651.984375px" src="Untitled%2065.png"/></a></figure><h3 id="c284a12c-0a24-4cbc-a076-662a63671399" class="">Dimensions</h3><figure id="54c8c296-c716-49fb-ae0e-a5782e82f92d" class="image"><a href="Untitled%2066.png"><img style="width:651.953125px" src="Untitled%2066.png"/></a></figure></details></li></ul><ul id="7ced9bea-7f5a-44b7-99b7-cddf8c113ec9" class="toggle"><li><details><summary>Distributed Repositories</summary><figure id="c33f0b58-7fb4-4582-b846-63753b632d2c" class="image"><a href="Untitled%2067.png"><img style="width:651.984375px" src="Untitled%2067.png"/></a></figure></details></li></ul><ul id="93c87436-43b5-4579-8dca-97e607d4c60b" class="toggle"><li><details><summary>Hosting Services</summary><figure id="0fe9a5dd-1451-41cf-baa3-23566135f5c0" class="image"><a href="Untitled%2068.png"><img style="width:651.984375px" src="Untitled%2068.png"/></a></figure></details></li></ul><ul id="ae4adbc0-3957-4ea7-93f8-77a84af9f713" class="toggle"><li><details><summary>GIT Clients</summary><figure id="bfbab9e2-1550-42be-addb-580f641ad148" class="image"><a href="Untitled%2069.png"><img style="width:651.984375px" src="Untitled%2069.png"/></a></figure></details></li></ul><ul id="8c1d3d1d-260d-4929-b805-6e4cce7616d5" class="toggle"><li><details><summary>Git Structure</summary><figure id="df1c7031-7141-44d7-866d-28398e85e106" class="image"><a href="Untitled%2070.png"><img style="width:651.984375px" src="Untitled%2070.png"/></a></figure></details></li></ul><ul id="2149b52b-42ec-479d-8714-f6ea56be911e" class="toggle"><li><details><summary>File States</summary><figure id="01471ebe-12b0-4765-88d5-638d1ae0b4d4" class="image"><a href="Untitled%2071.png"><img style="width:651.96875px" src="Untitled%2071.png"/></a></figure></details></li></ul><ul id="5124fc5b-9c17-41fa-bf9a-e0d6164f8eff" class="toggle"><li><details><summary>Staging</summary><figure id="08dcc361-7d5b-4918-871e-679e74a09f5d" class="image"><a href="Untitled%2072.png"><img style="width:651.953125px" src="Untitled%2072.png"/></a></figure></details></li></ul><ul id="c06d08fd-6ed6-4a75-93a6-ae767be26011" class="toggle"><li><details><summary>Ignoring Files</summary><figure id="37a57745-c037-4469-af17-bcbecbcf3df5" class="image"><a href="Untitled%2073.png"><img style="width:651.96875px" src="Untitled%2073.png"/></a></figure></details></li></ul><ul id="21e120b1-f407-4f35-9f0f-d1ea9eb7037b" class="toggle"><li><details><summary>Ignoring Files with Git</summary><figure id="3d7615b6-c5b9-41d2-bb00-37329b1afcb6" class="image"><a href="Untitled%2074.png"><img style="width:651.96875px" src="Untitled%2074.png"/></a></figure></details></li></ul><ul id="f57cd3de-6624-4f71-a227-2e05cff36773" class="toggle"><li><details><summary>File States - Commit</summary><figure id="9035109c-98c7-4e2d-a108-d649f713a9c1" class="image"><a href="Untitled%2075.png"><img style="width:651.96875px" src="Untitled%2075.png"/></a></figure></details></li></ul></details></li></ul><ul id="9003989d-b700-403f-8db4-8ccc470a0ee0" class="toggle"><li><details><summary>Object Originated Tree</summary><ul id="721eb04e-9109-46ee-b4d0-e25b643bfbd4" class="toggle"><li><details><summary>OOP Trees</summary><figure id="c8ceabea-f126-4d97-92f6-e053cdd33414" class="image"><a href="Untitled%2076.png"><img style="width:652px" src="Untitled%2076.png"/></a></figure><ul id="1cff741d-6766-406d-a22c-070dc275110f" class="bulleted-list"><li style="list-style-type:disc">we’ve seen pure OOP stacks</li></ul><ul id="d2d490f8-aabe-4de7-9ec0-e260e18646b5" class="bulleted-list"><li style="list-style-type:disc">lets define another data structure in a pure OOP way</li></ul><ul id="1fbfe3a8-c1ab-44dd-a528-88e3179a7edd" class="bulleted-list"><li style="list-style-type:disc">there are different kinds of tree like data structures, this will just be one example of a tree writin in a pure OOP way</li></ul><ul id="f2b7a922-3c2d-4bbe-b6cd-1c4b505a2153" class="bulleted-list"><li style="list-style-type:disc">if you need a tree in the future, it’ll be different in its own way</li></ul><h3 id="885e8c2a-ca13-47ce-9193-c32713e92df0" class="">Excercise: a tree</h3><ul id="ec9e51e6-baf0-4839-89b4-90423333418e" class="bulleted-list"><li style="list-style-type:disc">in this tree, leaves will contain an item of type E</li></ul><ul id="720fb4a4-bbae-4b80-8fb9-f15efa5c49b7" class="bulleted-list"><li style="list-style-type:disc">there can be an empty and non empty tree</li></ul><figure id="a109a479-7b0c-4902-8953-629f84a06b70" class="image"><a href="Untitled%2077.png"><img style="width:1045px" src="Untitled%2077.png"/></a></figure><h3 id="3992f133-8f46-43f6-b54e-df6df181c6d2" class="">Usage example</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a3956516-9fd4-4d01-ad8c-21e73e9eed77" class="code"><code class="language-Java"> Tree&lt;Integer&gt; empty= Tree.empty();
 System.out.println(empty);//&lt;EMPTY&gt;
 Tree&lt;Integer&gt; base= Tree.leaf(1);
 System.out.println(base);//1
 base= base.and(base);
 System.out.println(base);//(1, 1)
 base= base.and(base);
 System.out.println(base);//((1, 1), (1, 1))</code></pre><figure id="20fce727-dcf2-41bd-aaaf-2c61acde2e39" class="image"><a href="Untitled%2078.png"><img style="width:279.99444580078125px" src="Untitled%2078.png"/></a></figure><figure id="3b045368-259d-4187-9cab-960711f28952" class="image"><a href="Untitled%2079.png"><img style="width:279.9888916015625px" src="Untitled%2079.png"/></a></figure><figure id="633e28d8-b588-46a1-ac95-af473a15c74f" class="image"><a href="Untitled%2080.png"><img style="width:279.9888916015625px" src="Untitled%2080.png"/></a></figure><p id="ac83b274-c522-4da8-8b4a-cf9303c66546" class="">empty tree</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d98a1158-2e13-428a-9f77-b91fde54940b" class="code"><code class="language-Java"> Tree&lt;Integer&gt; empty= Tree.empty();
 System.out.println(empty);//&lt;EMPTY&gt;
 Tree&lt;Integer&gt; base= Tree.leaf(1);
 System.out.println(base);//1
 base= base.and(base);
 System.out.println(base);//(1, 1)
 base= base.and(base);
 System.out.println(base);//((1, 1), (1, 1))
 base= base.and(empty);
 System.out.println(base);//((1, 1), (1, 1))</code></pre><p id="f367c662-4018-4d8f-92ef-fa6118dcec12" class="">streamable tree</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="68fbc410-a719-46e0-afba-6d2374b56529" class="code"><code class="language-Java">Tree&lt;Integer&gt; empty= Tree.empty();
 System.out.println(empty);//&lt;EMPTY&gt;
 Tree&lt;Integer&gt; base= Tree.leaf(1);
 System.out.println(base);//1
 base= base.and(base);
 System.out.println(base);//(1, 1)
 base= base.and(base);
 System.out.println(base);//((1, 1), (1, 1))
 base= base.and(empty);
 System.out.println(base);//((1, 1), (1, 1))
 System.out.println( base.stream().toList() );//[1, 1, 1, 1]</code></pre></details></li></ul><ul id="dc4bcb6c-ed31-4f30-82c7-dccdadf8b3ae" class="toggle"><li><details><summary>Designing OOP Tree Data Structure</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="ae54ecc3-0fdc-4495-a44c-06aee30c4d10"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">we can make OOP data structures by using a 3 phase rule:<ol type="1" id="77def184-a3f2-4873-a8fc-63404b1d04e9" class="numbered-list" start="1"><li>using types to model the shape of the data structure</li></ol><ol type="1" id="1cc26bde-db3e-4a92-99df-817782e34c37" class="numbered-list" start="2"><li>add operations</li></ol><ol type="1" id="63a11afd-e839-4245-98e3-0aafac94241c" class="numbered-list" start="3"><li>clean up the code for conveniency/safety/efficiency</li></ol></div></figure><h1 id="7d692eb2-615d-490d-8936-2b5ce0bf2b42" class="">Phase 1: using <mark class="highlight-yellow_background">types </mark>to model the domain</h1><p id="a5a8180c-c146-467e-b23a-2e204a4c0c89" class="">This is the foundation, if we mess this up, the rest will never work well!</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="64ba1ce3-bd2c-42af-a89c-27406f1de8ec" class="code"><code class="language-Java">interface Tree&lt;E&gt;{} //top level concept

//subtyping to model the sampe
final class EmptyTree&lt;E&gt; implements Tree&lt;E&gt;{} //empty tree

interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{} //onCon tree

record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{} //concrete leaf type

record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left,NonEmptyTree&lt;E&gt; right)
							implements NonEmptyTree&lt;E&gt;{} //concrete parent type</code></pre><figure id="aeb89883-c81c-4388-9cfd-08808bdb547c" class="image"><a href="Untitled%2081.png"><img style="width:279.99444580078125px" src="Untitled%2081.png"/></a></figure><h1 id="df60dbfe-ed4d-46fe-b8ad-ddecbda4b5cb" class="">Phase 2: adding the <mark class="highlight-yellow_background">main operations</mark></h1><h3 id="8e6567b9-6111-42b3-837a-d999caf6ed80" class="">depth operation</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3da500f7-d9fd-4378-b5ce-9c2fdfaf6739" class="code"><code class="language-Java">interface Tree&lt;E&gt;{
 int depth(); //First, define the operation in the top level interface
 //recursive method declaration
}
final class EmptyTree&lt;E&gt; implements Tree&lt;E&gt;{
 public int depth(){ return 0; } //Empty tree has zero depth
 //base case

}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{}
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{
 public int depth(){ return 1; } //Leaf has dept 1
 //base case

}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{
 //The node dept is 1 + the max depth of either child
 public int depth(){ return 1 + Math.max(left.depth(), right.depth()); }
 //recursive/inductive case
}
</code></pre><p id="669b133d-a9f0-4a5b-8ff1-d67ad02aea16" class="">Is ‘depth’ a recursive method?</p><ul id="be5a4931-41d9-4027-bae3-2ea0c9d8db96" class="bulleted-list"><li style="list-style-type:disc">depth is not a well defined thing, it can mean different things</li></ul><ul id="fcf47a9f-ea6d-48be-93a9-301ab4360b4c" class="bulleted-list"><li style="list-style-type:disc">there isn’t an if in this code, that logic is controlled with dynamic dispatch through the different implementations of the depth method on different types</li></ul><h3 id="6056e308-ba67-47e8-a8dc-8da1f70c2100" class="">toString operation</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0d7526e9-781d-48a4-aab3-1748547edc52" class="code"><code class="language-Java">interface Adding operations. -- toString Tree&lt;E&gt;{}
final class EmptyTree&lt;E&gt; implements Tree&lt;E&gt;{
 public String toString(){ return &quot;&lt;EMPTY&gt;&quot;; }
}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{}
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{
 public String toString(){ return label+&quot;&quot;; }
}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{
 public String toString(){ return &quot;(&quot;+left+&quot;, &quot;+right+&quot;)&quot;; }
}
NOTE the 3 lines of code below are all equivalent
 Short &quot;(&quot; + left + &quot;, &quot; + right + &quot;)&quot;
 Longer &quot;(&quot; + this.left + &quot;, &quot; + this.right + &quot;)&quot;
 Longest &quot;(&quot; + this.left.toString() + &quot;, &quot; + this.right.toString() + &quot;)&quot;
Often the ‘recursive call’ happens implicitly or indirectly</code></pre><h3 id="9b33e0e7-621b-465c-bf24-de230b250b53" class="">add operation</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2960e5e1-9df5-4526-95fc-ae7fb9d85774" class="code"><code class="language-Java">interface Tree&lt;E&gt;{
 Tree&lt;E&gt; and(Tree&lt;E&gt; other);
}
final class EmptyTree&lt;E&gt; implements Tree&lt;E&gt;{
 public Tree&lt;E&gt; and(Tree&lt;E&gt; other){ return other; }
}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{
 default Tree&lt;E&gt; and(Tree&lt;E&gt; other){
 if (!(other instanceof NonEmptyTree net)){ return this; }
 return new Node&lt;E&gt;(this, net);
 }
}//Note: return new Node&lt;E&gt;(this, other);would not typecheck!
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{}
 
 Harder:
-Adding an empty tree should
 return the other tree.
-To create a Node we need two
 non empty trees.
 
 Imperative solution:
Use instanceof!
Probably the simple and
good solution here.

</code></pre><figure id="ca500985-b5dd-4536-9073-c668cdfba856" class="image"><a href="Untitled%2082.png"><img style="width:279.99444580078125px" src="Untitled%2082.png"/></a></figure><h1 id="6433b74a-ba90-4597-be07-9a3b92fded3c" class="">Phase 3: adding conveniency/safety/efficiency (<mark class="highlight-yellow_background">clean up</mark>)</h1><p id="d3921a6a-74b9-41fa-8063-21a1476c591d" class="">lets clean up the add method we defined in the previous phase</p><ul id="24450b12-18af-4b2d-a55e-ffa1bf7c6d54" class="bulleted-list"><li style="list-style-type:disc">empty tree should be a singleton pattern</li></ul><ul id="0a96bf14-bfd2-4761-8bbb-01021bd2091d" class="bulleted-list"><li style="list-style-type:disc">left and right return an empty tree when called on an empty tree, could throw an exception instead</li></ul><ul id="192de276-e1e9-49b0-83cb-fd5014f3e9cc" class="bulleted-list"><li style="list-style-type:disc">instead of returning an optional for the label method (when the tree is empty) we can accept a supplier orElse which will return orElse.get() if the tree is empty<ul id="e96eb7bf-f5e3-4306-80b5-3a021ae857f8" class="bulleted-list"><li style="list-style-type:circle">we can define what the get method does on the orElse by overriding the supplier</li></ul><ul id="c370f0b4-eb48-44dc-b1f8-d0f250c205d1" class="bulleted-list"><li style="list-style-type:circle">can return a default case, eg if E is an int, return 0</li></ul><ul id="2717c2c4-73cf-4582-9431-d5e8805e5c41" class="bulleted-list"><li style="list-style-type:circle">could define which exception to throw<code>myTree.label(()-&gt; { throw new Error(); })</code></li></ul></li></ul><ul id="4849e0b3-bb72-4dda-b561-ed5e10f86791" class="bulleted-list"><li style="list-style-type:disc">method return type refinement: node record overrides left and right method to return a NonEmptyTree instead of just a Tree. this works because NonEmptyTree is a subtype of tree</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="08a6951a-ef94-4b5e-81c7-b1025a5814dc" class="code"><code class="language-Java">interface Tree&lt;E&gt; { /*..*/
 static &lt;E&gt; Tree&lt;E&gt; leaf(E label){ return new Leaf&lt;E&gt;(label); }
 @SuppressWarnings(&quot;unchecked&quot;)//Singleton pattern: dirty with generics
 static &lt;E&gt; Tree&lt;E&gt; empty(){ return (Tree&lt;E&gt;)EmptyTree.Instance; }
 default Tree&lt;E&gt; left(){ return empty(); }
 default Tree&lt;E&gt; right(){ return empty(); }
 default E label(Supplier&lt;E&gt; orElse){ return orElse.get(); }
}
enum EmptyTree implements Tree&lt;Object&gt;{//Singleton pattern: dirty with generics
 Instance;
}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt; { /*..*/ }
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{ /*..*/
 public E label(Supplier&lt;E&gt; orElse){ return label; }
}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{
 /*..*/
 public Node{ assert left != null &amp;&amp; right != null; }
}</code></pre><ul id="2a64dd91-7ad1-4fe1-8243-14889e32ae7e" class="toggle"><li><details><summary>step by step</summary><h3 id="d1b080b8-088e-482f-b950-2686d1183d8e" class="">Singleton pattern by hand</h3><figure id="41dd6545-6e33-4237-9774-bf5a84213fd7" class="image"><a href="Untitled%2083.png"><img style="width:652px" src="Untitled%2083.png"/></a></figure><figure id="863e4040-f52a-4637-957c-84693f122f0d" class="image"><a href="Untitled%2084.png"><img style="width:863px" src="Untitled%2084.png"/></a></figure><h3 id="39d017b4-9fb2-48a8-988a-b1157272840b" class="">Adding convenience</h3><figure id="1ee63cf1-824d-4eba-a114-2e6b6a2d41fc" class="image"><a href="Untitled%2085.png"><img style="width:652px" src="Untitled%2085.png"/></a></figure><h3 id="f9b7ded3-5fa6-40a1-8e82-264ee972ac59" class="">Adding safety</h3><figure id="547091a1-6c8a-40a3-913c-db57bd93bcdf" class="image"><a href="Untitled%2086.png"><img style="width:996px" src="Untitled%2086.png"/></a></figure><figure id="86fc54a6-b6c9-4ea9-bbdd-84ea921a9afa" class="image"><a href="Untitled%2087.png"><img style="width:1000px" src="Untitled%2087.png"/></a></figure><figure id="b0a77858-c4f2-498c-89a7-c87f2caa1d17" class="image"><a href="Untitled%2088.png"><img style="width:652px" src="Untitled%2088.png"/></a></figure></details></li></ul><p id="6cb38c3d-1f0e-4ce4-a1af-3f575bf17d93" class="">
</p></details></li></ul><ul id="82034c2d-dcff-4849-b8d7-aeeae4296f05" class="toggle"><li><details><summary>Stream Method</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="2e0db02e-cffa-4b45-8268-5ee41201efd6"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">there are 2 ways to add a stream method to our own OOP data structures<ol type="1" id="cb6f436f-cc69-4d1c-89a6-0b5c284e2255" class="numbered-list" start="1"><li>easy way: build the whole stream (even if we don’t need to visit all nodes because of anyMatch/filter/findFirst) this can be not very efficient</li></ol><ol type="1" id="18f5d0b1-a4c9-4b68-aba0-0846291e5b4a" class="numbered-list" start="2"><li>challenging way: if we have a tree with millions of elements, we can avoid visiting it all just to find that the first leaf was the one we needed</li></ol></div></figure><h1 id="e871d0c0-aa5f-4772-99a1-0ebbe18670fc" class="">Easy way</h1><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fde5f271-3b5a-44ee-95fa-79a5f8a573cc" class="code"><code class="language-Java">interface Tree&lt;E&gt;{
 Stream&lt;E&gt; stream();
}
enum EmptyTree implements Tree&lt;Object&gt;{Instance;
 public Stream&lt;Object&gt; stream(){ return Stream.of(); }
}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{}
record Leave&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{
 public Stream&lt;E&gt; stream(){ return Stream.of(label); }
}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{
 public Stream&lt;E&gt; stream(){ return Stream.concat(left.stream(),right.stream()); }
}
Empty stream
Singleton stream
(not to be confused with the singleton pattern)
Stream concatenation.

the same as the depth method</code></pre><h1 id="2ccbc427-4426-4326-a8ab-5e0be5894a40" class="">Challenging way: “stream from iterator”</h1><figure id="5e08c0a4-acbc-47f4-a975-a43b9d0cf9f0" class="image"><a href="Untitled%2089.png"><img style="width:928px" src="Untitled%2089.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3d0695d0-c236-4c14-b09b-9f3efa474f84" class="code"><code class="language-Java">interface Tree&lt;E&gt; extends Iterable&lt;E&gt;{/*..*/
 default Stream&lt;E&gt; stream(){ return StreamSupport.stream(spliterator(), false); }
}//Iterable gives us ‘spliterator’ for free. We can turn spliterators into streams.
enum EmptyTree implements Tree&lt;Object&gt;{/*..*/
 public Iterator&lt;Object&gt; iterator(){ return Collections.emptyIterator(); }
}//The empty tree has an empty iterator
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{ /*..*/ }
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{/*..*/
 public Iterator&lt;E&gt; iterator(){ return List.&lt;E&gt;of(label).iterator(); }
}//The Leaf has an iterator with a single element
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right) implements
NonEmptyTree&lt;E&gt;{/*..*/
 public Iterator&lt;E&gt; iterator(){ return new TreeIterator&lt;E&gt;(this); }
}//Our custom iterator for the non trivial trees. Here is the hard bit!
class TreeIterator&lt;E&gt; implements Iterator&lt;E&gt;{ /*..*/ }</code></pre><ul id="0cfa70ad-62f9-4a28-87f4-5eef5fa98531" class="bulleted-list"><li style="list-style-type:disc">iterable gives us a splitterator, which can be turned into a stream<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d6480ba6-fa5a-4f95-9ba3-a3aa3c7962f5" class="code"><code class="language-Java">interface Tree&lt;E&gt; extends Iterable&lt;E&gt;{/*..*/
 default Stream&lt;E&gt; stream(){
 return StreamSupport.stream(spliterator(), false);
 }
}</code></pre></li></ul><ul id="e4817782-a337-41c2-9ae7-4c38eb7d3f96" class="bulleted-list"><li style="list-style-type:disc">Collections.emptyLiterator returns an empty iterator, its the same as making an empty list and asking for an iterator from it<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ac34fecc-3f47-4db9-809b-d5850af50be8" class="code"><code class="language-Java">enum EmptyTree implements Tree&lt;Object&gt;{/*..*/
 public Iterator&lt;Object&gt; iterator(){
 return Collections.emptyIterator();
}
}
//The empty tree has an empty iterator
Collections.emptyIterator()
 ==
List.&lt;E&gt;of().iterator()
Empty list → empty iterator</code></pre></li></ul><ul id="c31016f4-7331-45a3-9c88-3d3560d04bce" class="bulleted-list"><li style="list-style-type:disc">there is no singinton iterator, so make a list.of the label and return the iterator for it when implementing iterator for a leaf node (which only contains a single item)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dabd40af-ae3f-4655-b5ac-cee8f9007db9" class="code"><code class="language-Java">record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{/*..*/
 public Iterator&lt;E&gt; iterator(){
 return List.&lt;E&gt;of(label).iterator(); }
}//The Leaf has an iterator with a single element
//Sadly, Java still have no Iterator.of(..) or any
//Collections.singletonIterator(e) method, so we can use
//List.of(label) to get a list of one element and get the
//iterator form it.</code></pre></li></ul><ul id="22dcfe1e-b775-44b6-8fe9-7f44464b473a" class="bulleted-list"><li style="list-style-type:disc">for a node that has children, we need to return a custem iterator we make ourselves to allow the ablity to iterate through the children<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ed13df87-44d9-4bdd-b345-951cb45e8b69" class="code"><code class="language-Java">record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{/*..*/
 public Iterator&lt;E&gt; iterator(){ return new TreeIterator&lt;E&gt;(this); }
}
//Our custom iterator for the non trivial trees.
//Here is the hard bit!
class TreeIterator&lt;E&gt; implements Iterator&lt;E&gt;{ /*..*/ }
Here there is no
escape, we need to
define a custom
iterator type!</code></pre></li></ul><h3 id="1808fef4-64c1-437a-86a5-beffce8cd16e" class="">Our Own Iterator</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="330fe4de-2e1f-4240-b957-bd407e3d1ec0" class="code"><code class="language-Java">class TreeIterator&lt;E&gt; implements Iterator&lt;E&gt;{
 private final ArrayList&lt;NonEmptyTree&lt;E&gt;&gt; stack= new ArrayList&lt;&gt;(32); 
 //32 in the arraylist constructor initlizes the arraylist to allocate \
 //32 items of memory so we don&#x27;t have to reallocate for a while after creation
 public boolean hasNext(){ return !stack.isEmpty(); }
 public TreeIterator(Node&lt;E&gt; n){ stack.add(n); }
 public E next(){
 if (stack.isEmpty()){ throw new NoSuchElementException(); }
 var last= stack.remove(stack.size() - 1);//remove at the end
 return last.itAdvance(stack).label();//next Leaf + grow stack
 }
}
Our custom iterator
Walking on trees step by step
takes some effort (stack)
Non empty stack == more nodes to explore
Start: the top level node is the next node to visit
Should not be called on empty stacks
Get the node that we need to visit next Ask the tree to visit itself! (next slide)</code></pre><p id="2ef73af8-539e-48da-aff8-a0fb5e9be4a5" class="">itAdvance allows the tree to visit itself</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6cc85e30-b4f9-4725-84b0-2160188ca046" class="code"><code class="language-Java">interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{/*..*/
 Leaf&lt;E&gt; itAdvance(ArrayList&lt;NonEmptyTree&lt;E&gt;&gt; stack);
 //next leftmost Leaf + grow stack with all the skipped Nodes
}
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{/*..*/
 public Leaf&lt;E&gt; itAdvance(ArrayList&lt;NonEmptyTree&lt;E&gt;&gt; stack){ return this; }
 //It is a leaf; just return it!
}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{/*..*/
 public Leaf&lt;E&gt; itAdvance(ArrayList&lt;NonEmptyTree&lt;E&gt;&gt; stack){
 stack.add(right);
 //we are traversing this node on the left, so we are ‘skipping’
 //the right one.
 //We add it to the stack to remember about it.
 return left.itAdvance(stack);
 //OO recursive call
 }
}
Our custom iterator
IteratorAdvance: done with dynamic dispatch.
-Navigate on Node,
-return on Leaf</code></pre></details></li></ul><ul id="c3f2041a-bfd0-41d3-a901-c7b6fcf48c0a" class="toggle"><li><details><summary>Tree with no ifs</summary><p id="d96a8497-abf9-444f-84a0-5eda722abad8" class="">Near every line has some<br/>important insights about<br/>learning to code in OO<br/>● How many if/while/for do<br/>we have?<br/>● 1 “if” inside of add<br/>if (!(other instanceof NonEmptyTree net)){ return this; }<br/></p><h1 id="672dc23a-acb1-4901-83ab-c474dc11390e" class="">How to remove that last if?</h1><p id="837433a5-8338-42c8-a022-fc76ec7892ef" class="">
</p></details></li></ul></details></li></ul><ul id="0daac1fd-6e7d-4d7a-86c2-342899001e86" class="toggle"><li><details><summary>Visitor Pattern</summary><ul id="9cbf216f-1beb-4650-8724-e2b058a4cec5" class="bulleted-list"><li style="list-style-type:disc">if you want to add an operation to a composite pattern with many concrete types, you have to provide an implementation for that operation to every concrete type. this can be a lot of code that end up as little pieces across multiple files. -it gets messy<ul id="5ae2714e-ec17-40e9-a083-debaa32d3c5e" class="bulleted-list"><li style="list-style-type:circle">to get around this, we can use the visitor pattern</li></ul></li></ul><ul id="f6c252d7-09e8-436b-ba05-dd791bd9269d" class="bulleted-list"><li style="list-style-type:disc">idea that an operation can become an object<ul id="dd625b58-1c99-4fa8-af17-a321376668ba" class="bulleted-list"><li style="list-style-type:circle">this allows the operation to be passed around</li></ul><ul id="aefe8e77-2f2f-45b9-b299-c5b25d836f0b" class="bulleted-list"><li style="list-style-type:circle">operation as a method is fixed to where it is defined</li></ul></li></ul><ul id="6e58b7cb-f3dd-442b-994a-6262c53bc1f7" class="bulleted-list"><li style="list-style-type:disc">visitor interface is kind of like a supplier of T but as many get methods for each case (instance of our concrete types)</li></ul><ul id="303b23bb-9eb1-4c4e-93f3-08aa971b1266" class="bulleted-list"><li style="list-style-type:disc">we can have an operation as a method that accepts operations (visitors)<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="53c47d21-18ed-4190-8cd1-93d86f5446c9" class="code"><code class="language-Java">interface Node{ 
	&lt;T&gt; T accept(Visitor&lt;T&gt; v); 
}</code></pre></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fedb3ca2-87f8-4be3-94e3-792e6f4fe0b7" class="code"><code class="language-Java">interface Visitor&lt;T&gt;{ T visitXXX(XXX e); ... }
interface Node{ &lt;T&gt; T accept(Visitor&lt;T&gt; v); }
return myNode.accept(new Operation());</code></pre><ul id="da5c2f8e-988e-4bf7-8d1d-d8a5cfc7ec52" class="bulleted-list"><li style="list-style-type:disc">Make a visitor interface with as many visitXXX operations as the<br/>data variants<br/></li></ul><ul id="bfb76de6-40ef-4e3c-bcb1-fdd67fef6e19" class="bulleted-list"><li style="list-style-type:disc">The node interface has an accept method</li></ul><ul id="a78bafa9-e77c-4284-aa73-a6b59ec916c1" class="bulleted-list"><li style="list-style-type:disc">Call the operations using accept</li></ul><ul id="2909d09b-96ea-4638-85b5-692cb88448b0" class="bulleted-list"><li style="list-style-type:disc">either you accept them to come peace or they will come in pieces (one piece in each data variant)</li></ul><ul id="e66b18ff-7bdc-4d6b-afbe-0605878eafe5" class="toggle"><li><details><summary>HTML example</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="de18bf66-d501-4b51-bc15-e4599b93d906" class="code"><code class="language-Java">interface Visitor&lt;T&gt;{
 T visitP(P e);
 T visitDiv(Div e);
 T visitA(A e);
 T visitUl(Ul e);
 T visitLi(Li e);
}
interface Node{ &lt;T&gt; T accept(Visitor&lt;T&gt; v); }
record P(String text) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitP(this); }
}
record Div(List&lt;Node&gt; ns) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitDiv(this); }
}
record A(String href, String text) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitA(this); }
}
record Ul(List&lt;Li&gt; lis) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitUl(this); }
}
record Li(Node node) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitLi(this); }</code></pre><p id="703e54fa-3344-4d1a-ba7b-1a19514c170b" class="">Lots of code, but very repetitive</p><figure id="cfcb8ae8-952d-42bc-a017-9d02b043867f" class="image"><a href="Untitled%2090.png"><img style="width:816px" src="Untitled%2090.png"/></a></figure><h3 id="66492dfa-d310-4259-955e-4e5ce25897a8" class="">Visitors 1, model solution</h3><ul id="a8abbedf-cfb3-413c-98a9-f222f2f3e760" class="bulleted-list"><li style="list-style-type:disc">ToHTML represents an operation as an object</li></ul><ul id="0de9020a-aa5d-486c-9cbf-4f461f2968aa" class="bulleted-list"><li style="list-style-type:disc">it implements visitor of type string, because the ToHTML operation returns a string</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4d823a73-7103-4cf2-bb65-6276f6cd1b69" class="code"><code class="language-Java">class ToHtml implements Visitor&lt;String&gt;{//usage: myNode.accept(new ToHtml())
		public String visitP(P e){ return &quot;&lt;P&gt;&quot;+e.text()+&quot;&lt;/P&gt;&quot;; }
		
		public String visitDiv(Div e){
		 return e.ns().stream().map(ei-&gt;ei.accept(this))
			 .collect(Collectors.joining(&quot;\n&quot;,&quot;&lt;DIV&gt;\n&quot;,&quot;\n&lt;/DIV&gt;&quot;));
		}
		public String visitA(A e){return &quot;&lt;A href=\&quot;&quot;+e.href()+&quot;\&quot;&gt;&quot;+e.text()+&quot;&lt;/A&gt;&quot;;}
		
		public String visitUl(Ul e){
		 return e.lis().stream().map(li-&gt;visitLi(li))
			 .collect(Collectors.joining(&quot;\n&quot;,&quot;&lt;UL&gt;\n&quot;,&quot;\n&lt;/UL&gt;&quot;));
		}
		
		public String visitLi(Li e){ return &quot;&lt;LI&gt;&quot;+e.node().accept(this)+&quot;&lt;/LI&gt;&quot;; }
}</code></pre><h3 id="908ad585-33c4-40a9-b538-03a4d59704f0" class="">Visitors 1, abstract view</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f646db3e-5635-4090-a08e-878596bc2e6a" class="code"><code class="language-Java">class ToHtml implements Visitor&lt;String&gt;{
 (P e)-&gt;&quot;&lt;P&gt;&quot;+e.text()+&quot;&lt;/P&gt;&quot;;
 
 (Div e)-&gt;e.ns().stream().map(ei-&gt;ei.accept(this))
 .collect(Collectors.joining(&quot;\n&quot;,&quot;&lt;DIV&gt;\n&quot;,&quot;\n&lt;/DIV&gt;&quot;));
 
 (A e)-&gt;&quot;&lt;A href=\&quot;&quot;+e.href()+&quot;\&quot;&gt;&quot;+e.text()+&quot;&lt;/A&gt;&quot;;
 
 (Ul e)-&gt;e.lis().stream().map(li-&gt;visitLi(li))
 .collect(Collectors.joining(&quot;\n&quot;,&quot;&lt;UL&gt;\n&quot;,&quot;\n&lt;/UL&gt;&quot;));
 
 (Li e)-&gt;&quot;&lt;LI&gt;&quot;+e.node().accept(this)+&quot;&lt;/LI&gt;&quot;;
 
}</code></pre><ul id="ad6ec33f-a7af-47d6-a12c-890bed108d93" class="bulleted-list"><li style="list-style-type:disc">the main reason to use visitor instead of just a switch? because the operation objects can be extended</li></ul><h3 id="dcf2761a-9556-4cae-8fd8-9e16b86e8e7a" class="">CloneVisitor!</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="40c14a5a-7a1d-47d3-8124-c1af6a06aa75" class="code"><code class="language-Java">class CloneVisitor implements Visitor&lt;Node&gt;{
 public Node visitP(P e){ return e; }

 public Div visitDiv(Div e){
 var ns= e.ns().stream()
 .map(ei-&gt;ei.accept(this))
 .toList();
 return new Div(ns);
 }
 public A visitA(A e){ return e; }

 public Node visitUl(Ul e){
 var lis= e.lis().stream()
 .map(ei-&gt;visitLi(ei))
 .toList();
 return new Ul(lis);
 }
 public Li visitLi(Li e){
 return new Li(e.node().accept(this));
 }
}</code></pre><ul id="88557cda-29ed-4f77-a360-094d963c45b6" class="bulleted-list"><li style="list-style-type:disc">another example of return type refinement, CloneVistor implements Visitor of type Node, so visitDiv should return a Node, but CloneVistor can refine it to return a Div</li></ul><p id="be3d5d86-68f7-4daa-be40-b64ce945c25b" class="">Possibly the most useful visitor: the CloneVisitor! Note how it is doing absolutely nothing! How can it be the most useful one if it does nothing? you can override stuff</p><h3 id="92ab5732-b77d-4239-b9e2-7d06b435cc35" class="">Using CloneVisitor</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8209ddf3-c08f-44f9-8732-0e17931155fa" class="code"><code class="language-Java">//Given the CloneVisitor, how to transform an HTML document
//so that all the text looks tasty?
//We can reuse visitors to define MORE VISITORS!
//usage Node n = myNode.accept(new ToItalian());
class ToItalian extends CloneVisitor{//Solution for Visitors 3
 public Node visitP(P e){ return new P(e.text()+&quot; with PIZZA!!&quot;); }
}</code></pre><p id="f83da53a-b08e-4a7a-86bb-cb6c74dd7f48" class="">The other questions</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eb386bd2-0a73-4f41-9053-8b1513a90d75" class="code"><code class="language-Java">class ReverseDivs extends CloneVisitor{
 public Div visitDiv(Div e){
 var ns= e.ns().stream()
 .map(ei-&gt;ei.accept(this))
 .collect(Collectors.toCollection(ArrayList::new));
 Collections.reverse(ns);
 return new Div(Collections.unmodifiableList(ns));
 }
}
class UlToDiv extends CloneVisitor{
 public Node visitUl(Ul e){
 var ns= e.lis().stream()
 .map(li-&gt;visitLi(li))
 .map(li-&gt;li.node());
 .toList();
 return new Div(ns);
 }
}</code></pre><h3 id="e31a5658-2f82-4ded-851a-34a79f42591d" class="">The power of code reuse!</h3><figure id="340ca19a-fbd3-4086-9f36-ea375e3e7a1a" class="image"><a href="Untitled%2091.png"><img style="width:652px" src="Untitled%2091.png"/></a></figure><h3 id="7ec0c0ea-574a-4c1f-a197-b631f6bc44de" class="">Using CloneVisitor</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="35959faa-e6ac-4998-be0f-d7c4f195c1b3" class="code"><code class="language-Java">//Visitors can have state relative to the visit operation itself
class CloneVisitorInLi extends CloneVisitor{
 protected boolean inLi= false;
 public Li visitLi(Li li){
 boolean oldInLi= inLi;
 inLi = true;
 try{ return super.visitLi(li); }
 finally{ inLi = oldInLi; }
 }
}
class TastyLi extends CloneVisitorInLi{
 public Node visitP(P e){
 if (inLi){ return new P(e.text() + &quot; with PIZZA!!&quot;); }
 return super.visitP(e);
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="039cf285-d576-47a4-b6d4-7d115b467c5a" class="code"><code class="language-Java">class CollectAllText extends CloneVisitor{
 //usage new CollectAllText().collect(myNode)
 public String collect(Node n){ //Slow, it also clone it all.
 var wasted= n.accept(this); //We could define a PropagatorVisitor
 return allText; //that does not clone the data
 }
 String allText= &quot;&quot;;
 public Node visitP(P e){
 allText += e.text();
 return super.visitP(e);
 }
}</code></pre><h3 id="4ee062ae-8dd6-494b-8dde-e31c686f50a0" class="">PropagatorVisitor</h3><ul id="2ad2946d-722c-49e5-81d1-ffc2c1cf0756" class="bulleted-list"><li style="list-style-type:disc">implements visitor of type boolean (so it will return true or false after visiting a concrete type)</li></ul><ul id="36276013-776e-4a8e-9935-aafb97ca238c" class="bulleted-list"><li style="list-style-type:disc">idea is to be able to interrupt the visit early</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="226af7ea-4d40-4ef1-940f-d76cf7b08249" class="code"><code class="language-Java">class PropagatorVisitor implements Visitor&lt;Boolean&gt;{
 //return false == continue the visit
 public Boolean visitP(P e){ return false; }
 public Boolean visitDiv(Div e){ return any(e.ns(),ei-&gt;ei.accept(this)); }
 public Boolean visitA(A e){ return false; }
 public Boolean visitUl(Ul e){ return any(e.lis(),ei-&gt;visitLi(ei)); }
 public Boolean visitLi(Li e){ return e.node().accept(this); }
 
 public static &lt;T extends Node&gt; Boolean any(List&lt;T&gt; ts, Predicate&lt;T&gt; test){
		 return ts.stream().anyMatch(test);//short-circuit on true
 }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bb8e7011-adb2-4dc7-97c3-ddc392d364b2" class="code"><code class="language-Java">class CollectAllText2 extends PropagatorVisitor{
 //better version of CollectAllText
 public String collect(Node n){//usage new CollectAllText2().collect(myNode)
 n.accept(this);
 return allText;
 }
 private String allText= &quot;&quot;;
 public Node visitP(P e){
 allText += e.text();
 return super.visitP(e);
 }
}
class ContainsItalian extends PropagatorVisitor{
 //usage new ContainsItalian().check(myNode)
 public boolean check(Node n){ return n.accept(this); }
 public Node visitP(P e){ return e.text().contains(&quot;Pizza&quot;); }
}
Using PropagatorVisitor
● In some cases, extending PropagatorVisitor is more
efficient than just extending CloneVisitor</code></pre><p id="c1203774-c67a-4ae9-896e-643fb801780f" class="">Learn to see the patterns inside the code<br/>Patterns are all about ways to inject handlers to reuse behavior!<br/></p></details></li></ul><ul id="5c69d0b9-8ddc-4dc1-9a07-f54f46a333f9" class="toggle"><li><details><summary>Tree Example</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9faf79e3-336c-479b-841d-68c246244012" class="code"><code class="language-Java">interface Visitor&lt;E,T&gt;{
 T visitEmpty();
 T visitLeaf(E e);
 T visitNode(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right);
}
interface Tree&lt;E&gt; extends Iterable&lt;E&gt;{
 default &lt;T&gt; T accept(Visitor&lt;E,T&gt; v){ return v.visitEmpty(); }
..}
enum EmptyTree implements Tree&lt;Object&gt;{..}
interface NonEmptyTree&lt;E&gt; extends Tree&lt;E&gt;{..}
record Leaf&lt;E&gt;(E label) implements NonEmptyTree&lt;E&gt;{
 public &lt;T&gt; T accept(Visitor&lt;E,T&gt; v){ return v.visitLeaf(label); }
..}
record Node&lt;E&gt;(NonEmptyTree&lt;E&gt; left, NonEmptyTree&lt;E&gt; right)
 implements NonEmptyTree&lt;E&gt;{
 public &lt;T&gt; T accept(Visitor&lt;E,T&gt; v){ return v.visitNode(left, right); }
..}
class TreeIterator&lt;E&gt; implements Iterator&lt;E&gt;{..}</code></pre></details></li></ul><ul id="da4ce6e4-4365-4041-8e68-7ffb44bb5d1e" class="toggle"><li><details><summary>Operations as Objects</summary><figure id="21d71358-d0d0-480e-8461-fad51d66ff3b" class="image"><a href="Untitled%2092.png"><img style="width:872px" src="Untitled%2092.png"/></a></figure></details></li></ul></details></li></ul><ul id="a8c2adbc-f08a-4a9b-af05-1c3ebf4a7ea6" class="toggle"><li><details><summary>Decorator pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f8daa3d8-615a-4be5-9966-8a653507ec22"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><figure id="d14da2ec-73f8-43d6-bb86-482030258e31" class="image"><a href="Untitled%2093.png"><img style="width:534px" src="Untitled%2093.png"/></a></figure><ul id="0486c194-3346-4446-8d66-bb3e3ad1093d" class="bulleted-list"><li style="list-style-type:disc">decorator decorates exactly one component: has one field of type component that is never null</li></ul><ul id="f8f25c67-7a11-4556-a960-e5de8e44c18b" class="bulleted-list"><li style="list-style-type:disc">kind of like a composite pattern</li></ul></div></figure><ul id="ee170318-db94-4653-9a5b-9a1beed48f7c" class="toggle"><li><details><summary>Scrollbars + Borders Example (use decorator to prevent class explosion)</summary><figure id="ca52aaf4-460c-49ba-85e6-d5a4ef3d15ea" class="image"><a href="Untitled%2094.png"><img style="width:967px" src="Untitled%2094.png"/></a></figure><ul id="d03f8b0b-ba05-455e-8b64-f5f39b136f08" class="bulleted-list"><li style="list-style-type:disc">we want gui components to be able to have scroll bars</li></ul><ul id="679b727c-24b3-4909-899c-ade3c84e9d89" class="bulleted-list"><li style="list-style-type:disc">we don’t want every component to have one, and don’t want the borders to be there either</li></ul><h3 id="b83086e6-6cb0-47a6-96da-749c6e11158f" class="">DON’T class explosion!</h3><ul id="de9242e8-e613-4d56-828f-cd6a89e77b9f" class="bulleted-list"><li style="list-style-type:disc">a way to achieve this is to do class explosion (have a have component type for each case)<ul id="d66ec0a5-6250-4231-8401-e3e66958ba12" class="bulleted-list"><li style="list-style-type:circle">have component with boarder</li></ul><ul id="152fb20e-a8bc-465b-9b66-bfe7f8f04c20" class="bulleted-list"><li style="list-style-type:circle">component with scroll bar</li></ul><ul id="a3a0c1de-2648-4199-bd1e-7d5fdccc44d4" class="bulleted-list"><li style="list-style-type:circle">component with boarder and scroll bar</li></ul><ul id="7bd8b07c-0f66-4685-aff8-881a9aebb8f4" class="bulleted-list"><li style="list-style-type:circle">component with no boarder or scroll bar</li></ul></li></ul><figure id="339737ad-8634-4407-9574-7b4d17462b72" class="image"><a href="Untitled%2095.png"><img style="width:921px" src="Untitled%2095.png"/></a></figure></details></li></ul><ul id="4096fb39-6695-483c-b041-911c728ea9a3" class="toggle"><li><details><summary>Decorator Pattern Ingrediencies </summary><h3 id="8dbee744-a2bf-4f77-9fb2-a5ac0b73884e" class="">Problem</h3><ul id="138cb795-cbaa-4eaa-9ab6-8a9f7fa90540" class="bulleted-list"><li style="list-style-type:disc">We want to enhance behavior of existing classes transparently<ul id="e710d27d-7b83-4179-aeb6-35bfb2b5fd46" class="bulleted-list"><li style="list-style-type:circle">that is without having to explcitly edit the code of those classes</li></ul></li></ul><ul id="dfb11c79-f346-488f-b35c-47a002bbd5f2" class="bulleted-list"><li style="list-style-type:disc">We want to allow behavior to change dynamically</li></ul><ul id="2e3b1f81-f39a-478c-a2b3-13211bb05827" class="bulleted-list"><li style="list-style-type:disc">Behavior crosscuts many different classes</li></ul><h3 id="1d93c3f1-cc58-4d6a-b3a4-381d0eb99ce5" class="">Solution</h3><ul id="1dc6b5c6-fe41-433d-8774-59bc112476f4" class="bulleted-list"><li style="list-style-type:disc">Define component interface for each case</li></ul><ul id="c65adce2-c075-4360-8bdb-1c69a2556438" class="bulleted-list"><li style="list-style-type:disc">Concrete component classes implement this interface</li></ul><ul id="cc8e0a85-aaf6-4a8d-9658-20872dc8ed37" class="bulleted-list"><li style="list-style-type:disc">Decorator classes also implement this interface</li></ul><ul id="4b378be6-7c25-4b87-9b27-b0c81304a88c" class="bulleted-list"><li style="list-style-type:disc">Decorator object manages component object it decorates</li></ul></details></li></ul><ul id="2a7318dc-b906-4fb9-a1c0-5e7704f8b70d" class="toggle"><li><details><summary>Example Code (not Swing)</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ff6ed06f-8ec7-4adf-ba54-dd07267ef2b5" class="code"><code class="language-Java">interface Component{ void paint(int x, int y, int dx, int dy); }
class TextArea implements Component {
 public void paint(int x, int y, int dx, int dy) {
 //draws text in rectangle given by (x,y,x+dx,y+dy)
 }
}
class BorderPanel implements Component {
 private Component delegate;
 public void paint(int x, int y, int dx, int dy) {
 ...// draw 3 pixel box given by (x,y,x+dx,y+dy)
 // draw text area in remaining space
 delegate.paint(x + 3, y + 3, dx - 6, dy - 6);
 }
}</code></pre></details></li></ul><ul id="95d7912f-f34a-49c1-a561-0e387d83ee7b" class="toggle"><li><details><summary>Decorator vs other patterns</summary><ul id="39023078-1696-4fc7-a3a6-40a478d2b83d" class="bulleted-list"><li style="list-style-type:disc">special case of the composite where the composite only contains one child component</li></ul><ul id="d5a22aaf-ce64-44ea-a10e-312a34d1784c" class="bulleted-list"><li style="list-style-type:disc">similar to state, strategy and adapter in the sense that the decorator do a little and delegate to your inner single field</li></ul><ul id="298aa90b-606d-408b-aa60-aa4a25b9d8cf" class="bulleted-list"><li style="list-style-type:disc">Similar also to Chain of responsibility (we may see this later?)</li></ul><ul id="12e6da82-719d-4227-a9e1-5d618eb961fd" class="bulleted-list"><li style="list-style-type:disc">there may be many layers of decorators until we actually reach concrete component<ul id="54a6c7fb-f43a-4272-bdfc-0bfe34ad7e1a" class="bulleted-list"><li style="list-style-type:circle">order of decorators does matter</li></ul></li></ul></details></li></ul><ul id="a8c1f89f-146a-4d50-b222-28e058f02af1" class="toggle"><li><details><summary>Decorator in Swing</summary><h3 id="ead0cf07-bcd8-4187-b0b8-8eed261e4b15" class="">Java Scroll bars</h3><ul id="6fc53b37-61bd-4096-b058-a71c4b9b9ef3" class="bulleted-list"><li style="list-style-type:disc">scroll bars are implementations of decorators</li></ul><ul id="4c3de8d1-9952-4bba-b066-0144c8b6a46c" class="bulleted-list"><li style="list-style-type:disc">scrollTextArea is a decorator that wraps around a JTextArea concrete component</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6bffc402-7c74-43cc-941b-d5cbd8d49da1" class="code"><code class="language-Java">JComponent scrollTextArea(){
	 JTextArea jta= new JTextArea();
	 JScrollPane scrollPane= new JScrollPane(jta,
			 ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS,
			 ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
	 scrollPane.setPreferredSize(new Dimension(100, 100));
	 //prefered size of the internal and external are not unconnected
	 return scrollPane;
}

//Note: we use JScrollPane.setPreferredSize() to set the size of the
//whole component.
//JTextArea.setPreferredSize() would have no effect on an element inside
//a JScrollPane.</code></pre><h3 id="5739a5ea-fb2e-44d2-8cd9-ab72ff128389" class="">Java Borders</h3><ul id="b598be9f-9f0e-4d13-8144-1953f811175d" class="bulleted-list"><li style="list-style-type:disc">boarders in java are not implemented with decorator</li></ul><ul id="64312bb9-ef23-4fc6-b058-d7922f08d7aa" class="bulleted-list"><li style="list-style-type:disc">instead they are implemented with the strategy pattern</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="97cd10e7-5eaa-4b1c-8315-5c13180edc9b" class="code"><code class="language-Java">JComponent borderedButton(){
	 JComponent p= new JPanel();
	 Border b0= BorderFactory.createTitledBorder(&quot;Foo&quot;);
	 p.setBorder(b0);
	 p.add(new JButton(myImg));
	 return p;
}
Strategy pattern, not decorator</code></pre><ul id="9f787f7e-d94d-4988-9fed-ab3d1c5482e5" class="bulleted-list"><li style="list-style-type:disc">we can make different types of boarders in java</li></ul><ul id="c45c783d-827e-4a23-9fb3-5c4b655b81c5" class="bulleted-list"><li style="list-style-type:disc">if we wanted to make a boarder with a title, then we’ll be using the factory and decorator pattern</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dc40a63d-7c26-478c-be43-1f129acebbac" class="code"><code class="language-Java">JComponent borderedButton(){
	 JComponent p= new JPanel();
	 Border b0= BorderFactory.createLoweredBevelBorder();
	 b0= BorderFactory.createTitledBorder(b0,&quot;Bar&quot;);
	 p.setBorder(b0);
	 p.add(new JButton(myImg));
	 return p;
 }
 Strategy pattern + decorator for title borders</code></pre></details></li></ul></details></li></ul><ul id="f900484b-b4a9-402a-b812-0d2287487125" class="toggle"><li><details><summary>A novel perspective on OO</summary><ul id="e11ca6ec-cd03-432a-af52-5b7854eedf1b" class="bulleted-list"><li style="list-style-type:disc">most primitive way of code reuse is copy and pasting</li></ul><ul id="2bcf7e29-4338-4946-86c0-0db2c5e79ee4" class="bulleted-list"><li style="list-style-type:disc">however with this method, changing once copy of the code (eg bug fixing) doesn’t fix the rest</li></ul><ul id="390c79d7-1f23-4b5d-aaa9-aa3ad253fab7" class="bulleted-list"><li style="list-style-type:disc">manual modification of each copy is unfeasible and error prone</li></ul><ul id="7a2efb8b-51af-4be5-af82-cd141493340f" class="bulleted-list"><li style="list-style-type:disc">code reuse and structure is all about <mark class="highlight-blue_background">how changing apart of the code impacts the semantic of other parts of code</mark></li></ul><ul id="adb0be32-fba3-40a1-8319-25db95d32476" class="bulleted-list"><li style="list-style-type:disc">we want to control change</li></ul><ul id="818430f3-9db0-4592-acb4-1517f2aa37f3" class="bulleted-list"><li style="list-style-type:disc">instead of having a bunch of static methods call each other, we can use inheritance </li></ul><ul id="8732b6fd-249f-4a13-b966-a196271b3d8d" class="bulleted-list"><li style="list-style-type:disc">inheritance is a way to control change over method groups<ul id="0476b4c6-7117-470f-a140-4722a0351c94" class="bulleted-list"><li style="list-style-type:circle">instead of having to copy all the methods, we can see a object type as a collection of methods</li></ul></li></ul><ul id="da7b343b-2f41-4d50-8493-daa293e03767" class="bulleted-list"><li style="list-style-type:disc">an instance of an object is a fixed closed point, you know all the methods it has an the semantic of those mutually recursive methods</li></ul><ul id="36910b00-0533-4718-945a-fec799b3d1a6" class="bulleted-list"><li style="list-style-type:disc">a class, interface or record definition is a local open fix point<ul id="31bc4dd3-ac46-48c6-a8b1-2b1b7ed58a7d" class="bulleted-list"><li style="list-style-type:circle">implementation of the methods are still open to change</li></ul></li></ul><ul id="5ca0161a-ccdb-4344-88f0-de373338ccd5" class="bulleted-list"><li style="list-style-type:disc">global fixed point is when you call an abstract method on an interface<ul id="19a5ff5e-66af-4aa4-895c-86b214fb2f7e" class="bulleted-list"><li style="list-style-type:circle">the semantic of that method depends and is open to any concrete implementation of that interface</li></ul></li></ul></details></li></ul><ul id="2b365619-1a8b-44f2-be0b-ddb7114fd57e" class="toggle"><li><details><summary>Modelling: UML</summary><ul id="eca47966-d687-41af-a58d-0f2231987b97" class="toggle"><li><details><summary>Modelling</summary><ul id="1df5210b-1783-4c1b-b415-37d82cfd70bb" class="toggle"><li><details><summary>Why Modeling?</summary><p id="4ed7dcd0-da8a-452a-a3f3-e2e53192467a" class="">what is it good for?</p><h3 id="ba8120fa-2173-41fb-8d07-26802b9a2fef" class="">Planning</h3><ul id="152ded2b-ef50-4af9-a7b5-abed19c6ae74" class="bulleted-list"><li style="list-style-type:disc">anticipating challenges and being prepared</li></ul><ul id="26cf0809-cc5c-468a-8bc1-06bc1988fc0a" class="bulleted-list"><li style="list-style-type:disc">making mistakes while it is cheap<ul id="1c0a3f4f-6c10-4ab9-a914-68516e0d39d5" class="bulleted-list"><li style="list-style-type:circle">cheaper to change things in plans than during development</li></ul></li></ul><h3 id="668ac8ac-89b8-4771-bb11-f98af82f041e" class="">Productivity</h3><ul id="5cd49b54-f6b0-4d1e-8d2e-8843288c38ae" class="bulleted-list"><li style="list-style-type:disc">using notation at a higher level of abstraction<ul id="f04b529d-d21d-4c9f-9ada-f990dc042111" class="bulleted-list"><li style="list-style-type:circle">faster than coding</li></ul><ul id="074bc160-8601-4689-ab43-247e91d289d9" class="bulleted-list"><li style="list-style-type:circle">avoiding errors which are only possible in the low level approach</li></ul><ul id="df29b4e6-3eb9-4f02-a2ca-5669db695080" class="bulleted-list"><li style="list-style-type:circle">detecting errors which are “invisible” at a lower level notation</li></ul></li></ul><h1 id="54f117a7-1d3e-45c0-a280-d6f15e13ae2e" class="">But is modelling faster and more accurate than AI tools like ChatGPT?</h1><ul id="ef9837b8-4727-421c-b914-d316774b4902" class="bulleted-list"><li style="list-style-type:disc">model the code through prompt descriptions and chat generates the code<ul id="bf4b3892-b2ae-44bf-9dec-012a4b72058b" class="bulleted-list"><li style="list-style-type:circle">skips having to model then to code the model, instead the model is just the prompt and the prompt is just converted to code</li></ul></li></ul><ul id="f256a842-155b-4152-9629-19fc5934655c" class="bulleted-list"><li style="list-style-type:disc">too early to tell, there are trade offs, chat isn’t just better</li></ul><h3 id="cbdfc8b2-1cb9-4a46-ae86-d8c768d48d1d" class="">Modelling as in “Planning”</h3><figure id="52852c85-d73f-43a7-a8bd-032ddcc5f019" class="image"><a href="image.png"><img style="width:624.07666015625px" src="image.png"/></a></figure><h3 id="7988adc2-bb38-4f9b-ab42-cef46b4e6ec9" class="">Modelling as in “Playing”</h3><figure id="6febf94e-f44b-437b-8922-ba949ecc3628" class="image"><a href="image%201.png"><img style="width:624.0908813476562px" src="image%201.png"/></a></figure></details></li></ul><ul id="02dd82e6-3e7a-457f-8856-00c33fc18ec8" class="toggle"><li><details><summary>Development Phases</summary><figure id="3ac19d7c-42c2-4c31-851a-308ed27366e6" class="image"><a href="image%202.png"><img style="width:624.0908813476562px" src="image%202.png"/></a></figure><ul id="583ed52b-32d5-416e-93d2-b42ab752609d" class="bulleted-list"><li style="list-style-type:disc">analysis what the end users actually want and what we’re going to build. surveys are done by non technical people.</li></ul><ul id="a5fd0b50-5928-4dff-8971-3425193afd59" class="bulleted-list"><li style="list-style-type:disc">design involves software/solution architects on planning how to actually design the solution/ these people talk to the analysis people and talk to the coders</li></ul><ul id="2133387f-49e8-4932-b4cf-342ffc520ae9" class="bulleted-list"><li style="list-style-type:disc">implementation of the products are the people who actually code/program the product (software engineers)</li></ul><figure id="dd451bee-6b5b-4bb7-9a26-2a3c4e2a3e4b" class="image"><a href="image%203.png"><img style="width:624.07666015625px" src="image%203.png"/></a></figure><ul id="d60f41b3-1fd9-4589-9101-7448dcb644a5" class="bulleted-list"><li style="list-style-type:disc">red part is for modeling and UML</li></ul><h3 id="a2477ef1-0f3b-4920-af96-0bc70aa823d9" class="">Proportion of Phases</h3><figure id="c2ca9bbf-f016-4fce-b12e-5535575c6c89" class="image"><a href="image%204.png"><img style="width:652px" src="image%204.png"/></a></figure><ul id="3cc7a16d-fea2-437e-895e-45d4cea0e3f2" class="bulleted-list"><li style="list-style-type:disc">most of the time is designing and analysis</li></ul></details></li></ul><ul id="0bcce59b-42ff-40c7-b0d8-eedb655f18d2" class="toggle"><li><details><summary>Why not Hack Away?</summary><p id="6a892d13-81f1-49e9-a1fc-e3502edac422" class="">we don’t want to “just do it!” because we want a systematic approach and planning is cheaper</p><figure id="f0a17f53-6898-4aef-bc77-4b47054c606d" class="image"><a href="image%205.png"><img style="width:624.0625px" src="image%205.png"/></a></figure><ul id="83b8c0b9-82e7-4794-96dc-56a13567ddbb" class="bulleted-list"><li style="list-style-type:disc">water fall process of doing analysis, design and implementation often fails</li></ul><ul id="a4e93f62-b160-49e1-b45a-75987b5d3932" class="bulleted-list"><li style="list-style-type:disc">iterative process is better (also known as agile) you don’t do  analysis, design and implementation all at once, you do each step bit by bit</li></ul><ul id="da8e2db0-d175-4873-81c7-90a8e0b6826e" class="bulleted-list"><li style="list-style-type:disc">incremental is similar to iterative, it can be good</li></ul></details></li></ul><ul id="652739e2-23f9-4cc7-a9df-0a8ccf7336bf" class="toggle"><li><details><summary>Development Products</summary><figure id="c28bf390-a6e0-4f8d-8bce-54875d7378d5" class="image"><a href="image%206.png"><img style="width:620px" src="image%206.png"/></a></figure></details></li></ul><ul id="45710d6c-8782-46f7-905d-a359ebcb8c35" class="toggle"><li><details><summary>Development Products</summary><figure id="c0596015-1654-4eea-857e-87793b5ae0f1" class="image"><a href="image%207.png"><img style="width:624.0625px" src="image%207.png"/></a></figure></details></li></ul><ul id="514735d8-3a61-4a72-8f16-6476b7159e83" class="toggle"><li><details><summary>Requirements Analysis Phase</summary><figure id="3c58caa2-449d-4db7-b965-ca156ebd9df4" class="image"><a href="image%208.png"><img style="width:624.0625px" src="image%208.png"/></a></figure></details></li></ul><ul id="56a267ca-d633-41b6-8624-3fc9e171bba5" class="toggle"><li><details><summary>After the “Method Wars”</summary><figure id="e0f02ac4-ed40-4075-8d16-3fdcf8c5b51d" class="image"><a href="image%209.png"><img style="width:473.9772644042969px" src="image%209.png"/></a></figure></details></li></ul></details></li></ul><ul id="6457aaf9-a357-4c40-aef1-6b6639021916" class="toggle"><li><details><summary>Unified Modeling Language (UML)</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="11169266-cbb9-4a19-b304-b539deb107a7"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">a general-purpose, developmental, modeling language in the field of software engineering, that is intended to provide a <mark class="highlight-yellow_background">standard way to visualize the design of a system</mark></div></figure><ul id="83538e8c-e625-49e0-b753-d5df1d154fa4" class="toggle"><li><details><summary>UML Diagram Types</summary><figure id="2cbbb4cc-d59f-4cf0-a0d2-6919a1159c25" class="image"><a href="image%2010.png"><img style="width:624.07666015625px" src="image%2010.png"/></a></figure></details></li></ul><ul id="21a7985f-e987-487c-a325-9153de9eb08b" class="toggle"><li><details><summary>Phases and Models</summary><figure id="b052b956-bba0-4a8a-b186-68babd2d32f3" class="image"><a href="image%2011.png"><img style="width:624.0908813476562px" src="image%2011.png"/></a></figure></details></li></ul><ul id="c001cc53-47c1-48cb-95ea-717cda7f53f3" class="toggle"><li><details><summary>Models and Diagrams</summary><figure id="c8c137ea-2c2a-4776-a72a-50f31c2eb2e7" class="image"><a href="image%2012.png"><img style="width:624px" src="image%2012.png"/></a></figure><figure id="97b99e65-6360-4ddf-b0d4-647abcf76e12" class="image"><a href="image%2013.png"><img style="width:621.9744262695312px" src="image%2013.png"/></a></figure></details></li></ul><ul id="8bcab337-4aa0-456e-9bbf-1e5468adbb5b" class="toggle"><li><details><summary>Domain Modelling Example “Yattzee”</summary><figure id="900d6a65-e661-4743-b988-c1963ddfa4d0" class="image"><a href="image%2014.png"><img style="width:624px" src="image%2014.png"/></a></figure><figure id="d5ec9132-5293-4839-ac68-af91ae891e8b" class="image"><a href="image%2015.png"><img style="width:624.0908813476562px" src="image%2015.png"/></a></figure><figure id="7728931e-0674-4b0b-b7d0-561841d721ea" class="image"><a href="image%2016.png"><img style="width:624px" src="image%2016.png"/></a></figure><figure id="32ff2909-28e1-4e7f-b1d7-18aae43074e5" class="image"><a href="image%2017.png"><img style="width:624.07666015625px" src="image%2017.png"/></a></figure><figure id="a716a027-e68e-4ae8-a360-8ff0a92ee82c" class="image"><a href="image%2018.png"><img style="width:624px" src="image%2018.png"/></a></figure></details></li></ul></details></li></ul><ul id="02140785-ea54-4e15-ab89-0a538d41ecc1" class="toggle"><li><details><summary>Analysis</summary><ul id="ec25911e-8e9b-4386-bc5a-b8724ce45fb0" class="toggle"><li><details><summary>What is Analysis?</summary><ul id="8cca72a0-ee31-4cf0-af14-f665b390bde0" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">requirements </mark>analysis<ul id="32e3d0f3-0464-487c-951f-81e7f1b76662" class="bulleted-list"><li style="list-style-type:circle">enquire about user needs: work on the right problem</li></ul><ul id="0cfa5d4b-55cb-4029-aa3c-43b52830fb35" class="bulleted-list"><li style="list-style-type:circle">explore possible services </li></ul></li></ul><ul id="e305bcce-938c-49ac-b02e-cbb3778b0014" class="bulleted-list"><li style="list-style-type:disc"><mark class="highlight-yellow_background">domain </mark>analysis<ul id="1d544940-bdc6-43c9-8d34-fca24e86944f" class="bulleted-list"><li style="list-style-type:circle">develop domain model: work close to the user</li></ul><ul id="db097d8c-a05f-4762-a4ef-9f6e967cf8df" class="bulleted-list"><li style="list-style-type:circle">validate system understanding: understand do the users want a certain thing</li></ul><ul id="b5166a6a-f1af-4175-be0e-61c8270b74b3" class="bulleted-list"><li style="list-style-type:circle">validate requirements</li></ul></li></ul></details></li></ul><ul id="71afef1d-0b20-4eba-a60e-b5ac3b9aa412" class="toggle"><li><details><summary>Why Analysis?</summary><p id="0441ae2b-6efd-45cc-aeec-c7a9a86b30db" class="">Identifying the <mark class="highlight-yellow_background">system requirements is hard</mark>, because of</p><p id="3b180745-9b54-40fb-b8ef-26eb779aa29a" class="">● “Tech talk” &amp; domain “slang”<br/>● expert knowledge is difficult to access<br/>● implicit assumptions are often wrong<br/>● future system users have partial ideas only<br/>● never ending appetite for features<br/></p></details></li></ul><ul id="574413f2-659b-499a-b1a7-ffe725617a66" class="toggle"><li><details><summary>Textual Analysis</summary><ol type="1" id="e29cdd21-a7c2-4626-bfd8-436fadd86eb0" class="numbered-list" start="1"><li><mark class="highlight-yellow_background">read and understand</mark> documents</li></ol><ol type="1" id="172f1cc1-422f-4ebf-a3f3-c9ab7130dbf4" class="numbered-list" start="2"><li><mark class="highlight-yellow_background">underline </mark>noun and verb phases<ol type="a" id="6f7aa623-082c-4d25-bf55-e08150de1267" class="numbered-list" start="1"><li>convert to <mark class="highlight-yellow_background">singular</mark></li></ol></li></ol><ol type="1" id="388b287c-27d9-4d60-a046-1154b1f379ec" class="numbered-list" start="3"><li>sort into <mark class="highlight-yellow_background">3 categories</mark><ol type="a" id="7ab67953-33c3-4379-925d-0de8f192333e" class="numbered-list" start="1"><li><mark class="highlight-yellow_background">obvious </mark>things (classes) and actions (behavior)</li></ol><ol type="a" id="117e7627-b072-463b-b154-ee2f7d7d11e1" class="numbered-list" start="2"><li><mark class="highlight-yellow_background">unsure </mark><ol type="i" id="7d66bf06-d275-4166-9db6-6fbcf459a183" class="numbered-list" start="1"><li>part thing?</li></ol><ol type="i" id="820e9f69-abaf-4128-8e40-7ab47b206225" class="numbered-list" start="2"><li>potential action?</li></ol></li></ol><ol type="a" id="dd1079d0-0ef7-456b-8068-c4bd3ec4217a" class="numbered-list" start="3"><li><mark class="highlight-yellow_background">obviously </mark>irrelevant</li></ol></li></ol><ol type="1" id="21850544-623a-4a4f-bc82-1cbbabfc7c89" class="numbered-list" start="4"><li>work through a and b to produce candidates<ol type="a" id="07f1bb3c-076b-4833-9097-0d7f66f0042c" class="numbered-list" start="1"><li>consolidate things, actions and naming</li></ol></li></ol></details></li></ul><ul id="3513633e-c465-4641-9ecc-66887b6cb596" class="toggle"><li><details><summary>Textual Analysis Example</summary><h3 id="a8d7975d-9336-4d21-8ba3-bf5cb89b0ae1" class="">Example</h3><figure id="5dc0f5e0-f3df-44bf-a0c8-09bd252b6049" class="image"><a href="image%2019.png"><img style="width:624.07666015625px" src="image%2019.png"/></a></figure><figure id="6ea68c95-832f-486a-9967-6a0739673571" class="image"><a href="image%2020.png"><img style="width:624.0625px" src="image%2020.png"/></a></figure><h3 id="5370ddba-a595-4ea3-a77d-8fe2296dcd5f" class="">Use Case Relationships</h3><ul id="6bede5ed-5794-4d3a-8863-6dd515a973d1" class="bulleted-list"><li style="list-style-type:disc">using (include)<ul id="5de51952-2f5b-4c81-bb53-92321c5df353" class="bulleted-list"><li style="list-style-type:circle">a common subpart is used within a containing use case</li></ul></li></ul><ul id="48b5cddc-b9ed-4d3e-bb23-c848fcc51b62" class="bulleted-list"><li style="list-style-type:disc">Extending (extend)<ul id="5d4d7a12-5de1-4c70-886f-00aae98c78a0" class="bulleted-list"><li style="list-style-type:circle">a variant or exceptional situation extends the normal case</li></ul></li></ul><ul id="c46c9dcc-ce32-46d2-a901-2b42d0807391" class="bulleted-list"><li style="list-style-type:disc">Generalization<ul id="e48c5f6d-731f-4020-8749-cbc0369d294c" class="bulleted-list"><li style="list-style-type:circle">several special use cases are generalised to a common general description </li></ul></li></ul><figure id="a20c3c08-2b74-43ec-8de7-3ddfe6b1160f" class="image"><a href="image%2021.png"><img style="width:624.0482788085938px" src="image%2021.png"/></a></figure><h3 id="c146966f-b87d-48ec-bd86-7f77ed4d7211" class="">Use Case Description</h3><ul id="f333f24d-0d5b-4416-9c69-aedeb087ba82" class="bulleted-list"><li style="list-style-type:disc">lead item<ul id="1112072e-0eac-4101-9a44-4c8967609514" class="bulleted-list"><li style="list-style-type:circle">identify user</li></ul><ul id="c2107ca1-f1b1-4d5c-9325-3fda232818bc" class="bulleted-list"><li style="list-style-type:circle">identifiy title</li></ul><ul id="2d58dd8d-1e79-4f0e-89ff-6a9da828411c" class="bulleted-list"><li style="list-style-type:circle">has title been reserved by user?<ul id="ebc3f906-a77d-4ba6-8efa-35082a30b74c" class="bulleted-list"><li style="list-style-type:square">yes → remove reservation</li></ul></li></ul><ul id="a19446ee-928f-4569-bb94-9983fb8abba7" class="bulleted-list"><li style="list-style-type:circle">create a loan record for lent item</li></ul><ul id="cd41bdb7-4d39-4dbe-ab98-fc5dc2d9f5dd" class="bulleted-list"><li style="list-style-type:circle">lend item to user</li></ul></li></ul><h3 id="77c33d37-85be-48c0-a2d2-db1eebc7b004" class="">Activity Diagram</h3><figure id="d2f60480-5395-46fa-87e3-fb8c244884be" class="image"><a href="image%2022.png"><img style="width:652px" src="image%2022.png"/></a></figure><h3 id="9ab50230-af3f-4503-8108-32620ac7c9d6" class="">The Big Picture</h3><figure id="1df6a7aa-e89c-4322-9abb-9267c2cfcfd5" class="image"><a href="image%2023.png"><img style="width:652px" src="image%2023.png"/></a></figure></details></li></ul><ul id="0e1233f2-b2c4-4455-b52e-6829a65dcf53" class="toggle"><li><details><summary>Another Example</summary><figure id="3594d117-905e-4854-b450-f4fd61004822" class="image"><a href="image%2024.png"><img style="width:624px" src="image%2024.png"/></a></figure><figure id="0a41a096-a8e7-4b5c-976b-1ce87195ce65" class="image"><a href="image%2025.png"><img style="width:624px" src="image%2025.png"/></a></figure><h3 id="8f972962-41ec-4813-a4a1-87d01acad0c1" class="">Results</h3><figure id="90bd0704-86c8-4e54-b8f9-058c03ce202d" class="image"><a href="image%2026.png"><img style="width:624.0625px" src="image%2026.png"/></a></figure><h3 id="ec794db5-2886-42ef-a64b-b96b67b21539" class=""><strong>Consolidation</strong></h3><figure id="3ec34a4e-accd-4802-a8db-059668bcda58" class="image"><a href="image%2027.png"><img style="width:624px" src="image%2027.png"/></a></figure><figure id="0f50d6f6-6519-4afc-ab55-bcd24038ef67" class="image"><a href="image%2028.png"><img style="width:624.07666015625px" src="image%2028.png"/></a></figure><h3 id="7b6148d2-db88-4f43-a1af-1d8628c11ffd" class=""><strong>Specialisation (a.k.a. inheritance)</strong></h3><figure id="40604ff2-0863-4b3f-b54b-fd947796a7e0" class="image"><a href="image%2029.png"><img style="width:624px" src="image%2029.png"/></a></figure></details></li></ul><ul id="0b91bcbc-e09f-457a-9b5c-916b23353666" class="toggle"><li><details><summary>Class/Responsibilities/Collaborators</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1cb653d6-c869-4366-97ad-40bcb9bab465"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><figure id="5a1ce6d6-c6f9-444b-a9cd-9ddb5ecb842c" class="image"><a href="image%2030.png"><img style="width:562px" src="image%2030.png"/></a></figure></div></figure><h3 id="0070a67c-4afb-4d2b-8b06-66896d2453e1" class=""><strong>CRC Cards: Finding Concepts</strong></h3><figure id="65d6a54b-baa8-4128-885e-cd17584bea4e" class="image"><a href="2e94c1ba-adc5-4ab8-ab0c-ceed2eec1c86.png"><img style="width:675.3666312433581px" src="2e94c1ba-adc5-4ab8-ab0c-ceed2eec1c86.png"/></a></figure><figure id="60274989-3b7d-4368-83bd-fde64e7a7fb1" class="image"><a href="image%2031.png"><img style="width:624px" src="image%2031.png"/></a></figure></details></li></ul></details></li></ul><ul id="1141a926-7344-808c-9f19-f92083ddcdb4" class="toggle"><li><details><summary>Writting UML</summary><ul id="1141a926-7344-80cf-9047-c875f80007dc" class="toggle"><li><details><summary>Class specification</summary><h3 id="1141a926-7344-8027-bf4d-f05b91bd93b4" class="">Class specification</h3><figure id="1141a926-7344-80b0-af84-dcbd01fd6fc0" class="image"><a href="image%2032.png"><img style="width:651.96875px" src="image%2032.png"/></a></figure></details></li></ul><ul id="1141a926-7344-809d-8581-d0cfe1e7c315" class="toggle"><li><details><summary>Attributes</summary><h3 id="1141a926-7344-800b-be90-fc99cd64e7a1" class="">Attributes </h3><figure id="1141a926-7344-80b7-b9f8-ee9e66994923" class="image"><a href="image%2033.png"><img style="width:651.984375px" src="image%2033.png"/></a></figure><figure id="1141a926-7344-8029-965b-d08cc81814bd" class="image"><a href="image%2034.png"><img style="width:2175px" src="image%2034.png"/></a></figure></details></li></ul><ul id="1141a926-7344-8033-9443-f9cca6e8921a" class="toggle"><li><details><summary>Association</summary><h3 id="1141a926-7344-8072-8f3c-dffb761f2882" class="">Association </h3><figure id="1141a926-7344-807c-900f-f0c90373a9a2" class="image"><a href="image%2035.png"><img style="width:651.984375px" src="image%2035.png"/></a></figure><figure id="1141a926-7344-809b-8180-e33d6d4ed74d" class="image"><a href="image%2036.png"><img style="width:651.984375px" src="image%2036.png"/></a></figure><h3 id="1141a926-7344-8025-84ed-e1a194d3f3dc" class="">Association Ends</h3><figure id="1141a926-7344-8003-a29e-c3dd60c6f2e4" class="image"><a href="image%2037.png"><img style="width:651.984375px" src="image%2037.png"/></a></figure></details></li></ul><ul id="1141a926-7344-806d-b46f-fcaecc9666bb" class="toggle"><li><details><summary>Attributes vs Association </summary><h3 id="1141a926-7344-8010-a81a-f7d145faf28e" class="">Attributes vs Association </h3><figure id="1141a926-7344-806d-8015-ca483719c101" class="image"><a href="image%2038.png"><img style="width:651.984375px" src="image%2038.png"/></a></figure></details></li></ul><ul id="1141a926-7344-8058-8b03-c5003fa60e47" class="toggle"><li><details><summary>Multiplicities </summary><h3 id="1141a926-7344-803f-b116-ea985bf736d3" class="">Multiplicities </h3><ul id="1141a926-7344-80a8-a219-efe5ffadca0b" class="bulleted-list"><li style="list-style-type:disc">A has an association with class B</li></ul><ul id="1141a926-7344-8061-8098-c2175956c626" class="bulleted-list"><li style="list-style-type:disc">A can have 0 or more Bs</li></ul><ul id="1141a926-7344-807b-bc27-ce537847a241" class="bulleted-list"><li style="list-style-type:disc">B can have 1 to 2 As max</li></ul><figure id="1141a926-7344-8070-81a8-d6b215238119" class="image"><a href="image%2039.png"><img style="width:384px" src="image%2039.png"/></a><figcaption>object level is an object diagram, not class diagram<br/>object diagram is not assesed<br/></figcaption></figure></details></li></ul><ul id="1141a926-7344-802b-9278-c85415ddd1ec" class="toggle"><li><details><summary>Aggregation vs Composition  </summary><figure id="1141a926-7344-8051-991f-e7b70bb76fad" class="image"><a href="image%2040.png"><img style="width:623.984375px" src="image%2040.png"/></a></figure></details></li></ul><ul id="1141a926-7344-80e0-b0e7-ede84e2716df" class="toggle"><li><details><summary>Types of Diagrams</summary><ul id="1141a926-7344-8000-b87d-f9a17bf36a6c" class="bulleted-list"><li style="list-style-type:disc">class diagrams</li></ul><ul id="1141a926-7344-80fe-8180-f700ac927a9d" class="bulleted-list"><li style="list-style-type:disc">object diagrams</li></ul><ul id="1141a926-7344-808f-bc13-ef08044690f9" class="bulleted-list"><li style="list-style-type:disc">state diagrams</li></ul><ul id="1141a926-7344-80b6-bb71-ee180fcffc50" class="bulleted-list"><li style="list-style-type:disc">sequence diagrams</li></ul><ul id="1141a926-7344-80bd-ada0-de5e72727fdb" class="bulleted-list"><li style="list-style-type:disc">communication diagrams</li></ul></details></li></ul><ul id="1141a926-7344-80fa-848a-f9be0345b6df" class="toggle"><li><details><summary>Questions Examples</summary><figure id="1141a926-7344-80d1-a2d2-c79b03012c6b" class="image"><a href="image%2041.png"><img style="width:623.984375px" src="image%2041.png"/></a></figure><figure id="1141a926-7344-80f2-886d-f9815a76c884" class="image"><a href="image%2042.png"><img style="width:623.984375px" src="image%2042.png"/></a></figure><figure id="1141a926-7344-80e9-bd7e-ddf9d7461903" class="image"><a href="image%2043.png"><img style="width:623.96875px" src="image%2043.png"/></a></figure></details></li></ul><p id="1141a926-7344-80f1-855e-f3591671c7da" class="">
</p></details></li></ul><p id="e749c38a-60ac-45fd-a381-e72150830f93" class="">
</p></details></li></ul><ul id="b948ecba-ce83-40eb-b33b-01f7783b910a" class="toggle"><li><details><summary>Antipatterns, Code Smells, Refactor</summary><ul id="77a79711-e4c6-4835-9c32-c8fd24da613f" class="toggle"><li><details><summary>IDE tricks</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="111d409c-8f3e-4464-bce3-08fdca4978c7"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="2f5980e8-52a7-4ae6-8549-308c767c4671" class="">use tricks in your id and type system to code faster</p></div></figure><figure id="81d50908-37b7-4273-bc95-ffc2a0c0109f" class="image"><a href="image%2044.png"><img style="width:652px" src="image%2044.png"/></a></figure><figure id="19d94a55-b86a-463a-ac6a-39915840caf4" class="image"><a href="image%2045.png"><img style="width:652px" src="image%2045.png"/></a></figure><figure id="45b2de3f-3051-4197-b92e-b068f76ae210" class="image"><a href="image%2046.png"><img style="width:652px" src="image%2046.png"/></a></figure></details></li></ul><ul id="27c764a8-c2e1-4976-b804-1d171b28fa8f" class="toggle"><li><details><summary>Refactoring</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d6d8fc44-6e81-45cf-afad-9148a29a91e8"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="c79d152a-cace-4b46-84b6-0fb2762814fa" class="">change code after writting it and getting it to work</p></div></figure><figure id="29d80106-8490-4e25-a804-9cae6577659a" class="image"><a href="image%2047.png"><img style="width:652px" src="image%2047.png"/></a></figure><ul id="d28264be-1409-47aa-a03d-35f42aabd581" class="bulleted-list"><li style="list-style-type:disc">write all your classes in the same file, then refactor later to give them their own file</li></ul><ul id="3ad5f8ad-347b-478f-901b-47bca882e8af" class="bulleted-list"><li style="list-style-type:disc">give meaningful but not thought out name for classes and improve the names later by refactoring\</li></ul><h3 id="6f2543de-8bff-463a-9363-92c594266c73" class="">Manual Refactoring</h3><ul id="23983f03-f368-4ac8-ac8a-7c2fd3346c62" class="bulleted-list"><li style="list-style-type:disc">after getting your code to work, read your code and them optimize it</li></ul><ul id="1f81e612-2c74-4d6d-aef4-689b98dafe22" class="bulleted-list"><li style="list-style-type:disc">optimize it by removing code smells:<ul id="ca4a53f9-ef6b-450b-8ba8-a36f12223a95" class="bulleted-list"><li style="list-style-type:circle">no dead code</li></ul><ul id="51757210-0904-466f-a3b4-5299e6f806fa" class="bulleted-list"><li style="list-style-type:circle">no unused local variables</li></ul><ul id="7339918c-1bd9-48b1-983c-e1e48960cc59" class="bulleted-list"><li style="list-style-type:circle">no duplicated code</li></ul></li></ul><ul id="88ebc550-2dec-46ea-a373-34aa239447d4" class="bulleted-list"><li style="list-style-type:disc">make sure code is consistent</li></ul><ul id="1a7742db-78bc-42c2-9176-ba4a65e4d9d9" class="bulleted-list"><li style="list-style-type:disc">refactor structure of the code<ul id="ab155cf3-5e1a-4f7f-b415-0ff75f7874d9" class="bulleted-list"><li style="list-style-type:circle">split class into 2 or 4</li></ul><ul id="cf2ceeb5-2e0f-4eca-95e2-0fd8d40cef9d" class="bulleted-list"><li style="list-style-type:circle">merge small classes into a bigger one</li></ul></li></ul><figure id="d54df689-cad0-453d-98fb-4521407c7379" class="image"><a href="image%2048.png"><img style="width:652px" src="image%2048.png"/></a></figure></details></li></ul><ul id="dc3524b9-c436-447a-8ca7-4114be7ae787" class="toggle"><li><details><summary>Code Smells</summary><h3 id="ada0f0e3-f65a-49ee-9a06-894cdfd93fdc" class="">Smells: inexperienced programmer</h3><figure id="b256eb6d-9fc6-4306-8799-336098029b67" class="image"><a href="image%2049.png"><img style="width:652px" src="image%2049.png"/></a></figure><h3 id="d648c3a2-405b-4363-aed3-f83743c15637" class="">Smells: no OO</h3><figure id="6a7727de-d1f8-45e4-87bf-adc9f6a2f732" class="image"><a href="image%2050.png"><img style="width:652px" src="image%2050.png"/></a></figure></details></li></ul><ul id="af66380d-99c3-472f-8027-97073103a4e9" class="toggle"><li><details><summary>Antipatterns</summary><ul id="15125106-b663-4203-a4d7-cdbf6b364738" class="toggle"><li><details><summary>Big methods</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d508fd79-1abc-4108-bb3d-92878770c629"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="5cb9920c-ab95-4349-be80-e5266f716258" class="">● Sometimes we can divide them in sub methods..<br/>● Sometimes we need to lift them to classes!<br/></p></div></figure><h3 id="dbc471a4-80cc-4e7f-a982-39558aa155df" class="">code le bad</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ea8b5bc-6182-4fcb-9de2-65d2a08a2c63" class="code"><code class="language-Java">enum Kind{ Carbs, Meat, Vegetables, Fruit };
record Ingradient(String name, Kind kind, int grams){}
class ItalianLunch{
 List&lt;List&lt;Ingradient&gt;&gt; prepareLunch(List&lt;Ingradient&gt; is, int guests){
 List&lt;Ingradient&gt; first = new ArrayList&lt;&gt;();
 int firstTot = 0;
 List&lt;Ingradient&gt; second = new ArrayList&lt;&gt;();
 int secondTot = 0;
 List&lt;Ingradient&gt; dessert= new ArrayList&lt;&gt;();
 int dessertTot = 0;
 //base
 List&lt;Ingradient&gt; left1= new ArrayList&lt;&gt;();
 for (var i:is){
 if (i.kind() == Kind.Carbs &amp;&amp; firstTot &lt; 300 * guests){
 first.add(i); firstTot += i.grams(); continue;
 }
 if(i.kind() == Kind.Meat &amp;&amp; secondTot &lt; 200 * guests){
 second.add(i); secondTot += i.grams(); continue;
 }
 if(i.kind() == Kind.Fruit &amp;&amp; dessertTot &lt; 500 * guests){
 dessert.add(i); dessertTot += i.grams(); continue;
 }
 left1.add(i);
 }
 
 //sauces for pasta, meat if possible
 List&lt;Ingradient&gt; left2= new ArrayList&lt;&gt;();
 for (var i:left1){
 if (i.kind() == Kind.Meat &amp;&amp; firstTot &lt; 500 * guests){
 first.add(i); firstTot += i.grams();
 }
 else { left2.add(i); }
 }

 //vegetables if needed
 List&lt;Ingradient&gt; left3= new ArrayList&lt;&gt;();
 if (firstTot &lt; 500 * guests){
 for (var i:left2){
 if (i.kind() == Kind.Vegetables &amp;&amp; firstTot &lt; 600 * guests){
 first.add(i); firstTot += i.grams();
 }
 else { left3.add(i); }
 }
 }
 for(var i:left3){//now the side for the meat
 if(i.kind() == Kind.Vegetables &amp;&amp; secondTot &lt; 500 * guests){
 second.add(i); secondTot += i.grams();
 }
 }
 return List.of(first,second,dessert);
 }</code></pre><h3 id="eb0b6eb5-1dfa-41dd-82da-2297861d67ae" class="">Idiomatic way: OO</h3><ul id="9dd1878b-5183-4943-b472-5eb6e0ecb848" class="bulleted-list"><li style="list-style-type:disc">turn a method into a class</li></ul><ul id="650b5b8d-dd3d-463f-8193-a0ac11686953" class="bulleted-list"><li style="list-style-type:disc">a complex return type to an instance of that class</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4381d524-1fa2-4181-bb46-c0aaaf32eedb" class="code"><code class="language-Java">interface HandleIngradient{ boolean used(Ingradient i); }
class BetterItalianLunch{
 class Plate{
 List&lt;Ingradient&gt; is= new ArrayList&lt;&gt;();
 int grams= 0;
 boolean mayAdd(Ingradient i, Kind k, int gramsLimit){
 if (grams &gt; gramsLimit * guests || i.kind() != k ) { return false; }
 is.add(i);
 grams += i.grams();
 return true;
 }
 }
 public final Plate first = new Plate();
 public final Plate second = new Plate();
 public final Plate dessert= new Plate();
 private List&lt;Ingradient&gt; left= new ArrayList&lt;&gt;();
 private int guests;
 private void handleRemaining(HandleIngradient h){ left.removeIf(h::used); }
 ...
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6e421497-30d5-450f-859c-538221ae078b" class="code"><code class="language-Java">//The method is now a constructor!
 BetterItalianLunch(List&lt;Ingradient&gt; is, int guests){
 left.addAll(is);
 this.guests= guests;
 base();
 sauce();
 side();
 }
 void base(){
 handleRemaining(i-&gt;
 first .mayAdd(i,Kind.Carbs,300)
 || second .mayAdd(i,Kind.Meat, 200)
 || dessert.mayAdd(i,Kind.Fruit,500) );
 }
 void sauce(){
 handleRemaining(i-&gt;first.mayAdd(i,Kind.Meat,500));
 if (first.grams &gt;= 500){ return; }
 handleRemaining(i-&gt;first.mayAdd(i,Kind.Vegetables,600));
 }
 void side(){
 handleRemaining(i-&gt;second.mayAdd(i,Kind.Vegetables,500));
 }</code></pre><p id="b554d340-1658-4020-afec-a6ffc5f6aca6" class="">
</p></details></li></ul><ul id="a00541be-d4a7-4d0a-ae0b-74fbf61365ef" class="toggle"><li><details><summary>Returning tuples</summary><blockquote id="20cb7c7f-534f-407f-9ddc-ecf4a2439cac" class="">“oh i have to return many results, return them as a tuple!</blockquote><h3 id="35d16b75-182b-4409-9b00-fc15857e3153" class="">Example 1</h3><p id="c59ecf86-6b4e-4229-b881-087ecae86a2b" class="">Given a String count how many digits and how many spaces in a single pass</p><ul id="7dd20f16-0340-4924-bc2d-bed495e527d4" class="bulleted-list"><li style="list-style-type:disc">we need to return seconds, minutes and hours, return each of them in a tuple!<ul id="5a81ab1a-2095-484b-9079-5ef11ccf437a" class="bulleted-list"><li style="list-style-type:circle">no, return a type that holds those values</li></ul></li></ul><ul id="ccc77caf-7e65-47e2-b988-e883c1e1dbfa" class="bulleted-list"><li style="list-style-type:disc">a method with a difficult return type is now a constructor for a new type </li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d13ac4f6-fece-4f0f-b2dd-5f0b8b0e3637" class="code"><code class="language-Java">//Given a String count how many digits and how many spaces
//in a single pass
final class StringInfo{
 int digits= 0;
 int spaces= 0;
 StringInfo(String s){
 s.chars().forEach(c-&gt;{
 if(Character.isDigit(c)){digits += 1;}
 if(Character.isWhitespace(c)){spaces += 1;}
 });
 }
}
//Sometimes we think we need a method that returns more than one result
//We are wrong, we just need a class with fields.
//Idiomatic way/Pattern: the Info class!
//Make a constructor instead of a method.</code></pre></details></li></ul><ul id="37331a27-0495-4a2e-91a7-b2be537f8bcf" class="toggle"><li><details><summary>Print outs</summary><ul id="ea301715-2f40-4c69-92dc-3a7cd9c06f71" class="bulleted-list"><li style="list-style-type:disc">instead of printing and then using your human eye to check if it meets the condition …</li></ul><ul id="43180d46-23b0-4090-89c1-fa2282643aa9" class="bulleted-list"><li style="list-style-type:disc">just write the condition in the code with asserts</li></ul><figure id="5004a43c-3bb3-4fe3-880f-5e1b0a38fd0d" class="image"><a href="image%2051.png"><img style="width:624px" src="image%2051.png"/></a></figure></details></li></ul><ul id="3f8df1c1-3f32-4aa1-af01-cfa2c1e88bbe" class="toggle"><li><details><summary>manual accumulation</summary><h1 id="b9e0fa96-57a5-4786-bf40-528690441a2b" class="">Returning boolean</h1><h3 id="a4239ac0-28e8-4851-b585-96a3515e28b2" class="">code le bad</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="419dac96-ae18-4380-89ad-b550ff8d9337" class="code"><code class="language-Java">record Person(String name, int age){}
 ...
 List&lt;Person&gt;ps= ...;
 ...
 //bad way
 boolean found= false;
 for (Person p : ps){
 if (p.name().equals(&quot;Bob&quot;) &amp;&amp; p.age() &gt; 30){
 found = true;
 break;
 }
 }</code></pre><h3 id="22bf4b35-62f1-427e-a5ec-902843bdc9b4" class="">better way</h3><p id="05f8a276-8115-4bc8-86c0-f4c33cbb9872" class="">assign a variable a stream</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fe700013-a0ba-4ba6-840b-7156604b937f" class="code"><code class="language-Java">//better
 boolean found2= ps.stream()
	 .anyMatch(p-&gt;p.name().equals(&quot;Bob&quot;) &amp;&amp; p.age() &gt; 30);</code></pre><h3 id="241bfce7-54df-458f-906a-d10b0687ffca" class="">even better way</h3><p id="cc716033-3bc8-4e70-a58d-d1156e5d5816" class="">make a method that returns true or false that is able to be overridden</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="16433bf7-9048-44ef-953f-22f2dbbe69b2" class="code"><code class="language-Java">boolean test(Person p) { return p.name().equals(&quot;Bob&quot;) &amp;&amp; p.age() &gt; 30; }

//fantastic for assertions!
 assert ps.stream().anyMatch(p-&gt;test(p)):
 &quot;BreakPointHere!&quot;;
 //variants: .allMatch, .noneMatch</code></pre><h1 id="7f807ed4-689a-40f5-9a6f-34c018697c6d" class="">Returning an object (find a person)</h1><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c06d5531-0067-447a-9e71-dd5cae8750b9" class="code"><code class="language-Java">//bad way
 Person found= null;
 for (Person p : ps){
 if (p.name().equals(&quot;Bob&quot;) &amp;&amp; p.age() &gt; 30){
 found = p;
 break;
 }
 }
 if(p != null) {...}
 //better way
 Optional&lt;Person&gt; elem= ps.stream().filter(p-&gt;test(p)).findFirst();
 elem.ifPresent(()-&gt;{...});</code></pre></details></li></ul><ul id="88b7d610-7799-424f-8291-346dcf0ebaf4" class="toggle"><li><details><summary>array of size 1</summary><figure id="0c8f9c22-db20-4790-bb33-f82eb638b6ed" class="image"><a href="image%2052.png"><img style="width:624px" src="image%2052.png"/></a></figure><figure id="815149ee-69de-4cf0-be2b-f84e27307d77" class="image"><a href="image%2053.png"><img style="width:624px" src="image%2053.png"/></a></figure><figure id="660e3c78-4a39-4dab-8a98-dc4dd680f01e" class="image"><a href="image%2054.png"><img style="width:624px" src="image%2054.png"/></a></figure></details></li></ul><ul id="d2c808c3-0822-4070-a273-d52373b42fd4" class="toggle"><li><details><summary>mis-abstraction</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cf484866-de41-4232-bf1b-cde2c8b9da76" class="code"><code class="language-Java">if(condition()) {/*..*/} //ok
if(condition() == true) {/*..*/} //NO!
return condition();//ok
if (condition()){ return true; } else { return false; } //NO!
myName.equals(&quot;Bob&quot;) //ok
myname == &quot;Bob&quot; //NO!
is = is.stream()
.map(i-&gt;i * 2).toList();//ok
is = is.stream()
.filter(i-&gt;i &gt; 0).map(i-&gt;i * 2).toList();//also ok
is = is.stream()
.filter(i-&gt;i &gt; 0).toList()
.stream().map(i-&gt;i * 2).toList();//NO!
Function&lt;Integer,Integer&gt; f= i-&gt;i * 2;
is = is.stream().map(f).toList();//ok, lambdas are just objects</code></pre><figure id="42eb8d27-d9dc-4375-9953-4b56de2169b1" class="image"><a href="image%2055.png"><img style="width:623.96875px" src="image%2055.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="1001a926-7344-8060-8a1c-d7f8a490d276" class="toggle"><li><details><summary>Fuzz testing</summary><ul id="3cb560ee-16d0-4fe3-b407-a39ec8b0aac3" class="toggle"><li><details><summary>Kind of testing</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1001a926-7344-800a-8b9f-f4a5262ef654"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="8c2333d3-0c19-4cad-a9a4-ef7a18860dad" class="">fuzz testing is property based testing on a automatically generated data set</p><ul id="97661879-28b6-4cdc-b67f-013c9939e470" class="bulleted-list"><li style="list-style-type:disc">property based testing is automatic (eg: using junit)</li></ul><ul id="d4502432-c51a-47a4-9254-2b7e20ac34aa" class="bulleted-list"><li style="list-style-type:disc">run the same checks on a large amount of inputs</li></ul><ul id="1001a926-7344-80d3-8834-dad3f2ae318e" class="bulleted-list"><li style="list-style-type:disc">quadratic gain in testing</li></ul></div></figure><p id="1001a926-7344-80dd-b08c-e74c482cf370" class="">● Manual testing: manually run the program and look to the behavior with<br/>your miserable human eyes.<br/>● Automatic testing: run a single case input→output and write a<br/>functionality that checks if the output is the expected output<br/>● (Automatic) Property based testing on a fixed dataset: run the<br/>same checks on a large amount of inputs.<br/></p><p id="1001a926-7344-80fa-9633-f8f782c97046" class="">
</p></details></li></ul><ul id="074f40ab-ed2c-4a4d-ac52-3ab181ff0e66" class="toggle"><li><details><summary>Property based testing</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="2ddf3685-b0ef-4cbe-9ea3-79d2bb3bc1bf"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="ae37597b-2edf-4dc5-b5e3-18a9e2dd8a43" class="">tests general properties that should hold true for all inputs rather than a specific input/case</p></div></figure><h3 id="d0dba579-d229-4d1c-844b-248122cbabcf" class="">Example</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f4d78165-3de6-4897-8b6c-23e8c9b2d344" class="code"><code class="language-Java">//2 methods to test if they are the same

● We want to count how many times a substring is present in a
large string.
● We easily find a simple but slow way to do it:
 public static int count(String text, String target) {
 return
 ( text.length() - text.replace(target, &quot;&quot;).length() )
 / target.length();
 }
 
 ● We want to count how many times a substring is present in a large
string.
● We then code a more efficient solution:
 public static int count(String text, String target) {
 int index= 0;
 int count= 0;
 int length= target.length();
 while( (index = text.indexOf(target, index)) != -1 ) {
 index += length;
 count += 1;
 }
 return count;
 }
 
 
 //testing schema
 
 ● Are they the same?
We could write the following (passing) test,
but this is only testing for a specific string.
 @Test void automaticTest(){
 int resFast= countFast(&quot;ABABCABC&quot;,&quot;AB&quot;);
 int resSafe= countSafe(&quot;ABABCABC&quot;,&quot;AB&quot;);
 assertEquals(3,resSafe);
 assertEquals(resFast,resSafe);
 }
● Idea: there is a property:
forall Strings s1 and s2,
 countFast(s1,s2) == countSafe(s1,s2)
● Can we test this property?


//make it faster

● Make a method testing the property for some input
Make a bunch of minimally formatted tests calling it.
 void testEq(String tot, String inside){
 int resFast= countFast(tot,inside);
 int resSafe= countSafe(tot,inside);
 assertEquals(resFast,resSafe);
 }
 @Test void foo_bar(){ testEq(&quot;foo&quot;,&quot;bar&quot;); }
 @Test void foo_o(){ testEq(&quot;foo&quot;,&quot;o&quot;); }
 @Test void beer_er(){ testEq(&quot;beer&quot;,&quot;er&quot;); }
 @Test void strawberry_r(){ testEq(&quot;strawberry&quot;,&quot;r&quot;); }
● This is an example of property testing!
Still not fuzz testing since we are writing the strings under test in
the code by hand.</code></pre></details></li></ul><ul id="1001a926-7344-8059-898c-f1ed70bf2082" class="toggle"><li><details><summary>Fuzz testing examples</summary><ul id="4276a69f-16df-42f1-8701-7aea5a707918" class="bulleted-list"><li style="list-style-type:disc">we don’t just write a bunch of tests by hand</li></ul><ul id="1001a926-7344-8000-8d09-ce226b65b8ad" class="bulleted-list"><li style="list-style-type:disc">we write a method that generates the inputs to test!</li></ul><ul id="c6fdc8c8-553e-4ec0-a5fe-da1ce118b482" class="toggle"><li><details><summary>Example 1 </summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-800d-8c76-c53610bb6c51" class="code"><code class="language-Java">//automated testing 
void testEq(String tot, String inside){
int resFast= countFast(tot,inside);
int resSafe= countSafe(tot,inside);
assertEquals(resFast,resSafe);
}
@Test void foo_bar(){ testEq(&quot;foo&quot;,&quot;bar&quot;); }
@Test void foo_o(){ testEq(&quot;foo&quot;,&quot;o&quot;); }
@Test void beer_er(){ testEq(&quot;beer&quot;,&quot;er&quot;); }
@Test void strawberry_r(){ testEq(&quot;strawberry&quot;,&quot;r&quot;); }

//fuzz testing
final Random r= new Random();

 public String randomString(int length) {
		 byte[] array= new byte[length];
		 r.nextBytes(array);
		 return new String(array, Charset.forName(&quot;UTF-8&quot;));
 }
 
 @Test void propertyTest(){
		 for(int i= 0; i &lt; 1000; i += 1){
				 String tot= randomString(r.nextInt(100));
				 String inside= randomString(r.nextInt(100));
				 int resFast= countFast(tot,inside);
				 int resSafe= countSafe(tot,inside);
				 assertEquals(resFast,resSafe);
		 }
 }</code></pre><h3 id="5dcde106-a245-4f66-85fe-fc74936cbda9" class="">Adding more properties</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-80e2-a992-d6d9a2a16441" class="code"><code class="language-Java">● More properties!
● For example: If ‘inside.lenght() &gt; tot.lenght()’, then result == 0
 @Test void propertyTest(){
 for(int i= 0; i &lt; 1000; i += 1){
 String tot= randomString(r.nextInt(100));
 String inside= randomString(r.nextInt(100));
 int resFast= countFast(tot,inside);
 int resSafe= countSafe(tot,inside);
 assertEquals(resFast,resSafe);
 if (inside.length() &gt; tot.length()){ assertEquals(0,resFast); }
 if (tot.contains(inside)) { assertTrue(resFast &gt; 0); }

 if (!inside.isEmpty()) { assertTrue(tot.length() &gt;= resFast); }
 }
 }</code></pre><h3 id="630cbf6c-8c97-497c-a3f3-a15edd10ef47" class="">Generating data that is actually meaningfully testing your code/property</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6d9c3e77-e77d-4594-bafd-339f8a8590c7" class="code"><code class="language-Java">● Over 1000 attempts,
..if (tot.contains(inside)) { assertTrue(resFast&gt;0); }..
“.contains” only holds 20–40 times….
● What is the max result we get? With only 20-40 shots at a single
contains, probably not that much..
how can we check for those? How can we check our testing set up to
validate it?
● Instrument it and check for the results

//how do you check that your generated code is actually testing?

● Instrument it and check for the results.
● And… this fails!! max = 37 !! how can it be?
 @Test void propertyTest(){
 int found= 0;
 int max= 0;
 for (int i= 0; i &lt; 1000; i += 1){
 String tot= randomString(r.nextInt(100));
 String inside= randomString(r.nextInt(100));
 int resFast= countFast(tot,inside);
 int resSafe= countSafe(tot,inside);
 ...
 if(tot.contains(inside)) { assertTrue(resFast&gt;0); found += 1;}
 ...
 if(!inside.isEmpty() &amp;&amp; max &lt; resFast) { max = resFast; }
 }
 assertTrue(found &gt; 10 &amp;&amp; found &lt; 50,&quot;&quot;+found);
 assertTrue(max &lt; 10,&quot;&quot;+max);
 }
 
 ● Instrument it and check for the results.
● And… this fails!! max = 37 !! how can it be?
● We make a fully random byte array, but when we encode the string as
UTF-8, we are collapsing a lot of combinations into ‘?’. So as soon as
there is a string of length 1 containing just ‘?’, this is going to be
contained a tons of time inside a randomly generated string of size up
to 100…
So… generating random strings is not that obvious.

● Is it a bug or not? Well, this really depends on what you think about it.
● Putting the encoding to UTF-16 drops the max to a the more
expectable 2-4 range.
● To ensure we test some more corner cases,
we may want to test more properties,
for example about combining existing strings.

//More properties More structure

 int found= 0; int max= 0;
 @Test void propertyTest(){
 for (int i= 0; i &lt; 1000; i += 1){
 String tot= randomString(r.nextInt(100));
 String inside= randomString(r.nextInt(100));
 int resFast= countFast(s1,s2);
 int resSafe= countSafe(s1,s2);
 checkProperties(s1,s2,resFast,resSafe);
 if (s2.isEmpty()){ continue; }
 checkCombine1(s1,s2,resFast);
 checkCombine2(s1,s2,resFast);
 }
 assertTrue(found &gt; 500 &amp;&amp; found &lt; 5000,&quot;&quot;+found);
 assertTrue(max &lt; 10,&quot;&quot;+max);
 }

public void checkProperties(
 String tot, String inside, int resFast, int resSafe) {
 assertEquals(resFast,resSafe);
 if (inside.length()&gt;top.length()){ assertEquals(0,resFast); }
 if (top.contains(inside)) { assertTrue(resFast &gt; 0); found += 1; }
 if (!inside.isEmpty()) { assertTrue(top.length() &gt;= resFast); }
 if (!inside.isEmpty() &amp;&amp; max &lt; resFast){ max = resFast; }
 }
 public void checkCombine1(String tot,String inside,int res) {
 String tot2= tot + tot
 int resFast= countFast(tot2,inside);
 checkProperties(tot2,inside,resFast,countSafe(tot2,inside));
 assertEquals(res * 2,resFast);
 }
 public void checkCombine2(String s1,String inside,int res) {
 String tot= s1 + inside + s1;
 int resFast=countFast(tot,inside);
 checkProperties(tot,inside,resFast,countSafe(tot,inside));
 assertEquals(res * 2 + 1,resFast);
 }</code></pre></details></li></ul><ul id="402b689e-629c-4c3e-81be-2674ac26c560" class="toggle"><li><details><summary>Example 2</summary><h3 id="5b86b26c-5ddb-41fd-bf7f-f777fad1843c" class="">Another example: Tetris!</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-80bd-984b-dff6db19ae92" class="code"><code class="language-Java">enum Piece{
 L,J,T,I,O,S,Z
 /*..*/
}
enum Move{
 Left,Right,RotateLeft,RotateRight,Drop
 /*..*/
}
public class Tetris{
 Tetris(List&lt;Piece&gt; pieces) { /*..*/ }
 void doMove(Move move){ /*..*/ }
 int score(){ /*..*/ }
 boolean gameOver(){ /*..*/ }
 /*..*/
}</code></pre><h3 id="1001a926-7344-8068-96ae-e2601818e242" class="">automated testing</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-80ee-ad55-cd17d0912ef2" class="code"><code class="language-Java">@Test void automaticTest() {
 Tetris t = new Tetris(List.of(L,O,L,J,O,I));
 var moves = List.of(Left,Left,Left,Drop,/*..*/RotateLeft,Drop);
 for (var m : moves){ t.doMove(m); }
 assertTrue(t.gameOver());
 assertEquals(t.score(),54);
}</code></pre><h3 id="1001a926-7344-8084-83f5-fddc467a9e99" class="">properties</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-8009-a6f7-f1b04a579c68" class="code"><code class="language-Java">
@Test void dataSetTest1(){ inputs.forEach(i-&gt;i.check()); }
static List&lt;TestInput&gt; inputs=/*
 .. could be hard coded here or in another source file,
 .. could be serialized on some file and deserialized here
 */;
record TestInput(
 List&lt;Piece&gt; pieces, List&lt;Move&gt; moves, boolean over, int score)
 implements Serializable{
 void check(){
 Tetris t= new Tetris(pieces);
 for (var m : moves){ t.doMove(m); }
 assertEquals(over,t.gameOver());
 assertEquals(score,t.score());
 }
 } </code></pre><h3 id="2fbe61bc-8494-4c93-a3ab-191e123b4b90" class="">generating test input at random</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-80bd-8fec-e0b83b88b892" class="code"><code class="language-Java">record TestInput(
	List&lt;Piece&gt; pieces, List&lt;Move&gt; moves, boolean over, int score)
implements Serializable{
 void check() {
 
 Tetris t= new Tetris(pieces);
 for (var m : moves){ t.doMove(m); }
 assertEquals(over,t.gameOver()); //HARD! How can we predict the expected
 assertEquals(score,t.score()); //result? We would need a second tetris
 } //implementation....
 }
 //But, with just random pieces and moves, we can build
 //some reasonable properties!</code></pre><h3 id="1001a926-7344-80a0-bc92-ca727232a066" class="">Example property &amp; fuzz testing for tetris</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b23e794f-021d-404e-b04e-09bec418f431" class="code"><code class="language-Java">List&lt;Piece&gt; randomPieces(int size){
 return IntStream.range(0, size)
 .map(i-&gt;r.nextInt(Piece.values().length))
 .mapToObj(ei-&gt;Piece.values()[ei])
 .toList();
 }
 List&lt;Move&gt; randomMoves(int size){
 return IntStream.range(0, size)
 .map(i-&gt;r.nextInt(Move.values().length))
 .mapToObj(ei-&gt;Move.values()[ei])
 .toList();
 }
 @Test void propertyTetris(){
 for (int i= 0; i &lt; 1000; i += 1){
 var pieces= randomPieces(1000); //enough that can not finish
 var moves = randomMoves(r.nextInt(1000));//in 1000 moves
 var t= new Tetris(pieces);
 for (var m : moves){ t.doMove(m); }
 checkTetrisProperties(pieces,moves,t);
 } }
 void checkTetrisProperties(List&lt;Piece&gt; pieces, List&lt;Move&gt; moves, Tetris t){
 int totSquares= t.piecesUsed() * 4;
 int clearedSquares= t.clearedLines() * 10;
 assertTrue(totSquares &gt;= clearedSquares);
 int rest= totSquares - clearedSquares;
 if(!t.gameOver()){ assertTrue(rest &lt; 9*20); }
 }</code></pre></details></li></ul></details></li></ul><ul id="eb8f4ab2-71fe-4d5d-8056-41d20416254f" class="toggle"><li><details><summary>QuickCheck</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="05ab8871-b66f-4084-b1e0-992eeb9d60b4"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="1deda8ff-5502-4bc4-a3a9-fb42df377f0e" class="">library to support random generation of data sets</p><ul id="1001a926-7344-801d-92be-d4b1ace64b8d" class="bulleted-list"><li style="list-style-type:disc">Originated for Haskell</li></ul><ul id="1001a926-7344-8090-b633-ef5d0d523e6b" class="bulleted-list"><li style="list-style-type:disc">Porting of that library are available for many languages.</li></ul><ul id="f6ea5641-417e-40f8-a3be-74da56bc9caf" class="bulleted-list"><li style="list-style-type:disc">java version: <a href="https://github.com/pholser/junit-quickcheck">https://github.com/pholser/junit-quickcheck</a></li></ul><ul id="6eb4de82-eb62-448f-91b7-19b2db9e0b63" class="bulleted-list"><li style="list-style-type:disc">if fuzz testing is hard to do manually, then quick check will be even harder to use</li></ul></div></figure><h3 id="9155ce34-e65b-43f2-82ba-18215f3e27fe" class="">QuickCheck for HTML nodes</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1001a926-7344-8015-921b-ee27404600f1" class="code"><code class="language-Java">//with no quick check
public sealed interface Node{
 &lt;T&gt; T accept(Visitor&lt;T&gt; v);
 record Div(List&lt;Node&gt; ns) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitDiv(this); }
 }
 public record Li(Node node) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitLi(this); }
 }
 public record P(String text) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitP(this); }
 }
 public record Ul(List&lt;Li&gt; lis) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitUl(this); }
 }
}//This is our standard Node.
//With QuickCheck we can put annotations in places to instruct the
//generation of random Nodes.


//with quickcheck: need to add anotations
public sealed interface Node{
 &lt;T&gt; T accept(Visitor&lt;T&gt; v);
 record Div(@Size(max=5)List&lt;@From(Gen.class)Node&gt; ns) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitDiv(this); }
 }
 record Li(@From(Gen.class)Node node) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitLi(this); }
 }
 record P(String text) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitP(this); }
 }
 record Ul(@Size(max=5)List&lt;@From(Ctor.class)Li&gt; lis) implements Node{
 public &lt;T&gt; T accept(Visitor&lt;T&gt; v){ return v.visitUl(this); }
 }
 
 class Gen extends CompositeGenerator&lt;Node&gt;{
		 public Gen() {
				 super(10/*max depth*/, Node.class, //the component type
				 List.of(Div.class,Ul.class,Li.class),//composites
				 List.of(P.class)); //leaves
		 }
 }}
 
 //Example property
 @RunWith(JUnitQuickcheck.class)
public class NodeTest {
 @Property(trials=100)
 public void allOpenClose( @From(Node.Gen.class)Node node ) {
 String s= node.accept(new ToHtml());
 assertEquals(count(s,&quot;&lt;DIV&gt;&quot;),count(s,&quot;&lt;/DIV&gt;&quot;));
 assertEquals(count(s,&quot;&lt;P&gt;&quot;), count(s,&quot;&lt;/P&gt;&quot;) );
 assertEquals(count(s,&quot;&lt;LI&gt;&quot;), count(s,&quot;&lt;/LI&gt;&quot;) );
 assertEquals(count(s,&quot;&lt;UL&gt;&quot;), count(s,&quot;&lt;/UL&gt;&quot;) );
 }
//count(..) is just the countFast/countSafe method from the start.
//In a ToHtml, every open tag and close tag is present the same amount of times.</code></pre><h3 id="3583a609-11a9-4dba-9c1d-de53ce9cc30a" class="">Composite Generator</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="42cbc99a-5eaf-46f7-9685-14fdce44e189" class="code"><code class="language-Java">class CompositeGenerator&lt;T&gt; extends Generator&lt;T&gt;{
		 private final int maxDepth;
		 private final List&lt;Class&lt;? extends T&gt;&gt; cases;
		 private final List&lt;Class&lt;? extends T&gt;&gt; leaves;
		 public CompositeGenerator(int maxDepth, Class&lt;T&gt; clazz,
		 List&lt;Class&lt;? extends T&gt;&gt; composites,List&lt;Class&lt;? extends T&gt;&gt; leaves){
		 super(clazz);
		 this.cases = Stream.concat(composites.stream(),leaves.stream()).toList();
		 this.leaves = leaves;
		 this.maxDepth= maxDepth;
 }
 
//type safe way of mixed type hashmap
private static final GenerationStatus.Key&lt;Integer&gt; depthK = new GenerationStatus.Key&lt;&gt;(&quot;depth&quot;, Integer.class);
 
private Generator&lt;? extends T&gt; genC(Class&lt;? extends T&gt; c){
	 return gen().constructor(c, c.getConstructors()[0].getParameterTypes());
}
@Override public T generate(SourceOfRandomness r, GenerationStatus s){
	 int depth= s.valueOf(depthK).orElse(0);
	 if (depth &gt; maxDepth){ return genC(r.choose(leaves)).generate(r,s); }
	 s.setValue(depthK,depth + 1);
	 try{ return genC(r.choose(cases)).generate(r,s); }
	 finally{ s.setValue(depthK,depth); }
 }
}

class CompositeGenerator&lt;T&gt; extends Generator&lt;T&gt;{
 ...
 private static final GenerationStatus.Key&lt;Integer&gt; depthK =
 new GenerationStatus.Key&lt;&gt;(&quot;depth&quot;, Integer.class);
 //GenerationStatus gives us a flexible ‘map of values’ to do our
 //internal book keeping during generation.
 //Here we just declare that we need an ‘int depth’ in the map.
 private Generator&lt;? extends T&gt; genC(Class&lt;? extends T&gt; c){
 return gen().constructor(c, c.getConstructors()[0].getParameterTypes());
 }
 //Generator is the most important type of QuickCheck. From inside a generator
 //you can ask for more generators using .gen().XXXX
 //Here we ask for the default generator that just generates the parameters
 //for the first/only constructor of a given type.
...
}</code></pre><h3 id="70bb938c-6b75-401c-8ade-c023300d3470" class="">CompositeGenerator&lt;T&gt;</h3><p id="37a4fb89-e8e5-4a2d-95a2-9812cb87bfbf" class="">● CompositeGenerator is an example of a custom generator to be<br/>used with a user defined data type.<br/>● In practice, it does not really make sense to use QuickCheck without<br/>your custom generators.<br/>● If you chose to learn QuickCheck, after the first few trivial ‘hello<br/>world testing’, custom generators are the first thing you should focus<br/>on learning.<br/></p><p id="1001a926-7344-80d8-8a2e-eeeeed8b873a" class="">
</p></details></li></ul><ul id="1001a926-7344-80a8-aaed-dd490c7be21c" class="toggle"><li><details><summary>Concluding</summary><p id="1001a926-7344-8050-ad5f-d451ca65b0a4" class="">● Automatic testing, case by case<br/>● Automating testing on a fixed dataset<br/>– Property based testing becomes possible<br/>– Crucial to have many internal asserts<br/>● Fuzz testing = programmatic generation of data sets<br/>– Example list of moves (tetris) + list of pieces<br/>● QuickCheck: a library to support random generation of datasets<br/></p></details></li></ul></details></li></ul><ul id="1041a926-7344-8004-b2cb-cbe28c96d1e8" class="toggle"><li><details><summary>Serialization/Marshaling</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d7529da0-818a-496e-b84f-f6f1da969dd1"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="3fe58286-b0fd-48e8-aa10-a30467fefafa" class="">process of <mark class="highlight-yellow_background">turning group of objects</mark> into a <mark class="highlight-yellow_background">sequence of bits</mark><mark class="highlight-default"> and vise-versa </mark></p><figure id="1041a926-7344-80a8-ad82-c92630fe0b39" class="image"><a href="image%2056.png"><img style="width:680px" src="image%2056.png"/></a></figure><ul id="d973b776-aa22-4ac5-84e2-e2e34eb5a608" class="bulleted-list"><li style="list-style-type:disc">objects related to each other form a graph, we want to convert it into a series/list of bits to be saved and loaded again </li></ul><ul id="1041a926-7344-80dd-9770-e87c368a5e3e" class="bulleted-list"><li style="list-style-type:disc">How to turn an object graph into a set of bits?<ul id="017b14e5-5c27-4cf7-98c7-40fe7b123d40" class="bulleted-list"><li style="list-style-type:circle">In Java, the process of turning an object graph into a set of bits is called ‘Serialization’.</li></ul><ul id="1041a926-7344-80ed-905e-da42cec6e7fb" class="bulleted-list"><li style="list-style-type:circle">Sometimes we use the term marshaling instead of serialization. You can consider the two terms as synonymous</li></ul></li></ul><ul id="1041a926-7344-80a2-bb2d-cf36f399ea5d" class="bulleted-list"><li style="list-style-type:disc">Why to turn an object graph into a set of bits?<ul id="8c61d65e-6799-4d79-8552-8ed0c44936d5" class="bulleted-list"><li style="list-style-type:circle">This is very useful, since bits can be saved on disk or sent over the network.</li></ul><ul id="1041a926-7344-8030-850c-c34f78c947a7" class="bulleted-list"><li style="list-style-type:circle">We may want to save some data and reuse it in another execution of the same program.</li></ul><ul id="3b7ba168-e7ae-422e-87c1-23d5c7fec192" class="bulleted-list"><li style="list-style-type:circle">For example a videogame save file.</li></ul></li></ul><ul id="72e55be1-2882-4566-8db3-911eb792c09d" class="bulleted-list"><li style="list-style-type:disc">Serializable can be easy: just directly convert string to bits</li></ul><ul id="1041a926-7344-80b2-9697-ebd31753511b" class="bulleted-list"><li style="list-style-type:disc">Serializable can be hard: representing a recursive object graph </li></ul></div></figure><ul id="1041a926-7344-80f4-ade9-d8aa032f1d76" class="toggle"><li><details><summary>Deserialization</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1041a926-7344-80a6-8640-da0ffbfcfe1d"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="bf7fb206-9874-4361-b590-1db6b3bf8f23" class="">process of turning bits into the original (or similar) objects </p><ul id="08ad798d-2637-4902-9328-319b2243dc82" class="bulleted-list"><li style="list-style-type:disc">Serializing is pointless without deserializing</li></ul><figure id="1041a926-7344-8074-b7a5-f8a0b58c0c05" class="image"><a href="image%2057.png"><img style="width:590px" src="image%2057.png"/></a></figure></div></figure><p id="1041a926-7344-80c8-af66-c17474677c8f" class="">
</p></details></li></ul><ul id="1041a926-7344-80f1-8432-fc2b14930af3" class="toggle"><li><details><summary>easy cases: (strings to bits)</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1041a926-7344-80de-bf23-d40fe5921b20"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="187fdc63-6199-4884-af87-b8fe73fda26a" class="">turning a string into bits is easy</p><ul id="1041a926-7344-8024-a819-e1a75cb2b87b" class="bulleted-list"><li style="list-style-type:disc">most languages is able to convert strings into char and byte arrays, where each char being encoded as bits</li></ul><ul id="1041a926-7344-803a-b623-d4025d56ed88" class="bulleted-list"><li style="list-style-type:disc">discerning the data type of the serialized bits is a challenge<ul id="e4bb0ef6-8edb-4cab-9709-75c0019bec8f" class="bulleted-list"><li style="list-style-type:circle">maybe store a header at the start of the bits which specifies the data type/schema </li></ul></li></ul><figure id="1041a926-7344-8003-b407-d9afa62b12a0" class="image"><a href="image%2058.png"><img style="width:652px" src="image%2058.png"/></a></figure></div></figure><h3 id="1041a926-7344-806b-9db9-d5ca2a392ba0" class="">Serialization and Deserialization by hand</h3><figure id="1041a926-7344-8032-87ed-e7286038fa5f" class="image"><a href="image%2059.png"><img style="width:652px" src="image%2059.png"/></a></figure></details></li></ul><ul id="1041a926-7344-80d1-aaec-c592a3c22750" class="toggle"><li><details><summary>Serializable interface</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1041a926-7344-8026-8d49-cfea4e8bd3cc"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="4c0fff44-82d3-44fe-b3ea-2e88ca903a18" class="">java wanted to support fully automatic/general object serialization</p><p id="1041a926-7344-80ae-99ea-f185721205e1" class="">this can be achieved by using the Serializable interface</p><figure id="71e72e7b-f5bb-4517-b55e-f7edb9d08259" class="image"><a href="image%2060.png"><img style="width:590px" src="image%2060.png"/></a></figure><ul id="1041a926-7344-8028-9114-e6465816b343" class="bulleted-list"><li style="list-style-type:disc">comes with some issues<ul id="1041a926-7344-80d3-a56b-efee549ef60f" class="bulleted-list"><li style="list-style-type:circle">if you want to serialize objects between just java and bits with no other language in the way, then it works well</li></ul><ul id="1041a926-7344-80b3-a80f-d0775222bfbf" class="bulleted-list"><li style="list-style-type:circle">had a lot more issue in the past, works better now in the last 5 years</li></ul></li></ul><ul id="e42d188b-8eac-4134-be18-08240a68241f" class="bulleted-list"><li style="list-style-type:disc">java serialization works on the whole ROG</li></ul></div></figure></details></li></ul><ul id="1041a926-7344-804e-bffa-d6d64a105766" class="toggle"><li><details><summary>Kinds of object graphs</summary><figure id="1041a926-7344-80fb-bfe5-e4248be97347" class="image"><a href="image%2061.png"><img style="width:652px" src="image%2061.png"/></a></figure><figure id="1041a926-7344-80e5-892f-f04d87df4726" class="image"><a href="image%2062.png"><img style="width:652px" src="image%2062.png"/></a></figure><figure id="311d9acf-5fc7-43b9-9cf7-fa0b0411e1c4" class="image"><a href="image%2063.png"><img style="width:652px" src="image%2063.png"/></a></figure><figure id="1041a926-7344-803c-b6bb-d4798bedf2be" class="image"><a href="image%2064.png"><img style="width:652px" src="image%2064.png"/></a></figure><figure id="fe3b95d3-66a9-42d0-a533-c24c620747a9" class="image"><a href="image%2065.png"><img style="width:652px" src="image%2065.png"/></a></figure><figure id="0a38c6b9-6e27-4612-a161-ef89906ae113" class="image"><a href="image%2066.png"><img style="width:652px" src="image%2066.png"/></a></figure></details></li></ul><ul id="1041a926-7344-80c1-b9a3-fd3905c5abb9" class="toggle"><li><details><summary>Human Readable Encoding vs Byte Format</summary><figure id="1041a926-7344-808b-a928-d5247a1f777a" class="image"><a href="image%2067.png"><img style="width:652px" src="image%2067.png"/></a></figure><figure id="8ee21554-8e8c-4ad7-b543-5b4382b3d5f2" class="image"><a href="image%2068.png"><img style="width:652px" src="image%2068.png"/></a></figure><figure id="33c029c0-cf02-40e8-acbe-ac35509e4f13" class="image"><a href="image%2069.png"><img style="width:652px" src="image%2069.png"/></a></figure></details></li></ul><ul id="ea4ab7a8-9c58-4310-8f27-cbab8cbb193f" class="toggle"><li><details><summary>Code for serialization into JSON</summary><figure id="1041a926-7344-80ec-9fc8-f686b511c044" class="image"><a href="image%2070.png"><img style="width:652px" src="image%2070.png"/></a></figure><ul id="1041a926-7344-8020-8813-e925d9eaebea" class="bulleted-list"><li style="list-style-type:disc">there are 2 types of abstractions, leaky and non leaky abstractions<ul id="1041a926-7344-8060-b28e-dfbc0a32db43" class="bulleted-list"><li style="list-style-type:circle">the JVM is a good example of a non leaky abstraction: you can write java code without knowing the abstraction barrior that is created between java, JVM byte code and the low level APIs</li></ul><ul id="1041a926-7344-8092-a668-fcf02f1b24a7" class="bulleted-list"><li style="list-style-type:circle">front and backend end is a good example of leaky abstraction: you need to know exactly all the abstraction used on the front and backend to do anything with it </li></ul></li></ul></details></li></ul><ul id="f1b91afe-87d9-4374-bb77-f7eb83bafb4c" class="toggle"><li><details><summary>Code for serialization into Byte format</summary><p id="ab582caf-3728-44b6-9844-4a9a9c748c84" class="">● While you can encode your own form of binary serialization, Java<br/>offers the “ java.io.Serializable” interface.<br/>● If all the objects in ROG(o) are serializable,<br/>then we can serialize the object o.<br/></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1041a926-7344-800f-80f1-cb094dcd362b" class="code"><code class="language-Java">
byte[] serialize(Object o)throws IOException{
	 var aux= new ByteArrayOutputStream();
	 try(var out= new ObjectOutputStream(aux)){
			 out.writeObject(o);
			 out.flush();
	 }
	 return aux.toByteArray();
}//Then, do what you want with the byte array!
 
 
Object deserialize(byte[] data)throws IOException, ClassNotFoundException{
	 try(var i= new ObjectInputStream(new ByteArrayInputStream(data))){
			 return i.readObject();
	 }
}//Then, cast the object to a specific type and go on!</code></pre><h3 id="1041a926-7344-80e9-8457-d92a5906adc5" class="">Using Serializable</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1041a926-7344-803c-af3d-f96efb25073a" class="code"><code class="language-Java">//How to make a simple record serializable
record Person(String name, int age) implements Serializable{}

//How to make a class serializable
class Person implements Serializable{
	 //rabbit hole: how to handle code evolution?
	 private static final long serialVersionUID = 1L;
}
 
//How to make a lambda serializable
interface MyFunction&lt;T,R&gt; extends Function&lt;T,R&gt;, Serializable{}
MyFunction&lt;Integer,Person&gt; solution1 = age -&gt; new Person(&quot;Bob&quot;, age);

//function Serializable without having to define your own Serializable interface
Function&lt;Integer,Person&gt; solution2 
		= (Function&lt;Integer,Person&gt; &amp; Serializable) age -&gt; new Person(&quot;Bob&quot;,age);

//Can this be serialized?
record Cat(Object prey) implements Serializable{}
//It may or may not be, we can only discover at run time!
//we don&#x27;t know because cat has an object prey which may or may not be Serializable</code></pre><h3 id="1041a926-7344-805a-8b65-f86eeecbe1aa" class="">Serializable classes vs records</h3><figure id="1041a926-7344-8052-87c3-f47bf6fb702e" class="image"><a href="image%2071.png"><img style="width:652px" src="image%2071.png"/></a></figure><h3 id="feab469c-c7e2-4cce-9405-f9a0073995ad" class="">Serializable lambdas</h3><figure id="1041a926-7344-8053-9106-edc82208f3f8" class="image"><a href="image%2072.png"><img style="width:652px" src="image%2072.png"/></a></figure><h3 id="1041a926-7344-800f-b6ad-c2aef2ec1719" class="">Personalizing serialization/deserialization</h3><figure id="35ad9170-de69-4bc6-bda6-88184e871227" class="image"><a href="image%2073.png"><img style="width:652px" src="image%2073.png"/></a></figure><h3 id="1041a926-7344-80d9-9fc2-efa0b771d5f2" class="">Serializable flyweights</h3><figure id="1041a926-7344-80cb-92e9-d6834307587c" class="image"><a href="image%2074.png"><img style="width:652px" src="image%2074.png"/></a></figure></details></li></ul></details></li></ul><ul id="10b1a926-7344-8017-bc24-cd22a709e62d" class="toggle"><li><details><summary>Assignment 1 Model Solutions</summary><ul id="10b1a926-7344-80e7-819d-d645bfffbe33" class="bulleted-list"><li style="list-style-type:disc">images can be cashed</li></ul><ul id="6114fe41-9931-4939-a7d2-d7d00e4c053b" class="bulleted-list"><li style="list-style-type:disc">when loading assets/data, methods can throw UncheckedIOExceptions</li></ul><ul id="aaab7edf-ed42-48a7-a57f-2c6f6073137a" class="bulleted-list"><li style="list-style-type:disc">define core datatypes that will be used across code (point, code, cell classes)</li></ul><ul id="10b1a926-7344-8066-b1d6-cb2ac53775e1" class="bulleted-list"><li style="list-style-type:disc">entities in OOP doesn’t require a thread, instead has a ping method to give it a “pulse”</li></ul></details></li></ul><ul id="10d1a926-7344-8087-b26b-d320ad7794ab" class="toggle"><li><details><summary>Template and Frameworks</summary><ul id="10d1a926-7344-80ef-8825-c96f8a7d77a2" class="toggle"><li><details><summary>Template Method</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10d1a926-7344-80be-a58a-e0cb2f6fc07f"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="f0f11621-76d7-4629-930e-b3b08affbaf8" class="">instead of having an object that defines behavior, a template method is used to define behavior</p><figure id="10d1a926-7344-803a-b4ac-c8a21a10e201" class="image"><a href="image%2075.png"><img style="width:336px" src="image%2075.png"/></a></figure><figure id="10d1a926-7344-8047-8296-fbe9a2dc6d29" class="image"><a href="image%2076.png"><img style="width:336px" src="image%2076.png"/></a></figure></div></figure><h3 id="10d1a926-7344-803c-84e6-f8f5e80898bb" class="">Strategy vs Template</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10d1a926-7344-80d9-84c0-ef2fdc98d320" class="code"><code class="language-Java">//strategy
interface GraspingPolicy{
		void nextAction(RoboticArmStrategy robot, SensoryInput i);
}
class RoboticArmStrategy{
		GraspingPolicy policy;
		RoboticArmStrategy(GraspingPolicy policy){
				this.policy= policy;
		}
		boolean done(){ /*...*/ }
		SensoryInput lookAround(){ /*...*/ }
		final void doStuff(){
						while(!done()){
						var i= lookAround();
						policy.nextAction(this,i);
				}
		}
}
new RoboticArmStrategy((ras,i)-&gt;{/*...*/}) //strat can use lambdas

//Template
abstract class RoboticArmTemplate{
		//helpers can be overriden
		boolean done(){ /*...*/ } //HELPER METHOD
		SensoryInput lookAround(){ /*...*/ } //HELPER METHOD
		abstract void nextAction(SensoryInput i); //HELPER METHOD
		final void doStuff(){ //actual
				while(!done()){
						var i= lookAround();
						this.nextAction(i);
				}
		}
}
new RoboticArmTemplate(){
	void nextAction(SensoryInput i){ //template needs anon inner class
	/*...*/
	}
}</code></pre><ul id="10d1a926-7344-8079-86f3-e32a03f90410" class="bulleted-list"><li style="list-style-type:disc">strategy doesn’t know what to do for the next action, unlike template</li></ul><ul id="10d1a926-7344-80f2-9dfe-cbb0251d01fb" class="bulleted-list"><li style="list-style-type:disc">strategy object can change, once the method has been implemented in the template, the behavior is fixed</li></ul><ul id="10d1a926-7344-80f4-8be4-ecc6351ff308" class="bulleted-list"><li style="list-style-type:disc">either the class is abstract, or the method is a default implementation<ul id="10d1a926-7344-802d-8ded-d14ff3c5e324" class="bulleted-list"><li style="list-style-type:circle">every non file method is an instance of the template method pattern</li></ul></li></ul><ul id="10d1a926-7344-8001-af7a-e3ce8649168d" class="bulleted-list"><li style="list-style-type:disc">template method pattern is pervasive, you need 3 methods rather than the one</li></ul><ul id="10d1a926-7344-8004-80be-e172f8bc51c6" class="bulleted-list"><li style="list-style-type:disc">you can change behavior by changing the field for strategy, for template you have to override the template method with subtyping</li></ul></details></li></ul><ul id="10d1a926-7344-805d-9d61-ec9f0d1398b3" class="toggle"><li><details><summary>Framework</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10d1a926-7344-8083-9e0e-fd5f826ca7d0"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="ebec4d4a-7483-42ba-9822-3ef27424e434" class="">software where <mark class="highlight-orange_background">preexisting code controls new user code</mark></p><ul id="10e1a926-7344-802b-8bbb-f42145845491" class="bulleted-list"><li style="list-style-type:disc">can be the main design focus or accidental</li></ul><ul id="10e1a926-7344-8001-9175-e26aa521be15" class="bulleted-list"><li style="list-style-type:disc">frameworks can be a program, a library or both</li></ul><ul id="10e1a926-7344-80e2-97af-cbdf686f6853" class="bulleted-list"><li style="list-style-type:disc">frameworks are everywhere in OO</li></ul><ul id="10e1a926-7344-8016-8db5-e72ea98c1d9e" class="bulleted-list"><li style="list-style-type:disc">frameworks are strongly related to dynamic dispatch and time traveling</li></ul></div></figure><ul id="10d1a926-7344-807d-87b5-f2b284eb82f8" class="toggle"><li><details><summary>What isn’t a framework</summary><ul id="10d1a926-7344-8007-a1fc-e4feb4659c14" class="bulleted-list"><li style="list-style-type:disc">only some frameworks are about web pages</li></ul><ul id="10d1a926-7344-80e6-bb72-f64562cabca1" class="bulleted-list"><li style="list-style-type:disc">only some frameworks are programs</li></ul><ul id="10d1a926-7344-8020-9c36-c53602477b2d" class="bulleted-list"><li style="list-style-type:disc">only some frameworks are libraries </li></ul><ul id="10d1a926-7344-80cf-b316-c69bea1bdd4f" class="bulleted-list"><li style="list-style-type:disc">some frameworks are small</li></ul><figure id="10d1a926-7344-808d-82ab-d1fb8785e81f" class="image"><a href="image%2077.png"><img style="width:623.984375px" src="image%2077.png"/></a></figure></details></li></ul><ul id="10d1a926-7344-8096-ba19-e7de5d3d336a" class="toggle"><li><details><summary>Smallest framework</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10d1a926-7344-80e6-ab61-c51b61d60717" class="code"><code class="language-Java">//this is a framework
class A{
		int inner(){ return 0; }
		int outer(){ return this.inner() + 1; }
}

//because you can use it like this
class B extends A{ @Override int inner(){ return 1; } }

//when you run B().outer() the code of A will execute your inner code under
//the control of framework A</code></pre><figure id="10d1a926-7344-80ac-a30e-d75ea8ec96a1" class="image"><a href="image%2078.png"><img style="width:623.96875px" src="image%2078.png"/></a></figure><ul id="10d1a926-7344-804f-a473-d9a91e5bd697" class="bulleted-list"><li style="list-style-type:disc">B is inside of A</li></ul><ul id="10d1a926-7344-8028-ba52-ed312d40f103" class="bulleted-list"><li style="list-style-type:disc">A controls B</li></ul><ul id="10d1a926-7344-80cc-b0af-d636bafee5ac" class="bulleted-list"><li style="list-style-type:disc">code of B is user code, like how the main method is user code, but code of B is called by the framework A</li></ul><h3 id="10d1a926-7344-8074-b915-f0444ff7383f" class="">Framework vs Time travel</h3><ul id="10d1a926-7344-80d9-b1a3-c88d28493e42" class="bulleted-list"><li style="list-style-type:disc">in order for the framework to call your code (framework being written before your code) it has to use dynamic dispatch</li></ul><figure id="10d1a926-7344-8066-939c-cd60f01f1be5" class="image"><a href="image%2079.png"><img style="width:623.984375px" src="image%2079.png"/></a></figure></details></li></ul><ul id="10d1a926-7344-80c9-8019-e004ffd82b48" class="toggle"><li><details><summary>Basic Framework</summary><figure id="10d1a926-7344-80cf-a432-dda870e97b60" class="image"><a href="image%2080.png"><img style="width:623.96875px" src="image%2080.png"/></a></figure></details></li></ul><ul id="10d1a926-7344-8030-b83c-e25307fb29dd" class="toggle"><li><details><summary>Kind of frameworks</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10d1a926-7344-8068-892d-c3ae3cb5498e"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="694297b4-fddf-4e4e-ba1f-a795c9178b09" class="">there are 2 types of frameworks</p><ul id="10d1a926-7344-80fc-8ef5-cd0eca312ae5" class="bulleted-list"><li style="list-style-type:disc">frameworks that work as libraries (execute under user defined main) or program (has a main)</li></ul><ul id="10d1a926-7344-80d1-8273-f5d0ec48517b" class="bulleted-list"><li style="list-style-type:disc">you can make a framework that works with both<ul id="10d1a926-7344-8048-a0aa-f74b9fd801d3" class="bulleted-list"><li style="list-style-type:circle">has a main method but the user doesn’t need to access their code directly through it</li></ul><ul id="10d1a926-7344-8008-82c1-e712e2067265" class="bulleted-list"><li style="list-style-type:circle">this is how javafx tried to do it</li></ul></li></ul><figure id="10d1a926-7344-803b-a25e-fee994533c11" class="image"><a href="image%2081.png"><img style="width:561.953125px" src="image%2081.png"/></a></figure></div></figure><h3 id="10d1a926-7344-8088-9c36-dc08af58bd6a" class="">Frameworks that are also libraries</h3><p id="10d1a926-7344-80cc-b0f1-e8074d172116" class="">they all execute under a user defined main method.</p><ul id="10d1a926-7344-808e-902c-e039881375e9" class="bulleted-list"><li style="list-style-type:disc">swing creates your components by extending existing components <ul id="10d1a926-7344-803d-8bbd-c6e6b6c956f8" class="bulleted-list"><li style="list-style-type:circle">event handlers implement swing specific interfaces</li></ul><ul id="10d1a926-7344-80f6-b0ff-d398a8391fea" class="bulleted-list"><li style="list-style-type:circle">every programming patterns can be used with framework ideas (creative way to use dynamic dispatch)</li></ul></li></ul><ul id="10d1a926-7344-807b-b649-f72f3abb3f4b" class="bulleted-list"><li style="list-style-type:disc">java collection framework creates your collections extending existing ones<ul id="10d1a926-7344-8019-966f-e6ed982d7fbd" class="bulleted-list"><li style="list-style-type:circle">elements can implement equals, hashcode and tostring methods</li></ul></li></ul><ul id="10d1a926-7344-80f8-a261-ea2e2e09e157" class="bulleted-list"><li style="list-style-type:disc">java streams provide lambdas to inject behavior how the framework wants</li></ul><h3 id="10d1a926-7344-8062-a823-cd45b0e13513" class="">Framework that are also programs</h3><p id="10d1a926-7344-8007-a98c-ea91a12b5e87" class="">they have their own main method and load user code using some plugin technique (reflection)</p><ul id="10d1a926-7344-8010-88ca-e4f2773a26a1" class="bulleted-list"><li style="list-style-type:disc">junit annotates methods and JUnit main searches for classes for the right annotations and uses reflections to invoke them</li></ul><ul id="10d1a926-7344-80aa-a981-eef93a09d143" class="bulleted-list"><li style="list-style-type:disc">eclipes is a java program that contains a main method <ul id="10d1a926-7344-8006-a574-efb05c197a7c" class="bulleted-list"><li style="list-style-type:circle">at load time looks for a plugin folder for all the jar files</li></ul></li></ul></details></li></ul><ul id="10e1a926-7344-80de-8093-edcbdef34afe" class="toggle"><li><details><summary>Simple Java Webserver Framework (as a program and library) </summary><ul id="10e1a926-7344-80e4-ad04-c0c1892f8578" class="bulleted-list"><li style="list-style-type:disc">uses the HTTP server from the java standard library</li></ul><figure id="10e1a926-7344-8023-9279-e29e3e703a14" class="image"><a href="image%2082.png"><img style="width:2275px" src="image%2082.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="10e1a926-7344-8085-840b-f74b9a617288" class="toggle"><li><details><summary>Fluent Interface Pattern &amp; Builder Pattern</summary><ul id="10e1a926-7344-80a3-be3c-ee69a977dc43" class="toggle"><li><details><summary>Statement VS Expression programming style</summary><p id="10e1a926-7344-800c-a152-c47357f38b58" class="">statement programming is just a list of actions that takes multiple lines</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-809e-bf39-fef375d7bd42" class="code"><code class="language-Java">● Do a thing ‘;’
● Do another thing ‘;’
● Do another, single thing ‘;’

● var a= foo(20,40);
● var b= bar(23);
● var c= beer(a,b);
● var list= new ArrayList&lt;&gt;();
● list.add(1);
● list.add(2);
● list.add(3);</code></pre><p id="10e1a926-7344-80da-9036-d2a54bb8600e" class="">expression programming is more compact and does multiple actions in single lines</p><p id="10e1a926-7344-8021-8456-c254f47e2db1" class="">however its less readable:</p><ul id="10e1a926-7344-8050-b23e-f5cbe15ce64a" class="bulleted-list"><li style="list-style-type:disc">lose the names of local variables</li></ul><ul id="10e1a926-7344-80b8-8065-c47fd4cdbb49" class="bulleted-list"><li style="list-style-type:disc">requires knowledge order of execution: foo, bar then beer even tho beer if seen first</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-80dd-96da-d9ddd7507b05" class="code"><code class="language-Java">● beer( foo(20,40), bar(23) );
● list = List.of(1,2,3);

//This code first does foo(20,40),
//then bar(23),
//finally beer(result1,result2)
//In the text &#x27;beer&#x27; is first,
//but in the behaviour &#x27;beer&#x27; is last.</code></pre><h3 id="10e1a926-7344-80ec-a35c-f2ba247206f7" class="">Can we design APIs so that we take advantage of nesting expressions?</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-801a-8e7d-d10b5f484bb1" class="code"><code class="language-Java">var list= List.of(1,2,3);
//.of is a method that takes as
//many parameters as you need
var map= Map.of(1,&quot;a&quot;, 2,&quot;b&quot;, 3,&quot;c&quot;, 4,&quot;d&quot;);
//here .of is just overloaded up to a point
var map= Map.empty()
 .add(1,&quot;a&quot;).add(2,&quot;b&quot;).add(3,&quot;c&quot;).add(4,&quot;d&quot;);
//This instead is a fluent API (not supported by Java Maps)
● Streams are also a great example of a fluent interface / fluent API!


var list= myList.stream()
 .map(..)
 .filter(..)
 .toList();
● We have a method call to start the streamy stuff
● Many intermediate operation method calls
● One terminal operation method call.
● This is also the core of the builder pattern</code></pre></details></li></ul><ul id="10e1a926-7344-80b9-9cad-c1fa03e7b833" class="toggle"><li><details><summary>Builder Pattern Ingredients</summary><ul id="10e1a926-7344-8021-9abb-ed8221dd42df" class="bulleted-list"><li style="list-style-type:disc">Problem<ul id="10e1a926-7344-80e8-a4f4-f7040e7fa3db" class="bulleted-list"><li style="list-style-type:circle">we want to make a product object</li></ul><ul id="10e1a926-7344-80bc-94f9-f88dba10d505" class="bulleted-list"><li style="list-style-type:circle">object is complicated and requires a lot of content</li></ul><ul id="10e1a926-7344-8098-867c-c33ab657c853" class="bulleted-list"><li style="list-style-type:circle">can have constraints and conditonals </li></ul></li></ul><ul id="10e1a926-7344-80f2-ae18-db6b13c05401" class="bulleted-list"><li style="list-style-type:disc">solution<ul id="10e1a926-7344-80ae-85fb-dda2a0fa107d" class="bulleted-list"><li style="list-style-type:circle">user code doesn’t create the product directly</li></ul><ul id="10e1a926-7344-80bf-8e61-cf4ad1a475cd" class="bulleted-list"><li style="list-style-type:circle">instead creates the product using a product builder</li></ul><ul id="10e1a926-7344-80bf-a3a1-e9b37c164a41" class="bulleted-list"><li style="list-style-type:circle">product builder is an object with methods “buildPart_” </li></ul><ul id="10e1a926-7344-80a0-928c-ec64375e9456" class="bulleted-list"><li style="list-style-type:circle">builder is a mutable object to keep track of instructions about how to create the product</li></ul><ul id="10e1a926-7344-80fc-b23b-e11281a6e3a2" class="bulleted-list"><li style="list-style-type:circle">in modern programming, builder is implemented with a Fluent interface <ul id="10e1a926-7344-809b-ac95-da6d7589ea65" class="bulleted-list"><li style="list-style-type:square">methods “buildPart_” are named with short names to avoid prefixes</li></ul><ul id="10e1a926-7344-8017-b4d3-e091d4895b07" class="bulleted-list"><li style="list-style-type:square">example: .buildPartName() = .name()</li></ul></li></ul><ul id="10e1a926-7344-806a-85a1-c4a65d6a1bb7" class="bulleted-list"><li style="list-style-type:circle">when product contains collections, builder allows to fill up collections with individual elements rather than providing the whole collection itself</li></ul></li></ul></details></li></ul><ul id="10e1a926-7344-801a-9dfb-f2f0417e8ffb" class="toggle"><li><details><summary>Builder Pattern Examples</summary><h3 id="10e1a926-7344-80c8-bfe3-f2954657bd1d" class="">With no constraints</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-8042-9f77-c91c01d83736" class="code"><code class="language-Java">record Cat(String name, int age){}
record Person(String name, int age, String address, List&lt;Cat&gt; cats){}
class PersonBuilder{
 private String name;
 public PersonBuilder name(String name){
 this.name = name; return this;
 }
 private int age;
 public PersonBuilder age(int age){
 this.age = age; return this;
 }
 private String address;
 public PersonBuilder address(String address){
 this.address = address; return this;
 }
 private List&lt;Cat&gt; cats= new ArrayList&lt;&gt;();
 public PersonBuilder withCat(Cat cat){
 this.cats.add(cat); return this;
 }
Person build(){ return new Person( name, age, address, List.copyOf(cats) ); }
}</code></pre><h3 id="10e1a926-7344-805e-abfb-fda21a6ba3af" class="">with constraints</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-8020-b7ac-fd0fe5bc679f" class="code"><code class="language-Java">class PersonBuilder{
 private String name;
 public PersonBuilder name(String name){
 if (name == null || name.length() == 0){ throw new IllegalArgumentException(); }
 this.name = name; return this;
 }
 private int age= -1;
 public PersonBuilder age(int age){
 if (age &lt; 0){ throw new IllegalArgumentException(); }
 this.age = age; return this;
 }
 private String address= &quot;&quot;;
 public PersonBuilder address(String address){
 if (address == null){ throw new IllegalArgumentException(); }
 this.address = address; return this;
 }
 private List&lt;Cat&gt; cats= new ArrayList&lt;&gt;();
 public PersonBuilder withCat(Cat cat){
 if (cats.size() &gt;= 20){ throw new IllegalArgumentException(); }
 if (cat == null){ throw new IllegalArgumentException(); }
 if (cats.stream().anyMatch(c -&gt; c == cat)){ throw new IllegalArgumentException(); }
 this.cats.add(cat); return this;
 }
 Person build(){
 if (name == null || age == -1){ throw new IllegalArgumentException(); }
 return new Person(name, age, address, List.copyOf(cats));
 } }</code></pre></details></li></ul><ul id="10e1a926-7344-8021-80c8-c4630cc9b75d" class="toggle"><li><details><summary>Builder == accumulator</summary><figure id="10e1a926-7344-8097-91af-f5d5014bd61f" class="image"><a href="image%2083.png"><img style="width:574px" src="image%2083.png"/></a></figure></details></li></ul><ul id="10e1a926-7344-807f-85f4-fb2760990c60" class="toggle"><li><details><summary>Fluent Pattern</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10e1a926-7344-800c-8cbc-f67935b8472c"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="26fcfe27-ace9-42ea-add1-bbb5e6c3aa62" class="">encodes computation by calling methods one after another</p><ul id="10e1a926-7344-809a-b22b-c04b9dfde212" class="bulleted-list"><li style="list-style-type:disc">generalization of builder pattern</li></ul><ul id="10e1a926-7344-80c2-bb32-fcdf229eff2b" class="bulleted-list"><li style="list-style-type:disc">accumulating behavior </li></ul><ul id="10e1a926-7344-80e3-ba98-d2a1fdafda7f" class="bulleted-list"><li style="list-style-type:disc">between calls, type may change</li></ul></div></figure><h3 id="10e1a926-7344-8042-9ee8-daa6121808eb" class="">Streams are Fluent Patterns!</h3><figure id="10e1a926-7344-8015-908d-ee95fb2d7abe" class="image"><a href="image%2084.png"><img style="width:651.984375px" src="image%2084.png"/></a></figure><h3 id="10e1a926-7344-8092-986d-e511b946b12c" class="">Block API Example</h3><ul id="10e1a926-7344-80bb-bb66-fb47d1a03e75" class="bulleted-list"><li style="list-style-type:disc">full graph of streams + options is way too complex</li></ul><ul id="10e1a926-7344-809e-a64d-e55d202ab782" class="bulleted-list"><li style="list-style-type:disc">toy example: emulate blocks of code with:<ul id="10e1a926-7344-806b-b48a-f13952772140" class="bulleted-list"><li style="list-style-type:circle">guards: if, return, if error</li></ul><ul id="10e1a926-7344-8024-ae7b-f5ebc4fac20c" class="bulleted-list"><li style="list-style-type:circle">do: run code for side effects</li></ul><ul id="10e1a926-7344-8072-a779-d05f6ac661a5" class="bulleted-list"><li style="list-style-type:circle">return: produce a final result</li></ul><ul id="10e1a926-7344-800f-ab29-e02dc5d53851" class="bulleted-list"><li style="list-style-type:circle">throw: raise an error and end computation</li></ul></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-80fa-8bda-ec97eecc54ba" class="code"><code class="language-Java">interface Block&lt;T,R&gt;{
		 static &lt;R&gt; Block&lt;R,R&gt; of(){ ..; }
		 T _return(Supplier&lt;R&gt; s);
		 &lt;K extends Error&gt; T _throw(Supplier&lt;K&gt; s);
		 Block&lt;T, R&gt; _do(Runnable r);
		 Block&lt;Block&lt;T,R&gt;,R&gt; _if(BooleanSupplier bs);
 }
 
  `of` is the factory
 `_return` produces a result and `_throw` raise an error.
 `_do` does an action and let the block computation continue.
 `_if` creates a nested block scope. nested scope.
 Every time we call `_return` or `_throw` we exit from a nested scope.
Similarly to balanced parentheis, we expect calls to _if and calls to _return
or _throw to be balanced.</code></pre><figure id="10e1a926-7344-80a8-b7a3-d538d0393726" class="image"><a href="image%2085.png"><img style="width:651.984375px" src="image%2085.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10e1a926-7344-805f-a3df-f7ab053f3ec4" class="code"><code class="language-Java">interface Block&lt;T,R&gt;{
 static &lt;R&gt; Block&lt;R,R&gt; of(){ return new BaseBlock&lt;R&gt;(); }
 T _return(Supplier&lt;R&gt; s);
 default &lt;K extends Error&gt; T _throw(Supplier&lt;K&gt; s) { throw s.get(); }
 default Block&lt;T, R&gt; _do(Runnable r) { r.run(); return this; }
 default Block&lt;Block&lt;T,R&gt;,R&gt; _if(BooleanSupplier bs){
 return bs.getAsBoolean() ? new TrueBlock&lt;T,R&gt;(this) : new FalseBlock&lt;T,R&gt;(this);
 }
 }
record BaseBlock&lt;R&gt;() implements Block&lt;R,R&gt; {
 public R _return(Supplier&lt;R&gt; s) { return s.get(); }
}
record TrueBlock&lt;T,R&gt;(Block&lt;T,R&gt; outer) implements Block&lt;Block&lt;T,R&gt;,R&gt;{
 public Block&lt;T, R&gt; _return(Supplier&lt;R&gt; s){ return new DecidedBaseBlock&lt;T,R&gt;(outer,s); }
}
record FalseBlock&lt;T,R&gt;(Block&lt;T,R&gt; outer) implements Block&lt;Block&lt;T,R&gt;,R&gt;{
 public Block&lt;T, R&gt; _return(Supplier&lt;R&gt; s){ return outer; }
 public &lt;K extends Error&gt; Block&lt;T,R&gt; _throw(Supplier&lt;K&gt; s) { return outer; }
 public Block&lt;Block&lt;T,R&gt;,R&gt; _do(Runnable r){ return this; }
}
interface DecidedBlock&lt;T,R&gt; extends Block&lt;T,R&gt; {
 default Block&lt;T,R&gt; _do(Runnable r) { return this; }
 default Block&lt;Block&lt;T,R&gt;,R&gt; _if(BooleanSupplier bs){ return new DecidedNestedBlock&lt;T,R&gt;(this); }
 }
record DecidedBaseBlock&lt;T,R&gt;(Block&lt;T,R&gt; original, Supplier&lt;R&gt; result) implements DecidedBlock&lt;T,R&gt; {
 public T _return(Supplier&lt;R&gt; s) { return original._return(result); }
 public &lt;K extends Error&gt; T _throw(Supplier&lt;K&gt; s) { return original._return(result); }
 }
record DecidedNestedBlock&lt;T,R&gt;(DecidedBlock&lt;T,R&gt; decided) implements DecidedBlock&lt;Block&lt;T,R&gt;,R&gt;{
 public Block&lt;T,R&gt; _return(Supplier&lt;R&gt; s) { return decided; }
 public &lt;K extends Error&gt; Block&lt;T,R&gt; _throw(Supplier&lt;K&gt; s) { return decided; }
}</code></pre></details></li></ul><ul id="10e1a926-7344-80d1-b2ab-c694f675a3e8" class="toggle"><li><details><summary>Concluding</summary><p id="10e1a926-7344-8022-b8b2-e21890ce4fae" class="">● The Builder pattern and Fluent interface patter use the type system<br/>to guide the user through a set of steps.<br/>● At each step only some operations are possible.<br/>● Can be used to enforce protocols (do certain tasks in order)<br/>● Can be used to reorganize the code order so that actions happens in<br/>the order we write them.<br/></p><p id="10e1a926-7344-8097-9c83-ef9629882fe8" class="">● Start easy (builder returns builder returns builder until product ready)<br/>● Ends up very brainy where we can use the type system to encode<br/>arbitrary allowed paths on a graph of options.<br/>● The result may end up<br/>– Super useful like streams<br/>– An involved gimmick that only work in a few &#x27;good cases&#x27;.<br/></p></details></li></ul></details></li></ul><ul id="1121a926-7344-8007-a32e-c10ad5ddf97f" class="toggle"><li><details><summary>Functional subtyping</summary><ul id="1121a926-7344-80c8-a69e-f9427dcfc018" class="toggle"><li><details><summary>Point and Color Point example</summary><h3 id="1121a926-7344-80f8-bae8-ff49c7f96faf" class="">Mutable Version</h3><p id="1121a926-7344-80e4-a58b-ca28ac4d5466" class="">
</p><figure id="1121a926-7344-8032-981c-cd8aa50bd8de" class="image"><a href="image%2086.png"><img style="width:651.984375px" src="image%2086.png"/></a></figure><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-80aa-8d45-f912140ed53c" class="code"><code class="language-Java">interface Point{
int x(); void x(int x);
int y(); void y(int y);
String id(); //example method showing overriding on various kinds of points
default void times(int r){
this.x( this.x() * r );//We want not to duplicate those bodies in ‘CPoint’
this.y( this.y() * r );
}
default void max(int x){
if ( this.x() &gt; x ){ return ; }
this.x(x);
}
}
class Point1 implements Point{//example implementations of points
public String id(){ return &quot;Point1&quot;; }
int x; public int x(){ return x; } public void x(int v){ x = v; }
int y; public int y(){ return y; } public void y(int v){ y = v; }
} //ideally, x/y could be auto-generated
class Point2 implements Point{//example second implementation
public String id(){ return &quot;Point2&quot;; }
int x; public int x(){ return x; } public void x(int v){ x = v; }//!
int y; public int y(){ return y; } public void y(int v){ y = v; }//!
}

interface CPoint extends Point{
String color(); void color(String c);
}
class CPoint1 implements CPoint{
public String id(){ return &quot;CPoint1&quot;; }
int x; public int x(){ return x; } public void x(int v){ x = v; }//!
int y; public int y(){ return y; } public void y(int v){ y = v; }//!
String c; public String color(){ return c; }//!
public void color(String v){ c = v; }//!
}
</code></pre><h3 id="1121a926-7344-8003-bfff-f3df7fc0f4c6" class="">Immutable Version</h3><p id="1121a926-7344-80b1-a6c7-de5a39f1da8c" class="">instead of using field updates for the current point:</p><p id="1121a926-7344-80df-be89-ebea8fe8ed4f" class="">use “wither” methods that fluently builds a new point (based on the current point and arguments) and returns it rather than updating the current point</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-8054-a24f-da8c41784fb4" class="code"><code class="language-Java">interface Point{
int x();
int y();
Point withX(int x);
Point withY(int y);
String id(); //example method showing overriding on various kinds of points
default Point times(int r){return this
.withX( this.x() * r ) //example method body using withers to return a ‘Point’
.withY( this.y() * r ); //We want not to duplicate this body in ‘CPoint’
}
default Point max(int x){//example method body using withers and occasionally
if ( this.x() &gt; x ){ return this; }//returning ‘this’
return this.withX(x);
}
}
record Point1(int x, int y) implements Point{//example implementations of points
public String id(){ return &quot;Point1&quot;; }
public Point1 withX(int x){ return new Point1(x,this.y()); }
public Point1 withY(int y){ return new Point1(this.x(),y); }
} //ideally, withX/Y could be auto-generated
record Point2(int x, int y) implements Point{//We could also use anonymous classes
public String id(){ return &quot;Point2&quot;; }
public Point2 withX(int x){ return new Point2(x,this.y()); }//!
public Point2 withY(int y){ return new Point2(this.x(),y); }//!
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-803d-bdec-c4d741510a85" class="code"><code class="language-Java">interface CPoint extends Point{
String color();
CPoint withColor(String c);
CPoint withX(int x);//return type refinement
CPoint withY(int y);//could it be autogenerated? No record here
}
record CPoint1(int x, int y, String color) implements CPoint{
public String id(){ return &quot;CPoint1&quot;; }
public CPoint withX(int x){ return new CPoint1(x,this.y(),this.color()); }//!
public CPoint withY(int y){ return new CPoint1(this.x(),y,this.color()); }//!
public CPoint withColor(String c){ return new CPoint1(this.x(),this.y(),color); }//!
}
public class Example {
public static void main(String[] a){
Point p= new Point1(1, 2);//or Point2
p = p.withX(0);
p = p.times(5);//all good
CPoint cp= new CPoint1(1, 2, &quot;red&quot;);
cp = cp.withX(3);//Works, but directly overridden
cp = cp.times(4);//Type error: ‘times’ returns a Point
} //We can not do code reuse involving calling the withers.
} //But with setters, code reuse would be no problem.
//Is this a limitation of the functional design?



//to fix this, return generics rather than a point so times works in cp

interface Point&lt;S extends Point&lt;S&gt;&gt;{
int x();
int y();
S withX(int x);
S withY(int y);
S self();
String id();
default S times(int r){return this
.withX(this.x()*r)
.withY(this.y()*r);
}
default S max(int x){ //the ‘self’ method solves this.
if (this.x() &gt; x){ return this.self(); }
return this.withX(x);//we can not use Point&lt;S&gt; instead of S in the results,
} //we need S in times/max to be able to reuse its body for both Point/CPoint
}
record Point1(int x, int y) implements Point&lt;Point1&gt;{
public String id(){ return &quot;Point1&quot;; }
public Point1 self(){ return this; }//!
public Point1 withX(int x){ return new Point1(x,this.y()); }//!
public Point1 withY(int y){ return new Point1(this.x(),y); }//!
}





record Point1(int x, int y) implements Point&lt;Point1&gt;{
..self,withX,withY//!
public String id(){ return &quot;Point1&quot;; }
}
interface CPoint&lt;S extends CPoint&lt;S&gt;&gt; extends Point&lt;S&gt;{
String color();
S withColor(String c);
}
record CPoint1(int x, int y,String color) implements Cpoint&lt;CPoint1&gt;{
..self,withX,withY,withColor//!
public String id(){ return &quot;CPoint1&quot;; }
}
...
public static void main(String[] a){
Point&lt;?&gt; p= new Point1(1, 2);//Ugly, all types use &lt;?&gt; now
p = p.withX(0);
p = p.times(5);
CPoint&lt;?&gt; cp= new CPoint1(1, 2, &quot;red&quot;);
cp = cp.withX(3);
cp = cp.times(4);//But it works!
}



//with this we can do a binary method

interface Point&lt;S extends Point&lt;S&gt;&gt;{
...x/y/withX(int x)/withY(int y)/self/id
default S times(int r){...}
default S max(int x){...}
default String diff(S other){
return &quot;(&quot; + this.x() + &quot;/&quot; + other.x() + &quot;,&quot; + this.y() + &quot;/&quot; + other.y() + &quot;)&quot;;
}
}
interface CPoint&lt;S extends CPoint&lt;S&gt;&gt; extends Point&lt;S&gt;{
String color();
S withColor(String c);
default String diff(S other){//Overridden to print the full difference
return &quot;(&quot; + this.x() + &quot;/&quot; + other.x() + &quot;,&quot; + this.y() + &quot;/&quot; + other.y()
+ &quot;,&quot; + this.color() + &quot;/&quot; + other.color() + &quot;)&quot;;
}
} ...
public static void main(String[] a){
Point&lt;?&gt; p= new Point1(1, 2);
CPoint&lt;?&gt; cp= new CPoint1(1, 2, &quot;red&quot;);
capture(p);//can call diff by using wildcard capture!
capture(cp);
}
public static &lt;X extends Point&lt;X&gt;&gt;
void capture(Point&lt;X&gt; p){
Point&lt;X&gt; p1= p.withX(10);
System.out.println(p.diff(p1.self()));
}</code></pre><p id="1121a926-7344-80a5-9785-fbc4e2c9f210" class="">This works, but it uses the most sophisticated features of the Java language. I argue that if the functional Point / Color Point example is so much harder to teach that the mutable version, we do not have a good unification of OOP and FP We could make it ‘look good’ superficially, by auto-generating many things, and assuming a first generic parameter on everything with the right shape, so we can write ‘Point’ but we mean Point&lt;?&gt; logically. Would this be a solution, or is it just hiding the dust?</p><p id="1121a926-7344-8021-97dd-c83b1cf1f592" class="">General issue: this is a situation where mutation GIVES a GUARANTEE Point p=.. At a certain moment, p is exactly a Point1 in the void setters there is no way the type is changed in the withers, now there is a way to change the type Point&lt;?&gt; p= .. Point&lt;?&gt; p2= p.withX(3);</p></details></li></ul><ul id="1121a926-7344-80b5-b21e-e2482da7b0dc" class="toggle"><li><details><summary>Better solution for immutable Point and Color Point without ?</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1121a926-7344-8079-84dc-c3425e01962c"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><figure id="1121a926-7344-807b-aeb7-f5a5f226e8f1" class="image"><a href="image%2087.png"><img style="width:589.984375px" src="image%2087.png"/></a></figure></div></figure><figure id="1121a926-7344-8047-a95e-e49df815c631" class="image"><a href="image%2088.png"><img style="width:651.96875px" src="image%2088.png"/></a></figure><figure id="1121a926-7344-802e-9db5-ff0883a386fb" class="image"><a href="image%2089.png"><img style="width:651.984375px" src="image%2089.png"/></a></figure><figure id="1121a926-7344-80ff-a19b-dbbddbaad56f" class="image"><a href="image%2090.png"><img style="width:651.96875px" src="image%2090.png"/></a></figure><figure id="1121a926-7344-8015-9882-e538a945f7a2" class="image"><a href="image%2091.png"><img style="width:651.984375px" src="image%2091.png"/></a></figure></details></li></ul></details></li></ul></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>